{"version":3,"file":"scorm12.min.js","mappings":"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","sources":["webpack://scorm-again/webpack/universalModuleDefinition","webpack://scorm-again/./node_modules/tslib/tslib.es6.mjs","webpack://scorm-again/./src/cmi/common/base_cmi.ts","webpack://scorm-again/./src/constants/error_codes.ts","webpack://scorm-again/./src/constants/api_constants.ts","webpack://scorm-again/./src/exceptions.ts","webpack://scorm-again/./src/cmi/common/array.ts","webpack://scorm-again/./src/utilities.ts","webpack://scorm-again/./src/constants/default_settings.ts","webpack://scorm-again/./src/helpers/scheduled_commit.ts","webpack://scorm-again/./src/BaseAPI.ts","webpack://scorm-again/./src/utilities/debounce.ts","webpack://scorm-again/./src/constants/regex.ts","webpack://scorm-again/./src/cmi/common/validation.ts","webpack://scorm-again/./src/cmi/scorm12/validation.ts","webpack://scorm-again/./src/cmi/common/score.ts","webpack://scorm-again/./src/constants/enums.ts","webpack://scorm-again/./src/cmi/aicc/core.ts","webpack://scorm-again/./src/cmi/scorm12/objectives.ts","webpack://scorm-again/./src/cmi/scorm12/student_data.ts","webpack://scorm-again/./src/cmi/scorm12/student_preference.ts","webpack://scorm-again/./src/cmi/scorm12/interactions.ts","webpack://scorm-again/./src/cmi/scorm12/cmi.ts","webpack://scorm-again/./src/cmi/scorm12/nav.ts","webpack://scorm-again/./src/Scorm12API.ts","webpack://scorm-again/./src/exports/scorm12.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"scorm-again\"] = factory();\n\telse\n\t\troot[\"scorm-again\"] = factory();\n})(self, function() {\nreturn ","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","/**\n * Base class for API cmi objects\n */\nexport abstract class BaseCMI {\n  jsonString? = false;\n  private _initialized = false;\n  private _start_time: number | undefined;\n\n  /**\n   * Getter for _initialized\n   * @return {boolean}\n   */\n  get initialized(): boolean {\n    return this._initialized;\n  }\n\n  /**\n   * Getter for _start_time\n   * @return {number | undefined}\n   */\n  get start_time(): number | undefined {\n    return this._start_time;\n  }\n\n  /**\n   * Called when the API has been initialized after the CMI has been created\n   */\n  initialize(): void {\n    this._initialized = true;\n  }\n\n  /**\n   * Called when the player should override the 'session_time' provided by\n   * the module\n   */\n  setStartTime(): void {\n    this._start_time = new Date().getTime();\n  }\n}\n\n/**\n * Base class for cmi root objects\n */\nexport abstract class BaseRootCMI extends BaseCMI {\n  abstract getCurrentTotalTime(): string;\n}\n","export type ErrorCode = {\n  [key: string]: number;\n};\n\nconst global: ErrorCode = {\n  GENERAL: 101,\n  INITIALIZATION_FAILED: 101,\n  INITIALIZED: 101,\n  TERMINATED: 101,\n  TERMINATION_FAILURE: 101,\n  TERMINATION_BEFORE_INIT: 101,\n  MULTIPLE_TERMINATION: 101,\n  RETRIEVE_BEFORE_INIT: 101,\n  RETRIEVE_AFTER_TERM: 101,\n  STORE_BEFORE_INIT: 101,\n  STORE_AFTER_TERM: 101,\n  COMMIT_BEFORE_INIT: 101,\n  COMMIT_AFTER_TERM: 101,\n  ARGUMENT_ERROR: 101,\n  CHILDREN_ERROR: 101,\n  COUNT_ERROR: 101,\n  GENERAL_GET_FAILURE: 101,\n  GENERAL_SET_FAILURE: 101,\n  GENERAL_COMMIT_FAILURE: 101,\n  UNDEFINED_DATA_MODEL: 101,\n  UNIMPLEMENTED_ELEMENT: 101,\n  VALUE_NOT_INITIALIZED: 101,\n  INVALID_SET_VALUE: 101,\n  READ_ONLY_ELEMENT: 101,\n  WRITE_ONLY_ELEMENT: 101,\n  TYPE_MISMATCH: 101,\n  VALUE_OUT_OF_RANGE: 101,\n  DEPENDENCY_NOT_ESTABLISHED: 101,\n};\n\nconst scorm12: ErrorCode = {\n  ...global,\n  RETRIEVE_BEFORE_INIT: 301,\n  STORE_BEFORE_INIT: 301,\n  COMMIT_BEFORE_INIT: 301,\n  ARGUMENT_ERROR: 201,\n  CHILDREN_ERROR: 202,\n  COUNT_ERROR: 203,\n  UNDEFINED_DATA_MODEL: 401,\n  UNIMPLEMENTED_ELEMENT: 401,\n  VALUE_NOT_INITIALIZED: 301,\n  INVALID_SET_VALUE: 402,\n  READ_ONLY_ELEMENT: 403,\n  WRITE_ONLY_ELEMENT: 404,\n  TYPE_MISMATCH: 405,\n  VALUE_OUT_OF_RANGE: 407,\n  DEPENDENCY_NOT_ESTABLISHED: 408,\n};\n\nconst scorm2004: ErrorCode = {\n  ...global,\n  INITIALIZATION_FAILED: 102,\n  INITIALIZED: 103,\n  TERMINATED: 104,\n  TERMINATION_FAILURE: 111,\n  TERMINATION_BEFORE_INIT: 112,\n  MULTIPLE_TERMINATIONS: 113,\n  RETRIEVE_BEFORE_INIT: 122,\n  RETRIEVE_AFTER_TERM: 123,\n  STORE_BEFORE_INIT: 132,\n  STORE_AFTER_TERM: 133,\n  COMMIT_BEFORE_INIT: 142,\n  COMMIT_AFTER_TERM: 143,\n  ARGUMENT_ERROR: 201,\n  GENERAL_GET_FAILURE: 301,\n  GENERAL_SET_FAILURE: 351,\n  GENERAL_COMMIT_FAILURE: 391,\n  UNDEFINED_DATA_MODEL: 401,\n  UNIMPLEMENTED_ELEMENT: 402,\n  VALUE_NOT_INITIALIZED: 403,\n  READ_ONLY_ELEMENT: 404,\n  WRITE_ONLY_ELEMENT: 405,\n  TYPE_MISMATCH: 406,\n  VALUE_OUT_OF_RANGE: 407,\n  DEPENDENCY_NOT_ESTABLISHED: 408,\n};\n\nconst ErrorCodes = {\n  scorm12,\n  scorm2004,\n};\n\nexport default ErrorCodes;\n","interface ErrorDescription {\n  basicMessage: string;\n  detailMessage: string;\n}\n\ninterface ErrorDescriptions {\n  [key: string]: ErrorDescription;\n}\n\ninterface ScormConstants {\n  cmi_children: string;\n  core_children: string;\n  score_children: string;\n  comments_children: string;\n  objectives_children: string;\n  correct_responses_children: string;\n  student_data_children: string;\n  student_preference_children: string;\n  interactions_children: string;\n  error_descriptions: ErrorDescriptions;\n}\n\ninterface AiccConstants extends ScormConstants {\n  student_demographics_children: string;\n  tries_children: string;\n  attempt_records_children: string;\n  paths_children: string;\n}\n\ninterface Scorm2004Constants {\n  cmi_children: string;\n  comments_children: string;\n  score_children: string;\n  objectives_children: string;\n  correct_responses_children: string;\n  student_data_children: string;\n  student_preference_children: string;\n  interactions_children: string;\n  error_descriptions: ErrorDescriptions;\n}\n\ninterface GlobalConstants {\n  SCORM_TRUE: string;\n  SCORM_FALSE: string;\n  STATE_NOT_INITIALIZED: number;\n  STATE_INITIALIZED: number;\n  STATE_TERMINATED: number;\n  LOG_LEVEL_DEBUG: number;\n  LOG_LEVEL_INFO: number;\n  LOG_LEVEL_WARNING: number;\n  LOG_LEVEL_ERROR: number;\n  LOG_LEVEL_NONE: number;\n}\n\ninterface APIConstants {\n  global: GlobalConstants;\n  scorm12: ScormConstants;\n  aicc: AiccConstants;\n  scorm2004: Scorm2004Constants;\n}\n\nconst global: GlobalConstants = {\n  SCORM_TRUE: \"true\",\n  SCORM_FALSE: \"false\",\n  STATE_NOT_INITIALIZED: 0,\n  STATE_INITIALIZED: 1,\n  STATE_TERMINATED: 2,\n  LOG_LEVEL_DEBUG: 1,\n  LOG_LEVEL_INFO: 2,\n  LOG_LEVEL_WARNING: 3,\n  LOG_LEVEL_ERROR: 4,\n  LOG_LEVEL_NONE: 5,\n};\n\nconst scorm12: ScormConstants = {\n  // Children lists\n  cmi_children:\n    \"core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions\",\n  core_children:\n    \"student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,exit,session_time\",\n  score_children: \"raw,min,max\",\n  comments_children: \"content,location,time\",\n  objectives_children: \"id,score,status\",\n  correct_responses_children: \"pattern\",\n  student_data_children: \"mastery_score,max_time_allowed,time_limit_action\",\n  student_preference_children: \"audio,language,speed,text\",\n  interactions_children:\n    \"id,objectives,time,type,correct_responses,weighting,student_response,result,latency\",\n  error_descriptions: {\n    \"101\": {\n      basicMessage: \"General Exception\",\n      detailMessage:\n        \"No specific error code exists to describe the error. Use LMSGetDiagnostic for more information\",\n    },\n    \"201\": {\n      basicMessage: \"Invalid argument error\",\n      detailMessage:\n        \"Indicates that an argument represents an invalid data model element or is otherwise incorrect.\",\n    },\n    \"202\": {\n      basicMessage: \"Element cannot have children\",\n      detailMessage:\n        'Indicates that LMSGetValue was called with a data model element name that ends in \"_children\" for a data model element that does not support the \"_children\" suffix.',\n    },\n    \"203\": {\n      basicMessage: \"Element not an array - cannot have count\",\n      detailMessage:\n        'Indicates that LMSGetValue was called with a data model element name that ends in \"_count\" for a data model element that does not support the \"_count\" suffix.',\n    },\n    \"301\": {\n      basicMessage: \"Not initialized\",\n      detailMessage:\n        \"Indicates that an API call was made before the call to lmsInitialize.\",\n    },\n    \"401\": {\n      basicMessage: \"Not implemented error\",\n      detailMessage:\n        \"The data model element indicated in a call to LMSGetValue or LMSSetValue is valid, but was not implemented by this LMS. SCORM 1.2 defines a set of data model elements as being optional for an LMS to implement.\",\n    },\n    \"402\": {\n      basicMessage: \"Invalid set value, element is a keyword\",\n      detailMessage:\n        'Indicates that LMSSetValue was called on a data model element that represents a keyword (elements that end in \"_children\" and \"_count\").',\n    },\n    \"403\": {\n      basicMessage: \"Element is read only\",\n      detailMessage:\n        \"LMSSetValue was called with a data model element that can only be read.\",\n    },\n    \"404\": {\n      basicMessage: \"Element is write only\",\n      detailMessage:\n        \"LMSGetValue was called on a data model element that can only be written to.\",\n    },\n    \"405\": {\n      basicMessage: \"Incorrect Data Type\",\n      detailMessage:\n        \"LMSSetValue was called with a value that is not consistent with the data format of the supplied data model element.\",\n    },\n    \"407\": {\n      basicMessage: \"Element Value Out Of Range\",\n      detailMessage:\n        \"The numeric value supplied to a LMSSetValue call is outside of the numeric range allowed for the supplied data model element.\",\n    },\n    \"408\": {\n      basicMessage: \"Data Model Dependency Not Established\",\n      detailMessage:\n        \"Some data model elements cannot be set until another data model element was set. This error condition indicates that the prerequisite element was not set before the dependent element.\",\n    },\n  },\n};\nconst aicc: AiccConstants = {\n  ...scorm12,\n  ...{\n    cmi_children:\n      \"core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions,evaluation\",\n    student_preference_children:\n      \"audio,language,lesson_type,speed,text,text_color,text_location,text_size,video,windows\",\n    student_data_children:\n      \"attempt_number,tries,mastery_score,max_time_allowed,time_limit_action\",\n    student_demographics_children:\n      \"city,class,company,country,experience,familiar_name,instructor_name,title,native_language,state,street_address,telephone,years_experience\",\n    tries_children: \"time,status,score\",\n    attempt_records_children: \"score,lesson_status\",\n    paths_children: \"location_id,date,time,status,why_left,time_in_element\",\n  },\n};\nconst scorm2004: Scorm2004Constants = {\n  // Children lists\n  cmi_children:\n    \"_version,comments_from_learner,comments_from_lms,completion_status,credit,entry,exit,interactions,launch_data,learner_id,learner_name,learner_preference,location,max_time_allowed,mode,objectives,progress_measure,scaled_passing_score,score,session_time,success_status,suspend_data,time_limit_action,total_time\",\n  comments_children: \"comment,timestamp,location\",\n  score_children: \"max,raw,scaled,min\",\n  objectives_children:\n    \"progress_measure,completion_status,success_status,description,score,id\",\n  correct_responses_children: \"pattern\",\n  student_data_children: \"mastery_score,max_time_allowed,time_limit_action\",\n  student_preference_children:\n    \"audio_level,audio_captioning,delivery_speed,language\",\n  interactions_children:\n    \"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description\",\n  error_descriptions: {\n    \"0\": {\n      basicMessage: \"No Error\",\n      detailMessage: \"No error occurred, the previous API call was successful.\",\n    },\n    \"101\": {\n      basicMessage: \"General Exception\",\n      detailMessage:\n        \"No specific error code exists to describe the error. Use GetDiagnostic for more information.\",\n    },\n    \"102\": {\n      basicMessage: \"General Initialization Failure\",\n      detailMessage: \"Call to Initialize failed for an unknown reason.\",\n    },\n    \"103\": {\n      basicMessage: \"Already Initialized\",\n      detailMessage:\n        \"Call to Initialize failed because Initialize was already called.\",\n    },\n    \"104\": {\n      basicMessage: \"Content Instance Terminated\",\n      detailMessage:\n        \"Call to Initialize failed because Terminate was already called.\",\n    },\n    \"111\": {\n      basicMessage: \"General Termination Failure\",\n      detailMessage: \"Call to Terminate failed for an unknown reason.\",\n    },\n    \"112\": {\n      basicMessage: \"Termination Before Initialization\",\n      detailMessage:\n        \"Call to Terminate failed because it was made before the call to Initialize.\",\n    },\n    \"113\": {\n      basicMessage: \"Termination After Termination\",\n      detailMessage:\n        \"Call to Terminate failed because Terminate was already called.\",\n    },\n    \"122\": {\n      basicMessage: \"Retrieve Data Before Initialization\",\n      detailMessage:\n        \"Call to GetValue failed because it was made before the call to Initialize.\",\n    },\n    \"123\": {\n      basicMessage: \"Retrieve Data After Termination\",\n      detailMessage:\n        \"Call to GetValue failed because it was made after the call to Terminate.\",\n    },\n    \"132\": {\n      basicMessage: \"Store Data Before Initialization\",\n      detailMessage:\n        \"Call to SetValue failed because it was made before the call to Initialize.\",\n    },\n    \"133\": {\n      basicMessage: \"Store Data After Termination\",\n      detailMessage:\n        \"Call to SetValue failed because it was made after the call to Terminate.\",\n    },\n    \"142\": {\n      basicMessage: \"Commit Before Initialization\",\n      detailMessage:\n        \"Call to Commit failed because it was made before the call to Initialize.\",\n    },\n    \"143\": {\n      basicMessage: \"Commit After Termination\",\n      detailMessage:\n        \"Call to Commit failed because it was made after the call to Terminate.\",\n    },\n    \"201\": {\n      basicMessage: \"General Argument Error\",\n      detailMessage:\n        \"An invalid argument was passed to an API method (usually indicates that Initialize, Commit or Terminate did not receive the expected empty string argument.\",\n    },\n    \"301\": {\n      basicMessage: \"General Get Failure\",\n      detailMessage:\n        \"Indicates a failed GetValue call where no other specific error code is applicable. Use GetDiagnostic for more information.\",\n    },\n    \"351\": {\n      basicMessage: \"General Set Failure\",\n      detailMessage:\n        \"Indicates a failed SetValue call where no other specific error code is applicable. Use GetDiagnostic for more information.\",\n    },\n    \"391\": {\n      basicMessage: \"General Commit Failure\",\n      detailMessage:\n        \"Indicates a failed Commit call where no other specific error code is applicable. Use GetDiagnostic for more information.\",\n    },\n    \"401\": {\n      basicMessage: \"Undefined Data Model Element\",\n      detailMessage:\n        \"The data model element name passed to GetValue or SetValue is not a valid SCORM data model element.\",\n    },\n    \"402\": {\n      basicMessage: \"Unimplemented Data Model Element\",\n      detailMessage:\n        \"The data model element indicated in a call to GetValue or SetValue is valid, but was not implemented by this LMS. In SCORM 2004, this error would indicate an LMS that is not fully SCORM conformant.\",\n    },\n    \"403\": {\n      basicMessage: \"Data Model Element Value Not Initialized\",\n      detailMessage:\n        \"Attempt to read a data model element that has not been initialized by the LMS or through a SetValue call. This error condition is often reached during normal execution of a SCO.\",\n    },\n    \"404\": {\n      basicMessage: \"Data Model Element Is Read Only\",\n      detailMessage:\n        \"SetValue was called with a data model element that can only be read.\",\n    },\n    \"405\": {\n      basicMessage: \"Data Model Element Is Write Only\",\n      detailMessage:\n        \"GetValue was called on a data model element that can only be written to.\",\n    },\n    \"406\": {\n      basicMessage: \"Data Model Element Type Mismatch\",\n      detailMessage:\n        \"SetValue was called with a value that is not consistent with the data format of the supplied data model element.\",\n    },\n    \"407\": {\n      basicMessage: \"Data Model Element Value Out Of Range\",\n      detailMessage:\n        \"The numeric value supplied to a SetValue call is outside of the numeric range allowed for the supplied data model element.\",\n    },\n    \"408\": {\n      basicMessage: \"Data Model Dependency Not Established\",\n      detailMessage:\n        \"Some data model elements cannot be set until another data model element was set. This error condition indicates that the prerequisite element was not set before the dependent element.\",\n    },\n  },\n};\nconst APIConstants: APIConstants = {\n  global: global,\n  scorm12: scorm12,\n  aicc: aicc,\n  scorm2004: scorm2004,\n};\nexport default APIConstants;\n","import APIConstants from \"./constants/api_constants\";\n\nconst scorm12_errors = APIConstants.scorm12.error_descriptions;\nconst aicc_errors = APIConstants.aicc.error_descriptions;\nconst scorm2004_errors = APIConstants.scorm2004.error_descriptions;\n\ntype APIError = {\n  errorCode: number;\n  errorMessage: string;\n  detailedMessage: string;\n};\n\nexport class BaseScormValidationError extends Error {\n  constructor(errorCode: number) {\n    super(errorCode.toString());\n    this._errorCode = errorCode;\n    this.name = \"ScormValidationError\";\n  }\n\n  private readonly _errorCode: number;\n\n  /**\n   * Getter for _errorCode\n   * @return {number}\n   */\n  get errorCode(): number {\n    return this._errorCode;\n  }\n\n  setMessage(message: string) {\n    this.message = message;\n  }\n}\n\n/**\n * Base Validation Exception\n */\nexport class ValidationError\n  extends BaseScormValidationError\n  implements APIError\n{\n  /**\n   * Constructor to take in an error message and code\n   * @param {number} errorCode\n   * @param {string} errorMessage\n   * @param {string} detailedMessage\n   */\n  constructor(\n    errorCode: number,\n    errorMessage: string,\n    detailedMessage?: string,\n  ) {\n    super(errorCode);\n    this.setMessage(errorMessage);\n    this._errorMessage = errorMessage;\n    if (detailedMessage) {\n      this._detailedMessage = detailedMessage;\n    }\n  }\n\n  private readonly _errorMessage: string;\n  private readonly _detailedMessage: string = \"\";\n\n  /**\n   * Getter for _errorMessage\n   * @return {string}\n   */\n  get errorMessage(): string {\n    return this._errorMessage;\n  }\n\n  /**\n   * Getter for _detailedMessage\n   * @return {string}\n   */\n  get detailedMessage(): string {\n    return this._detailedMessage;\n  }\n}\n\n/**\n * SCORM 1.2 Validation Error\n */\nexport class Scorm12ValidationError extends ValidationError {\n  /**\n   * Constructor to take in an error code\n   * @param {number} errorCode\n   */\n  constructor(errorCode: number) {\n    if ({}.hasOwnProperty.call(scorm12_errors, String(errorCode))) {\n      super(\n        errorCode,\n        scorm12_errors[String(errorCode)].basicMessage,\n        scorm12_errors[String(errorCode)].detailMessage,\n      );\n    } else {\n      super(\n        101,\n        scorm12_errors[\"101\"].basicMessage,\n        scorm12_errors[\"101\"].detailMessage,\n      );\n    }\n  }\n}\n\n/**\n * AICC Validation Error\n */\nexport class AICCValidationError extends ValidationError {\n  /**\n   * Constructor to take in an error code\n   * @param {number} errorCode\n   */\n  constructor(errorCode: number) {\n    if ({}.hasOwnProperty.call(aicc_errors, String(errorCode))) {\n      super(\n        errorCode,\n        aicc_errors[String(errorCode)].basicMessage,\n        aicc_errors[String(errorCode)].detailMessage,\n      );\n    } else {\n      super(\n        101,\n        aicc_errors[\"101\"].basicMessage,\n        aicc_errors[\"101\"].detailMessage,\n      );\n    }\n  }\n}\n\n/**\n * SCORM 2004 Validation Error\n */\nexport class Scorm2004ValidationError extends ValidationError {\n  /**\n   * Constructor to take in an error code\n   * @param {number} errorCode\n   */\n  constructor(errorCode: number) {\n    if ({}.hasOwnProperty.call(scorm2004_errors, String(errorCode))) {\n      super(\n        errorCode,\n        scorm2004_errors[String(errorCode)].basicMessage,\n        scorm2004_errors[String(errorCode)].detailMessage,\n      );\n    } else {\n      super(\n        101,\n        scorm2004_errors[\"101\"].basicMessage,\n        scorm2004_errors[\"101\"].detailMessage,\n      );\n    }\n  }\n}\n","import { BaseCMI } from \"./base_cmi\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport { BaseScormValidationError } from \"../../exceptions\";\n\nexport const scorm12_error_codes = ErrorCodes.scorm12;\n\n/**\n * Base class for cmi *.n objects\n */\nexport class CMIArray extends BaseCMI {\n  private readonly _errorCode: number;\n  private readonly _errorClass: typeof BaseScormValidationError;\n  private readonly __children: string;\n  childArray: any[];\n\n  /**\n   * Constructor cmi *.n arrays\n   * @param {object} params\n   */\n  constructor(params: {\n    children: string;\n    errorCode?: number;\n    errorClass?: typeof BaseScormValidationError;\n  }) {\n    super();\n    this.__children = params.children;\n    this._errorCode = params.errorCode || scorm12_error_codes.GENERAL;\n    this._errorClass = params.errorClass || BaseScormValidationError;\n    this.childArray = [];\n  }\n\n  /**\n   * Getter for _children\n   * @return {string}\n   */\n  get _children(): string {\n    return this.__children;\n  }\n\n  /**\n   * Setter for _children. Just throws an error.\n   * @param {string} _children\n   */\n  set _children(_children: string) {\n    throw new this._errorClass(this._errorCode);\n  }\n\n  /**\n   * Getter for _count\n   * @return {number}\n   */\n  get _count(): number {\n    return this.childArray.length;\n  }\n\n  /**\n   * Setter for _count. Just throws an error.\n   * @param {number} _count\n   */\n  set _count(_count: number) {\n    throw new this._errorClass(this._errorCode);\n  }\n\n  /**\n   * toJSON for *.n arrays\n   * @return {object}\n   */\n  toJSON(): object {\n    this.jsonString = true;\n    const result: { [key: string]: any } = {};\n    for (let i = 0; i < this.childArray.length; i++) {\n      result[i + \"\"] = this.childArray[i];\n    }\n    delete this.jsonString;\n    return result;\n  }\n}\n","export const SECONDS_PER_SECOND = 1.0;\nexport const SECONDS_PER_MINUTE = 60;\nexport const SECONDS_PER_HOUR = 60 * SECONDS_PER_MINUTE;\nexport const SECONDS_PER_DAY = 24 * SECONDS_PER_HOUR;\n\ntype Designation = {\n  [key: string]: number;\n};\n\ntype StringKeyMap = {\n  [key: string]: any;\n};\n\nconst designations: Designation = {\n  D: SECONDS_PER_DAY,\n  H: SECONDS_PER_HOUR,\n  M: SECONDS_PER_MINUTE,\n  S: SECONDS_PER_SECOND,\n};\n\n/**\n * Converts a Number to a String of HH:MM:SS\n *\n * @param {number} totalSeconds\n * @return {string}\n */\nexport function getSecondsAsHHMMSS(totalSeconds: number | null): string {\n  // SCORM spec does not deal with negative durations, give zero back\n  if (!totalSeconds || totalSeconds <= 0) {\n    return \"00:00:00\";\n  }\n\n  const hours = Math.floor(totalSeconds / SECONDS_PER_HOUR);\n  const dateObj = new Date(totalSeconds * 1000);\n  const minutes = dateObj.getUTCMinutes();\n  // make sure we add any possible decimal value\n  const seconds = dateObj.getSeconds();\n  const ms = totalSeconds % 1.0;\n  let msStr = \"\";\n\n  if (countDecimals(ms) > 0) {\n    if (countDecimals(ms) > 2) {\n      msStr = ms.toFixed(2);\n    } else {\n      msStr = String(ms);\n    }\n\n    msStr = \".\" + msStr.split(\".\")[1];\n  }\n\n  return (\n    (hours + \":\" + minutes + \":\" + seconds).replace(/\\b\\d\\b/g, \"0$&\") + msStr\n  );\n}\n\n/**\n * Calculate the number of seconds from ISO 8601 Duration\n *\n * @param {number} seconds\n * @return {string}\n */\nexport function getSecondsAsISODuration(seconds: number | null): string {\n  // SCORM spec does not deal with negative durations, give zero back\n  if (!seconds || seconds <= 0) {\n    return \"PT0S\";\n  }\n\n  let duration = \"P\";\n  let remainder = seconds;\n  for (const designationsKey in designations) {\n    const current_seconds = designations[designationsKey];\n    let value = Math.floor(remainder / current_seconds);\n    remainder = remainder % current_seconds;\n\n    if (countDecimals(remainder) > 2) {\n      remainder = Number(Number(remainder).toFixed(2));\n    }\n\n    // If we have anything left in the remainder, and we're currently adding\n    // seconds to the duration, go ahead and add the decimal to the seconds\n    if (designationsKey === \"S\" && remainder > 0) {\n      value += remainder;\n    }\n\n    if (value) {\n      if (\n        (duration.indexOf(\"D\") > 0 ||\n          designationsKey === \"H\" ||\n          designationsKey === \"M\" ||\n          designationsKey === \"S\") &&\n        duration.indexOf(\"T\") === -1\n      ) {\n        duration += \"T\";\n      }\n\n      duration += `${value}${designationsKey}`;\n    }\n  }\n  return duration;\n}\n\n/**\n * Calculate the number of seconds from HH:MM:SS.DDDDDD\n *\n * @param {string} timeString\n * @param {RegExp} timeRegex\n * @return {number}\n */\nexport function getTimeAsSeconds(\n  timeString: string | number | boolean | null,\n  timeRegex: RegExp | string,\n): number {\n  if (typeof timeString === \"number\" || typeof timeString === \"boolean\") {\n    timeString = String(timeString);\n  }\n  if (typeof timeRegex === \"string\") {\n    timeRegex = new RegExp(timeRegex);\n  }\n  if (!timeString || !timeString.match(timeRegex)) {\n    return 0;\n  }\n\n  const parts = timeString.split(\":\");\n  const hours = Number(parts[0]);\n  const minutes = Number(parts[1]);\n  const seconds = Number(parts[2]);\n  return hours * 3600 + minutes * 60 + seconds;\n}\n\n/**\n * Calculate the number of seconds from ISO 8601 Duration\n *\n * @param {string} duration\n * @param {RegExp} durationRegex\n * @return {number}\n */\nexport function getDurationAsSeconds(\n  duration: string | null,\n  durationRegex: RegExp | string,\n): number {\n  if (typeof durationRegex === \"string\") {\n    durationRegex = new RegExp(durationRegex);\n  }\n\n  if (!duration || !duration.match(durationRegex)) {\n    return 0;\n  }\n\n  const [, years, _, , days, hours, minutes, seconds] =\n    new RegExp(durationRegex).exec(duration) || [];\n  let result = 0.0;\n  result += Number(seconds) || 0.0;\n  result += Number(minutes) * 60.0 || 0.0;\n  result += Number(hours) * 3600.0 || 0.0;\n  result += Number(days) * (60 * 60 * 24.0) || 0.0;\n  result += Number(years) * (60 * 60 * 24 * 365.0) || 0.0;\n  return result;\n}\n\n/**\n * Adds together two ISO8601 Duration strings\n *\n * @param {string} first\n * @param {string} second\n * @param {RegExp|string} durationRegex\n * @return {string}\n */\nexport function addTwoDurations(\n  first: string,\n  second: string,\n  durationRegex: RegExp | string,\n): string {\n  const regex: RegExp =\n    typeof durationRegex === \"string\"\n      ? new RegExp(durationRegex)\n      : durationRegex;\n  return getSecondsAsISODuration(\n    getDurationAsSeconds(first, regex) + getDurationAsSeconds(second, regex),\n  );\n}\n\n/**\n * Add together two HH:MM:SS.DD strings\n *\n * @param {string} first\n * @param {string} second\n * @param {RegExp} timeRegex\n * @return {string}\n */\nexport function addHHMMSSTimeStrings(\n  first: string,\n  second: string,\n  timeRegex: RegExp | string,\n): string {\n  if (typeof timeRegex === \"string\") {\n    timeRegex = new RegExp(timeRegex);\n  }\n  return getSecondsAsHHMMSS(\n    getTimeAsSeconds(first, timeRegex) + getTimeAsSeconds(second, timeRegex),\n  );\n}\n\n/**\n * Flatten a JSON object down to string paths for each values\n * @param {object} data\n * @return {object}\n */\nexport function flatten(data: StringKeyMap): object {\n  const result: StringKeyMap = {};\n\n  /**\n   * Recurse through the object\n   * @param {*} cur\n   * @param {*} prop\n   */\n  function recurse(cur: any, prop: any) {\n    if (Object(cur) !== cur) {\n      result[prop] = cur;\n    } else if (Array.isArray(cur)) {\n      for (let i = 0, l = cur.length; i < l; i++) {\n        recurse(cur[i], prop + \"[\" + i + \"]\");\n        if (l === 0) result[prop] = [];\n      }\n    } else {\n      let isEmpty = true;\n\n      for (const p in cur) {\n        if ({}.hasOwnProperty.call(cur, p)) {\n          isEmpty = false;\n          recurse(cur[p], prop ? prop + \".\" + p : p);\n        }\n      }\n\n      if (isEmpty && prop) result[prop] = {};\n    }\n  }\n\n  recurse(data, \"\");\n  return result;\n}\n\n/**\n * Un-flatten a flat JSON object\n * @param {object} data\n * @return {object}\n */\nexport function unflatten(data: StringKeyMap): object {\n  \"use strict\";\n\n  if (Object(data) !== data || Array.isArray(data)) return data;\n  const regex = /\\.?([^.[\\]]+)|\\[(\\d+)]/g;\n  const result: StringKeyMap = {};\n\n  for (const p in data) {\n    if ({}.hasOwnProperty.call(data, p)) {\n      let cur = result;\n      let prop = \"\";\n      let m = regex.exec(p);\n\n      while (m) {\n        cur = cur[prop] || (cur[prop] = m[2] ? [] : {});\n        prop = m[2] || m[1];\n        m = regex.exec(p);\n      }\n\n      cur[prop] = data[p];\n    }\n  }\n\n  return result[\"\"] || result;\n}\n\n/**\n * Counts the number of decimal places\n * @param {number} num\n * @return {number}\n */\nexport function countDecimals(num: number): number {\n  if (Math.floor(num) === num || String(num).indexOf(\".\") < 0) return 0;\n  const parts = num.toString().split(\".\")[1];\n  return parts.length || 0;\n}\n\n/**\n * Formats the SCORM messages for easy reading\n *\n * @param {string} functionName\n * @param {string} message\n * @param {string} CMIElement\n * @return {string}\n */\nexport function formatMessage(\n  functionName: string,\n  message: string,\n  CMIElement?: string,\n): string {\n  const baseLength = 20;\n  let messageString = \"\";\n\n  messageString += functionName;\n\n  let fillChars = baseLength - messageString.length;\n\n  for (let i = 0; i < fillChars; i++) {\n    messageString += \" \";\n  }\n\n  messageString += \": \";\n\n  if (CMIElement) {\n    const CMIElementBaseLength = 70;\n\n    messageString += CMIElement;\n\n    fillChars = CMIElementBaseLength - messageString.length;\n\n    for (let j = 0; j < fillChars; j++) {\n      messageString += \" \";\n    }\n  }\n\n  if (message) {\n    messageString += message;\n  }\n\n  return messageString;\n}\n\n/**\n * Checks to see if {str} contains {tester}\n *\n * @param {string} str String to check against\n * @param {string} tester String to check for\n * @return {boolean}\n */\nexport function stringMatches(str: string, tester: string): boolean {\n  return str?.match(tester) !== null;\n}\n","import { ResultObject, Settings } from \"../types/api_types\";\nimport APIConstants from \"./api_constants\";\n\n/**\n * Default settings for the SCORM API\n */\nexport const DefaultSettings: Settings = {\n  autocommit: false,\n  autocommitSeconds: 10,\n  asyncCommit: false,\n  sendFullCommit: true,\n  lmsCommitUrl: false,\n  dataCommitFormat: \"json\",\n  commitRequestDataType: \"application/json;charset=UTF-8\",\n  autoProgress: false,\n  logLevel: APIConstants.global.LOG_LEVEL_ERROR,\n  selfReportSessionTime: false,\n  alwaysSendTotalTime: false,\n  renderCommonCommitFields: false,\n  strict_errors: true,\n  xhrHeaders: {},\n  xhrWithCredentials: false,\n  responseHandler: async function (response: Response): Promise<ResultObject> {\n    if (typeof response !== \"undefined\") {\n      const httpResult = JSON.parse(await response.text());\n      if (\n        httpResult === null ||\n        !{}.hasOwnProperty.call(httpResult, \"result\")\n      ) {\n        if (response.status === 200) {\n          return {\n            result: APIConstants.global.SCORM_TRUE,\n            errorCode: 0,\n          };\n        } else {\n          return {\n            result: APIConstants.global.SCORM_FALSE,\n            errorCode: 101,\n          };\n        }\n      } else {\n        return {\n          result: httpResult.result,\n          errorCode: httpResult.errorCode\n            ? httpResult.errorCode\n            : httpResult.result === APIConstants.global.SCORM_TRUE\n              ? 0\n              : 101,\n        };\n      }\n    }\n    return {\n      result: APIConstants.global.SCORM_FALSE,\n      errorCode: 101,\n    };\n  },\n  requestHandler: function (commitObject) {\n    return commitObject;\n  },\n  onLogMessage: function (messageLevel, logMessage) {\n    switch (messageLevel) {\n      case APIConstants.global.LOG_LEVEL_ERROR:\n        console.error(logMessage);\n        break;\n      case APIConstants.global.LOG_LEVEL_WARNING:\n        console.warn(logMessage);\n        break;\n      case APIConstants.global.LOG_LEVEL_INFO:\n        console.info(logMessage);\n        break;\n      case APIConstants.global.LOG_LEVEL_DEBUG:\n        if (console.debug) {\n          console.debug(logMessage);\n        } else {\n          console.log(logMessage);\n        }\n        break;\n    }\n  },\n  scoItemIds: [],\n  scoItemIdValidator: false,\n};\n","import BaseAPI from \"../BaseAPI\";\n\n/**\n * Private class that wraps a timeout call to the commit() function\n */\nexport class ScheduledCommit {\n  private _API;\n  private _cancelled = false;\n  private readonly _timeout;\n  private readonly _callback;\n\n  /**\n   * Constructor for ScheduledCommit\n   * @param {BaseAPI} API\n   * @param {number} when\n   * @param {string} callback\n   */\n  constructor(API: BaseAPI, when: number, callback: string) {\n    this._API = API;\n    this._timeout = setTimeout(this.wrapper.bind(this), when);\n    this._callback = callback;\n  }\n\n  /**\n   * Cancel any currently scheduled commit\n   */\n  cancel() {\n    this._cancelled = true;\n    if (this._timeout) {\n      clearTimeout(this._timeout);\n    }\n  }\n\n  /**\n   * Wrap the API commit call to check if the call has already been cancelled\n   */\n  wrapper() {\n    if (!this._cancelled) {\n      (async () => await this._API.commit(this._callback))();\n    }\n  }\n}\n","import { CMIArray } from \"./cmi/common/array\";\nimport { ValidationError } from \"./exceptions\";\nimport ErrorCodes, { ErrorCode } from \"./constants/error_codes\";\nimport APIConstants from \"./constants/api_constants\";\nimport { formatMessage, stringMatches, unflatten } from \"./utilities\";\nimport { BaseCMI } from \"./cmi/common/base_cmi\";\nimport { debounce } from \"./utilities/debounce\";\nimport {\n  RefObject,\n  CommitObject,\n  ResultObject,\n  Settings,\n} from \"./types/api_types\";\nimport { DefaultSettings } from \"./constants/default_settings\";\nimport { IBaseAPI } from \"./interfaces/IBaseAPI\";\nimport { ScheduledCommit } from \"./helpers/scheduled_commit\";\n\n/**\n * Base API class for AICC, SCORM 1.2, and SCORM 2004. Should be considered\n * abstract, and never initialized on its own.\n */\nexport default abstract class BaseAPI implements IBaseAPI {\n  private _timeout?: ScheduledCommit;\n  private readonly _error_codes: ErrorCode;\n  private _settings: Settings = DefaultSettings;\n\n  /**\n   * Constructor for Base API class. Sets some shared API fields, as well as\n   * sets up options for the API.\n   * @param {ErrorCode} error_codes\n   * @param {Settings} settings\n   */\n  protected constructor(error_codes: ErrorCode, settings?: Settings) {\n    if (new.target === BaseAPI) {\n      throw new TypeError(\"Cannot construct BaseAPI instances directly\");\n    }\n    this.currentState = APIConstants.global.STATE_NOT_INITIALIZED;\n    this.lastErrorCode = \"0\";\n    this.listenerArray = [];\n\n    this._error_codes = error_codes;\n\n    if (settings) {\n      this.settings = settings;\n    }\n    this.apiLogLevel = this.settings.logLevel;\n    this.selfReportSessionTime = this.settings.selfReportSessionTime;\n  }\n\n  public abstract cmi: BaseCMI;\n  public startingData?: RefObject;\n\n  public currentState: number;\n  public lastErrorCode: string;\n  public listenerArray: any[];\n  public apiLogLevel: number;\n  public selfReportSessionTime: boolean;\n\n  abstract reset(settings?: Settings): void;\n\n  /**\n   * Common reset method for all APIs. New settings are merged with the existing settings.\n   * @param {Settings} settings\n   * @protected\n   */\n  commonReset(settings?: Settings): void {\n    this.settings = { ...this.settings, ...settings };\n\n    this.currentState = APIConstants.global.STATE_NOT_INITIALIZED;\n    this.lastErrorCode = \"0\";\n    this.listenerArray = [];\n  }\n\n  /**\n   * Initialize the API\n   * @param {string} callbackName\n   * @param {string} initializeMessage\n   * @param {string} terminationMessage\n   * @return {string}\n   */\n  initialize(\n    callbackName: string,\n    initializeMessage?: string,\n    terminationMessage?: string,\n  ): string {\n    let returnValue = APIConstants.global.SCORM_FALSE;\n\n    if (this.isInitialized()) {\n      this.throwSCORMError(this._error_codes.INITIALIZED, initializeMessage);\n    } else if (this.isTerminated()) {\n      this.throwSCORMError(this._error_codes.TERMINATED, terminationMessage);\n    } else {\n      if (this.selfReportSessionTime) {\n        this.cmi.setStartTime();\n      }\n\n      this.currentState = APIConstants.global.STATE_INITIALIZED;\n      this.lastErrorCode = \"0\";\n      returnValue = APIConstants.global.SCORM_TRUE;\n      this.processListeners(callbackName);\n    }\n\n    this.apiLog(\n      callbackName,\n      \"returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n    );\n    this.clearSCORMError(returnValue);\n\n    return returnValue;\n  }\n\n  abstract lmsInitialize(): string;\n\n  abstract lmsFinish(): string;\n\n  abstract lmsGetValue(CMIElement: string): string;\n\n  abstract lmsSetValue(CMIElement: string, value: any): string;\n\n  abstract lmsCommit(): string;\n\n  abstract lmsGetLastError(): string;\n\n  abstract lmsGetErrorString(CMIErrorCode: string | number): string;\n\n  abstract lmsGetDiagnostic(CMIErrorCode: string | number): string;\n\n  /**\n   * Abstract method for validating that a response is correct.\n   *\n   * @param {string} _CMIElement\n   * @param {any} _value\n   */\n  abstract validateCorrectResponse(_CMIElement: string, _value: any): void;\n\n  /**\n   * Gets or builds a new child element to add to the array.\n   * APIs that inherit BaseAPI should override this method.\n   *\n   * @param {string} _CMIElement - unused\n   * @param {*} _value - unused\n   * @param {boolean} _foundFirstIndex - unused\n   * @return {BaseCMI|null}\n   * @abstract\n   */\n  abstract getChildElement(\n    _CMIElement: string,\n    _value: any,\n    _foundFirstIndex: boolean,\n  ): BaseCMI | null;\n\n  /**\n   * Attempts to store the data to the LMS, logs data if no LMS configured\n   * APIs that inherit BaseAPI should override this function\n   *\n   * @param {boolean} _calculateTotalTime\n   * @return {ResultObject}\n   * @abstract\n   */\n  abstract storeData(_calculateTotalTime: boolean): Promise<ResultObject>;\n\n  /**\n   * Render the cmi object to the proper format for LMS commit\n   * APIs that inherit BaseAPI should override this function\n   *\n   * @param {boolean} _terminateCommit\n   * @return {RefObject|Array}\n   * @abstract\n   */\n  abstract renderCommitCMI(_terminateCommit: boolean): RefObject | Array<any>;\n\n  /**\n   * Render the commit object to the shortened format for LMS commit\n   * @param {boolean} _terminateCommit\n   * @return {CommitObject}\n   */\n  abstract renderCommitObject(_terminateCommit: boolean): CommitObject;\n\n  /**\n   * Logging for all SCORM actions\n   *\n   * @param {string} functionName\n   * @param {string} logMessage\n   * @param {number} messageLevel\n   * @param {string} CMIElement\n   */\n  apiLog(\n    functionName: string,\n    logMessage: string,\n    messageLevel: number,\n    CMIElement?: string,\n  ) {\n    logMessage = formatMessage(functionName, logMessage, CMIElement);\n\n    if (messageLevel >= this.apiLogLevel) {\n      this.settings.onLogMessage(messageLevel, logMessage);\n    }\n  }\n\n  /**\n   * Getter for _error_codes\n   * @return {ErrorCode}\n   */\n  get error_codes(): ErrorCode {\n    return this._error_codes;\n  }\n\n  /**\n   * Getter for _settings\n   * @return {Settings}\n   */\n  get settings(): Settings {\n    return this._settings;\n  }\n\n  /**\n   * Setter for _settings\n   * @param {Settings} settings\n   */\n  set settings(settings: Settings) {\n    this._settings = { ...this._settings, ...settings };\n  }\n\n  /**\n   * Terminates the current run of the API\n   * @param {string} callbackName\n   * @param {boolean} checkTerminated\n   * @return {string}\n   */\n  async terminate(\n    callbackName: string,\n    checkTerminated: boolean,\n  ): Promise<string> {\n    let returnValue = APIConstants.global.SCORM_FALSE;\n\n    if (\n      this.checkState(\n        checkTerminated,\n        this._error_codes.TERMINATION_BEFORE_INIT,\n        this._error_codes.MULTIPLE_TERMINATION,\n      )\n    ) {\n      this.currentState = APIConstants.global.STATE_TERMINATED;\n\n      const result: ResultObject = await this.storeData(true);\n      if (typeof result.errorCode !== \"undefined\" && result.errorCode > 0) {\n        this.throwSCORMError(result.errorCode);\n      }\n      returnValue =\n        typeof result !== \"undefined\" && result.result\n          ? result.result\n          : APIConstants.global.SCORM_FALSE;\n\n      if (checkTerminated) this.lastErrorCode = \"0\";\n\n      returnValue = APIConstants.global.SCORM_TRUE;\n      this.processListeners(callbackName);\n    }\n\n    this.apiLog(\n      callbackName,\n      \"returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n    );\n    this.clearSCORMError(returnValue);\n\n    return returnValue;\n  }\n\n  /**\n   * Get the value of the CMIElement.\n   *\n   * @param {string} callbackName\n   * @param {boolean} checkTerminated\n   * @param {string} CMIElement\n   * @return {string}\n   */\n  getValue(\n    callbackName: string,\n    checkTerminated: boolean,\n    CMIElement: string,\n  ): string {\n    let returnValue: string = \"\";\n\n    if (\n      this.checkState(\n        checkTerminated,\n        this._error_codes.RETRIEVE_BEFORE_INIT,\n        this._error_codes.RETRIEVE_AFTER_TERM,\n      )\n    ) {\n      if (checkTerminated) this.lastErrorCode = \"0\";\n      try {\n        returnValue = this.getCMIValue(CMIElement);\n      } catch (e) {\n        returnValue = this.handleValueAccessException(e, returnValue);\n      }\n      this.processListeners(callbackName, CMIElement);\n    }\n\n    this.apiLog(\n      callbackName,\n      \": returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n      CMIElement,\n    );\n\n    if (returnValue === undefined) {\n      return \"\";\n    }\n\n    this.clearSCORMError(returnValue);\n\n    return returnValue;\n  }\n\n  /**\n   * Sets the value of the CMIElement.\n   *\n   * @param {string} callbackName\n   * @param {string} commitCallback\n   * @param {boolean} checkTerminated\n   * @param {string} CMIElement\n   * @param {*} value\n   * @return {string}\n   */\n  setValue(\n    callbackName: string,\n    commitCallback: string,\n    checkTerminated: boolean,\n    CMIElement: string,\n    value: any,\n  ): string {\n    if (value !== undefined) {\n      value = String(value);\n    }\n    let returnValue: string = APIConstants.global.SCORM_FALSE;\n\n    if (\n      this.checkState(\n        checkTerminated,\n        this._error_codes.STORE_BEFORE_INIT,\n        this._error_codes.STORE_AFTER_TERM,\n      )\n    ) {\n      if (checkTerminated) this.lastErrorCode = \"0\";\n      try {\n        returnValue = this.setCMIValue(CMIElement, value);\n      } catch (e) {\n        this.handleValueAccessException(e, returnValue);\n      }\n      this.processListeners(callbackName, CMIElement, value);\n    }\n\n    if (returnValue === undefined) {\n      returnValue = APIConstants.global.SCORM_FALSE;\n    }\n\n    // If we didn't have any errors while setting the data, go ahead and\n    // schedule a commit, if autocommit is turned on\n    if (String(this.lastErrorCode) === \"0\") {\n      if (this.settings.autocommit && !this._timeout) {\n        this.scheduleCommit(\n          this.settings.autocommitSeconds * 1000,\n          commitCallback,\n        );\n      }\n    }\n\n    this.apiLog(\n      callbackName,\n      \": \" + value + \": result: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n      CMIElement,\n    );\n    this.clearSCORMError(returnValue);\n\n    return returnValue;\n  }\n\n  /**\n   * Orders LMS to store all content parameters\n   * @param {string} callbackName\n   * @param {boolean} checkTerminated\n   * @return {string}\n   */\n  async commit(\n    callbackName: string,\n    checkTerminated: boolean = false,\n  ): Promise<string> {\n    this.clearScheduledCommit();\n\n    let returnValue = APIConstants.global.SCORM_FALSE;\n\n    if (\n      this.checkState(\n        checkTerminated,\n        this._error_codes.COMMIT_BEFORE_INIT,\n        this._error_codes.COMMIT_AFTER_TERM,\n      )\n    ) {\n      const result = await this.storeData(false);\n      if (result.errorCode && result.errorCode > 0) {\n        this.throwSCORMError(result.errorCode);\n      }\n      returnValue =\n        typeof result !== \"undefined\" && result.result\n          ? result.result\n          : APIConstants.global.SCORM_FALSE;\n\n      this.apiLog(\n        callbackName,\n        \" Result: \" + returnValue,\n        APIConstants.global.LOG_LEVEL_DEBUG,\n        \"HttpRequest\",\n      );\n\n      if (checkTerminated) this.lastErrorCode = \"0\";\n\n      this.processListeners(callbackName);\n    }\n\n    this.apiLog(\n      callbackName,\n      \"returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n    );\n    this.clearSCORMError(returnValue);\n\n    return returnValue;\n  }\n\n  /**\n   * Returns last error code\n   * @param {string} callbackName\n   * @return {string}\n   */\n  getLastError(callbackName: string): string {\n    const returnValue = String(this.lastErrorCode);\n\n    this.processListeners(callbackName);\n\n    this.apiLog(\n      callbackName,\n      \"returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n    );\n\n    return returnValue;\n  }\n\n  /**\n   * Returns the errorNumber error description\n   *\n   * @param {string} callbackName\n   * @param {(string|number)} CMIErrorCode\n   * @return {string}\n   */\n  getErrorString(callbackName: string, CMIErrorCode: string | number): string {\n    let returnValue = \"\";\n\n    if (CMIErrorCode !== null && CMIErrorCode !== \"\") {\n      returnValue = this.getLmsErrorMessageDetails(CMIErrorCode);\n      this.processListeners(callbackName);\n    }\n\n    this.apiLog(\n      callbackName,\n      \"returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n    );\n\n    return returnValue;\n  }\n\n  /**\n   * Returns a comprehensive description of the errorNumber error.\n   *\n   * @param {string} callbackName\n   * @param {(string|number)} CMIErrorCode\n   * @return {string}\n   */\n  getDiagnostic(callbackName: string, CMIErrorCode: string | number): string {\n    let returnValue = \"\";\n\n    if (CMIErrorCode !== null && CMIErrorCode !== \"\") {\n      returnValue = this.getLmsErrorMessageDetails(CMIErrorCode, true);\n      this.processListeners(callbackName);\n    }\n\n    this.apiLog(\n      callbackName,\n      \"returned: \" + returnValue,\n      APIConstants.global.LOG_LEVEL_INFO,\n    );\n\n    return returnValue;\n  }\n\n  /**\n   * Checks the LMS state and ensures it has been initialized.\n   *\n   * @param {boolean} checkTerminated\n   * @param {number} beforeInitError\n   * @param {number} afterTermError\n   * @return {boolean}\n   */\n  checkState(\n    checkTerminated: boolean,\n    beforeInitError: number,\n    afterTermError: number,\n  ): boolean {\n    if (this.isNotInitialized()) {\n      this.throwSCORMError(beforeInitError);\n      return false;\n    } else if (checkTerminated && this.isTerminated()) {\n      this.throwSCORMError(afterTermError);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Returns the message that corresponds to errorNumber\n   * APIs that inherit BaseAPI should override this function\n   *\n   * @param {(string|number)} _errorNumber\n   * @param {boolean} _detail\n   * @return {string}\n   * @abstract\n   */\n  getLmsErrorMessageDetails(\n    _errorNumber: string | number,\n    _detail: boolean = false,\n  ): string {\n    throw new Error(\n      \"The getLmsErrorMessageDetails method has not been implemented\",\n    );\n  }\n\n  /**\n   * Gets the value for the specific element.\n   * APIs that inherit BaseAPI should override this function\n   *\n   * @param {string} _CMIElement\n   * @return {string}\n   * @abstract\n   */\n  getCMIValue(_CMIElement: string): string {\n    throw new Error(\"The getCMIValue method has not been implemented\");\n  }\n\n  /**\n   * Sets the value for the specific element.\n   * APIs that inherit BaseAPI should override this function\n   *\n   * @param {string} _CMIElement\n   * @param {any} _value\n   * @return {string}\n   * @abstract\n   */\n  setCMIValue(_CMIElement: string, _value: any): string {\n    throw new Error(\"The setCMIValue method has not been implemented\");\n  }\n\n  /**\n   * Shared API method to set a valid for a given element.\n   *\n   * @param {string} methodName\n   * @param {boolean} scorm2004\n   * @param {string} CMIElement\n   * @param {any} value\n   * @return {string}\n   */\n  _commonSetCMIValue(\n    methodName: string,\n    scorm2004: boolean,\n    CMIElement: string,\n    value: any,\n  ): string {\n    if (!CMIElement || CMIElement === \"\") {\n      return APIConstants.global.SCORM_FALSE;\n    }\n\n    const structure = CMIElement.split(\".\");\n    let refObject: RefObject = this;\n    let returnValue = APIConstants.global.SCORM_FALSE;\n    let foundFirstIndex = false;\n\n    const invalidErrorMessage = `The data model element passed to ${methodName} (${CMIElement}) is not a valid SCORM data model element.`;\n    const invalidErrorCode = scorm2004\n      ? this._error_codes.UNDEFINED_DATA_MODEL\n      : this._error_codes.GENERAL;\n\n    for (let idx = 0; idx < structure.length; idx++) {\n      const attribute = structure[idx];\n\n      if (idx === structure.length - 1) {\n        if (scorm2004 && attribute.substring(0, 8) === \"{target=\") {\n          if (this.isInitialized()) {\n            this.throwSCORMError(this._error_codes.READ_ONLY_ELEMENT);\n          } else {\n            refObject = {\n              ...refObject,\n              attribute: value,\n            };\n          }\n        } else if (!this._checkObjectHasProperty(refObject, attribute)) {\n          this.throwSCORMError(invalidErrorCode, invalidErrorMessage);\n        } else {\n          if (\n            stringMatches(CMIElement, \"\\\\.correct_responses\\\\.\\\\d+\") &&\n            this.isInitialized()\n          ) {\n            this.validateCorrectResponse(CMIElement, value);\n          }\n\n          if (!scorm2004 || this.lastErrorCode === \"0\") {\n            refObject[attribute] = value;\n            returnValue = APIConstants.global.SCORM_TRUE;\n          }\n        }\n      } else {\n        refObject = refObject[attribute];\n        if (!refObject) {\n          this.throwSCORMError(invalidErrorCode, invalidErrorMessage);\n          break;\n        }\n\n        if (refObject instanceof CMIArray) {\n          const index = parseInt(structure[idx + 1], 10);\n\n          // SCO is trying to set an item on an array\n          if (!isNaN(index)) {\n            const item = refObject.childArray[index];\n\n            if (item) {\n              refObject = item;\n              foundFirstIndex = true;\n            } else {\n              const newChild = this.getChildElement(\n                CMIElement,\n                value,\n                foundFirstIndex,\n              );\n              foundFirstIndex = true;\n\n              if (!newChild) {\n                this.throwSCORMError(invalidErrorCode, invalidErrorMessage);\n              } else {\n                if (refObject.initialized) newChild.initialize();\n\n                refObject.childArray.push(newChild);\n                refObject = newChild;\n              }\n            }\n\n            // Have to update idx value to skip the array position\n            idx++;\n          }\n        }\n      }\n    }\n\n    if (returnValue === APIConstants.global.SCORM_FALSE) {\n      this.apiLog(\n        methodName,\n        `There was an error setting the value for: ${CMIElement}, value of: ${value}`,\n        APIConstants.global.LOG_LEVEL_WARNING,\n      );\n    }\n\n    return returnValue;\n  }\n\n  /**\n   * Gets a value from the CMI Object\n   *\n   * @param {string} methodName\n   * @param {boolean} scorm2004\n   * @param {string} CMIElement\n   * @return {any}\n   */\n  _commonGetCMIValue(\n    methodName: string,\n    scorm2004: boolean,\n    CMIElement: string,\n  ): any {\n    if (!CMIElement || CMIElement === \"\") {\n      return \"\";\n    }\n\n    const structure = CMIElement.split(\".\");\n    let refObject: RefObject = this;\n    let attribute = null;\n\n    const uninitializedErrorMessage = `The data model element passed to ${methodName} (${CMIElement}) has not been initialized.`;\n    const invalidErrorMessage = `The data model element passed to ${methodName} (${CMIElement}) is not a valid SCORM data model element.`;\n    const invalidErrorCode = scorm2004\n      ? this._error_codes.UNDEFINED_DATA_MODEL\n      : this._error_codes.GENERAL;\n\n    for (let idx = 0; idx < structure.length; idx++) {\n      attribute = structure[idx];\n\n      if (!scorm2004) {\n        if (idx === structure.length - 1) {\n          if (!this._checkObjectHasProperty(refObject, attribute)) {\n            this.throwSCORMError(invalidErrorCode, invalidErrorMessage);\n            return;\n          }\n        }\n      } else {\n        if (\n          String(attribute).substring(0, 8) === \"{target=\" &&\n          typeof refObject._isTargetValid == \"function\"\n        ) {\n          const target = String(attribute).substring(\n            8,\n            String(attribute).length - 9,\n          );\n          return refObject._isTargetValid(target);\n        } else if (!this._checkObjectHasProperty(refObject, attribute)) {\n          this.throwSCORMError(invalidErrorCode, invalidErrorMessage);\n          return;\n        }\n      }\n\n      refObject = refObject[attribute];\n      if (refObject === undefined) {\n        this.throwSCORMError(invalidErrorCode, invalidErrorMessage);\n        break;\n      }\n\n      if (refObject instanceof CMIArray) {\n        const index = parseInt(structure[idx + 1], 10);\n\n        // SCO is trying to set an item on an array\n        if (!isNaN(index)) {\n          const item = refObject.childArray[index];\n\n          if (item) {\n            refObject = item;\n          } else {\n            this.throwSCORMError(\n              this._error_codes.VALUE_NOT_INITIALIZED,\n              uninitializedErrorMessage,\n            );\n            break;\n          }\n\n          // Have to update idx value to skip the array position\n          idx++;\n        }\n      }\n    }\n\n    if (refObject === null || refObject === undefined) {\n      if (!scorm2004) {\n        if (attribute === \"_children\") {\n          this.throwSCORMError(ErrorCodes.scorm12.CHILDREN_ERROR);\n        } else if (attribute === \"_count\") {\n          this.throwSCORMError(ErrorCodes.scorm12.COUNT_ERROR);\n        }\n      }\n    } else {\n      return refObject;\n    }\n  }\n\n  /**\n   * Returns true if the API's current state is STATE_INITIALIZED\n   *\n   * @return {boolean}\n   */\n  isInitialized(): boolean {\n    return this.currentState === APIConstants.global.STATE_INITIALIZED;\n  }\n\n  /**\n   * Returns true if the API's current state is STATE_NOT_INITIALIZED\n   *\n   * @return {boolean}\n   */\n  isNotInitialized(): boolean {\n    return this.currentState === APIConstants.global.STATE_NOT_INITIALIZED;\n  }\n\n  /**\n   * Returns true if the API's current state is STATE_TERMINATED\n   *\n   * @return {boolean}\n   */\n  isTerminated(): boolean {\n    return this.currentState === APIConstants.global.STATE_TERMINATED;\n  }\n\n  /**\n   * Provides a mechanism for attaching to a specific SCORM event\n   *\n   * @param {string} listenerName\n   * @param {function} callback\n   */\n  on(listenerName: string, callback: Function) {\n    if (!callback) return;\n\n    const listenerFunctions = listenerName.split(\" \");\n    for (let i = 0; i < listenerFunctions.length; i++) {\n      const listenerSplit = listenerFunctions[i].split(\".\");\n      if (listenerSplit.length === 0) return;\n\n      const functionName = listenerSplit[0];\n\n      let CMIElement = null;\n      if (listenerSplit.length > 1) {\n        CMIElement = listenerName.replace(functionName + \".\", \"\");\n      }\n\n      this.listenerArray.push({\n        functionName: functionName,\n        CMIElement: CMIElement,\n        callback: callback,\n      });\n\n      this.apiLog(\n        \"on\",\n        `Added event listener: ${this.listenerArray.length}`,\n        APIConstants.global.LOG_LEVEL_INFO,\n        functionName,\n      );\n    }\n  }\n\n  /**\n   * Provides a mechanism for detaching a specific SCORM event listener\n   *\n   * @param {string} listenerName\n   * @param {function} callback\n   */\n  off(listenerName: string, callback: Function) {\n    if (!callback) return;\n\n    const listenerFunctions = listenerName.split(\" \");\n    for (let i = 0; i < listenerFunctions.length; i++) {\n      const listenerSplit = listenerFunctions[i].split(\".\");\n      if (listenerSplit.length === 0) return;\n\n      const functionName = listenerSplit[0];\n\n      let CMIElement = null;\n      if (listenerSplit.length > 1) {\n        CMIElement = listenerName.replace(functionName + \".\", \"\");\n      }\n\n      const removeIndex = this.listenerArray.findIndex(\n        (obj) =>\n          obj.functionName === functionName &&\n          obj.CMIElement === CMIElement &&\n          obj.callback === callback,\n      );\n      if (removeIndex !== -1) {\n        this.listenerArray.splice(removeIndex, 1);\n        this.apiLog(\n          \"off\",\n          `Removed event listener: ${this.listenerArray.length}`,\n          APIConstants.global.LOG_LEVEL_INFO,\n          functionName,\n        );\n      }\n    }\n  }\n\n  /**\n   * Provides a mechanism for clearing all listeners from a specific SCORM event\n   *\n   * @param {string} listenerName\n   */\n  clear(listenerName: string) {\n    const listenerFunctions = listenerName.split(\" \");\n    for (let i = 0; i < listenerFunctions.length; i++) {\n      const listenerSplit = listenerFunctions[i].split(\".\");\n      if (listenerSplit.length === 0) return;\n\n      const functionName = listenerSplit[0];\n\n      let CMIElement = null;\n      if (listenerSplit.length > 1) {\n        CMIElement = listenerName.replace(functionName + \".\", \"\");\n      }\n\n      this.listenerArray = this.listenerArray.filter(\n        (obj) =>\n          obj.functionName !== functionName && obj.CMIElement !== CMIElement,\n      );\n    }\n  }\n\n  /**\n   * Processes any 'on' listeners that have been created\n   *\n   * @param {string} functionName\n   * @param {string} CMIElement\n   * @param {any} value\n   */\n  processListeners(functionName: string, CMIElement?: string, value?: any) {\n    this.apiLog(\n      functionName,\n      value,\n      APIConstants.global.LOG_LEVEL_INFO,\n      CMIElement,\n    );\n    for (let i = 0; i < this.listenerArray.length; i++) {\n      const listener = this.listenerArray[i];\n      const functionsMatch = listener.functionName === functionName;\n      const listenerHasCMIElement = !!listener.CMIElement;\n      let CMIElementsMatch = false;\n      if (\n        CMIElement &&\n        listener.CMIElement &&\n        listener.CMIElement.substring(listener.CMIElement.length - 1) === \"*\"\n      ) {\n        CMIElementsMatch =\n          CMIElement.indexOf(\n            listener.CMIElement.substring(0, listener.CMIElement.length - 1),\n          ) === 0;\n      } else {\n        CMIElementsMatch = listener.CMIElement === CMIElement;\n      }\n\n      if (functionsMatch && (!listenerHasCMIElement || CMIElementsMatch)) {\n        this.apiLog(\n          \"processListeners\",\n          `Processing listener: ${listener.functionName}`,\n          APIConstants.global.LOG_LEVEL_INFO,\n          CMIElement,\n        );\n        listener.callback(CMIElement, value);\n      }\n    }\n  }\n\n  /**\n   * Throws a SCORM error\n   *\n   * @param {number} errorNumber\n   * @param {string} message\n   */\n  throwSCORMError(errorNumber: number, message?: string) {\n    if (!message) {\n      message = this.getLmsErrorMessageDetails(errorNumber);\n    }\n\n    this.apiLog(\n      \"throwSCORMError\",\n      errorNumber + \": \" + message,\n      APIConstants.global.LOG_LEVEL_ERROR,\n    );\n\n    this.lastErrorCode = String(errorNumber);\n  }\n\n  /**\n   * Clears the last SCORM error code on success.\n   *\n   * @param {string} success\n   */\n  clearSCORMError(success: string) {\n    if (success !== undefined && success !== APIConstants.global.SCORM_FALSE) {\n      this.lastErrorCode = \"0\";\n    }\n  }\n\n  /**\n   * Load the CMI from a flattened JSON object\n   * @param {RefObject} json\n   * @param {string} CMIElement\n   */\n  loadFromFlattenedJSON(json: RefObject, CMIElement?: string) {\n    if (!CMIElement) {\n      // by default, we start from a blank string because we're expecting each element to start with `cmi`\n      CMIElement = \"\";\n    }\n    if (!this.isNotInitialized()) {\n      console.error(\n        \"loadFromFlattenedJSON can only be called before the call to lmsInitialize.\",\n      );\n      return;\n    }\n\n    /**\n     * Tests two strings against a given regular expression pattern and determines a numeric or null result based on the matching criterion.\n     *\n     * @param {string} a - The first string to be tested against the pattern.\n     * @param {string} c - The second string to be tested against the pattern.\n     * @param {RegExp} a_pattern - The regular expression pattern to test the strings against.\n     * @return {number | null} A numeric result based on the matching criterion, or null if the strings do not match the pattern.\n     */\n    function testPattern(\n      a: string,\n      c: string,\n      a_pattern: RegExp,\n    ): number | null {\n      const a_match = a.match(a_pattern);\n\n      let c_match;\n      if (a_match !== null && (c_match = c.match(a_pattern)) !== null) {\n        const a_num = Number(a_match[2]);\n        const c_num = Number(c_match[2]);\n        if (a_num === c_num) {\n          if (a_match[3] === \"id\") {\n            return -1;\n          } else if (a_match[3] === \"type\") {\n            if (c_match[3] === \"id\") {\n              return 1;\n            } else {\n              return -1;\n            }\n          } else {\n            return 1;\n          }\n        }\n        return a_num - c_num;\n      }\n\n      return null;\n    }\n\n    const int_pattern = /^(cmi\\.interactions\\.)(\\d+)\\.(.*)$/;\n    const obj_pattern = /^(cmi\\.objectives\\.)(\\d+)\\.(.*)$/;\n\n    const result = Object.keys(json).map(function (key) {\n      return [String(key), json[key]];\n    });\n\n    // CMI interactions need to have id and type loaded before any other fields\n    result.sort(function ([a, _b], [c, _d]) {\n      let test;\n      if ((test = testPattern(a, c, int_pattern)) !== null) {\n        return test;\n      }\n      if ((test = testPattern(a, c, obj_pattern)) !== null) {\n        return test;\n      }\n\n      if (a < c) {\n        return -1;\n      }\n      if (a > c) {\n        return 1;\n      }\n      return 0;\n    });\n\n    let obj: RefObject;\n    result.forEach((element) => {\n      obj = {};\n      obj[element[0]] = element[1];\n      this.loadFromJSON(unflatten(obj), CMIElement);\n    });\n  }\n\n  /**\n   * Loads CMI data from a JSON object.\n   *\n   * @param {RefObject} json\n   * @param {string} CMIElement\n   */\n  loadFromJSON(json: RefObject, CMIElement: string) {\n    if (!this.isNotInitialized()) {\n      console.error(\n        \"loadFromJSON can only be called before the call to lmsInitialize.\",\n      );\n      return;\n    }\n\n    CMIElement = CMIElement !== undefined ? CMIElement : \"cmi\";\n\n    this.startingData = json;\n\n    // could this be refactored down to flatten(json) then setCMIValue on each?\n    for (const key in json) {\n      if ({}.hasOwnProperty.call(json, key) && json[key]) {\n        const currentCMIElement = (CMIElement ? CMIElement + \".\" : \"\") + key;\n        const value = json[key];\n\n        if (value[\"childArray\"]) {\n          for (let i = 0; i < value[\"childArray\"].length; i++) {\n            this.loadFromJSON(\n              value[\"childArray\"][i],\n              currentCMIElement + \".\" + i,\n            );\n          }\n        } else if (value.constructor === Object) {\n          this.loadFromJSON(value, currentCMIElement);\n        } else {\n          this.setCMIValue(currentCMIElement, value);\n        }\n      }\n    }\n  }\n\n  /**\n   * Render the CMI object to JSON for sending to an LMS.\n   *\n   * @return {string}\n   */\n  renderCMIToJSONString(): string {\n    const cmi = this.cmi;\n    // Do we want/need to return fields that have no set value?\n    if (this.settings.sendFullCommit) {\n      return JSON.stringify({ cmi });\n    }\n    return JSON.stringify({ cmi }, (k, v) => (v === undefined ? null : v), 2);\n  }\n\n  /**\n   * Returns a JS object representing the current cmi\n   * @return {object}\n   */\n  renderCMIToJSONObject(): object {\n    return JSON.parse(this.renderCMIToJSONString());\n  }\n\n  /**\n   * Send the request to the LMS\n   * @param {string} url\n   * @param {CommitObject|RefObject|Array} params\n   * @param {boolean} immediate\n   * @return {ResultObject}\n   */\n  async processHttpRequest(\n    url: string,\n    params: CommitObject | RefObject | Array<any>,\n    immediate: boolean = false,\n  ): Promise<ResultObject> {\n    const api = this;\n    const genericError: ResultObject = {\n      result: APIConstants.global.SCORM_FALSE,\n      errorCode: this.error_codes.GENERAL,\n    };\n\n    // if we are terminating the module or closing the browser window/tab, we need to make this fetch ASAP.\n    // Some browsers, especially Chrome, do not like synchronous requests to be made when the window is closing.\n    if (immediate) {\n      this.performFetch(url, params).then(async (response) => {\n        await this.transformResponse(response);\n      });\n      return {\n        result: APIConstants.global.SCORM_TRUE,\n        errorCode: 0,\n      };\n    }\n\n    const process = async (\n      url: string,\n      params: CommitObject | RefObject | Array<any>,\n      settings: Settings,\n    ): Promise<ResultObject> => {\n      try {\n        params = settings.requestHandler(params);\n        const response = await this.performFetch(url, params);\n\n        return this.transformResponse(response);\n      } catch (e) {\n        this.apiLog(\n          \"processHttpRequest\",\n          e,\n          APIConstants.global.LOG_LEVEL_ERROR,\n        );\n        api.processListeners(\"CommitError\");\n        return genericError;\n      }\n    };\n\n    if (this.settings.asyncCommit) {\n      const debouncedProcess = debounce(process, 500, immediate);\n      debouncedProcess(url, params, this.settings);\n\n      return {\n        result: APIConstants.global.SCORM_TRUE,\n        errorCode: 0,\n      };\n    } else {\n      return await process(url, params, this.settings);\n    }\n  }\n\n  /**\n   * Throws a SCORM error\n   *\n   * @param {number} when - the number of milliseconds to wait before committing\n   * @param {string} callback - the name of the commit event callback\n   */\n  scheduleCommit(when: number, callback: string) {\n    this._timeout = new ScheduledCommit(this, when, callback);\n    this.apiLog(\n      \"scheduleCommit\",\n      \"scheduled\",\n      APIConstants.global.LOG_LEVEL_DEBUG,\n      \"\",\n    );\n  }\n\n  /**\n   * Clears and cancels any currently scheduled commits\n   */\n  clearScheduledCommit() {\n    if (this._timeout) {\n      this._timeout.cancel();\n      this._timeout = undefined;\n      this.apiLog(\n        \"clearScheduledCommit\",\n        \"cleared\",\n        APIConstants.global.LOG_LEVEL_DEBUG,\n        \"\",\n      );\n    }\n  }\n\n  /**\n   * Check to see if the specific object has the given property\n   * @param {RefObject} refObject\n   * @param {string} attribute\n   * @return {boolean}\n   * @private\n   */\n  private _checkObjectHasProperty(\n    refObject: RefObject,\n    attribute: string,\n  ): boolean {\n    return (\n      Object.hasOwnProperty.call(refObject, attribute) ||\n      Object.getOwnPropertyDescriptor(\n        Object.getPrototypeOf(refObject),\n        attribute,\n      ) != null ||\n      attribute in refObject\n    );\n  }\n\n  /**\n   * Handles the error that occurs when trying to access a value\n   * @param {any} e\n   * @param {string} returnValue\n   * @return {string}\n   * @private\n   */\n  private handleValueAccessException(e: any, returnValue: string): string {\n    if (e instanceof ValidationError) {\n      this.lastErrorCode = String(e.errorCode);\n      returnValue = APIConstants.global.SCORM_FALSE;\n    } else {\n      if (e instanceof Error && e.message) {\n        console.error(e.message);\n      } else {\n        console.error(e);\n      }\n      this.throwSCORMError(this._error_codes.GENERAL);\n    }\n    return returnValue;\n  }\n\n  /**\n   * Perform the fetch request to the LMS\n   * @param {string} url\n   * @param {RefObject|Array} params\n   * @return {Promise<Response>}\n   * @private\n   */\n  private async performFetch(\n    url: string,\n    params: RefObject | Array<any>,\n  ): Promise<Response> {\n    return fetch(url, {\n      method: \"POST\",\n      body: params instanceof Array ? params.join(\"&\") : JSON.stringify(params),\n      headers: {\n        ...this.settings.xhrHeaders,\n        \"Content-Type\": this.settings.commitRequestDataType,\n      },\n      credentials: this.settings.xhrWithCredentials ? \"include\" : undefined,\n      keepalive: true,\n    });\n  }\n\n  /**\n   * Transforms the response from the LMS to a ResultObject\n   * @param {Response} response\n   * @return {Promise<ResultObject>}\n   * @private\n   */\n  private async transformResponse(response: Response): Promise<ResultObject> {\n    const result =\n      typeof this.settings.responseHandler === \"function\"\n        ? await this.settings.responseHandler(response)\n        : await response.json();\n\n    if (\n      response.status >= 200 &&\n      response.status <= 299 &&\n      (result.result === true ||\n        result.result === APIConstants.global.SCORM_TRUE)\n    ) {\n      this.processListeners(\"CommitSuccess\");\n    } else {\n      this.processListeners(\"CommitError\");\n    }\n    return result;\n  }\n}\n","/**\n * Debounce function to delay the execution of a given function.\n *\n * @param func - The function to debounce.\n * @param wait - The number of milliseconds to delay.\n * @param immediate - If `true`, the function will be triggered on the leading edge instead of the trailing.\n * @returns A debounced version of the provided function.\n */\nexport function debounce<T extends (...args: any[]) => void>(\n  func: T,\n  wait: number,\n  immediate = false,\n): (...args: Parameters<T>) => void {\n  let timeout: ReturnType<typeof setTimeout> | null;\n\n  return function (this: any, ...args: Parameters<T>) {\n    const context = this;\n\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n\n    const callNow = immediate && !timeout;\n\n    if (timeout) clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n\n    if (callNow) func.apply(context, args);\n  };\n}\n","const scorm12 = {\n  CMIString256: \"^.{0,255}$\",\n  CMIString4096: \"^.{0,4096}$\",\n  CMITime: \"^(?:[01]\\\\d|2[0123]):(?:[012345]\\\\d):(?:[012345]\\\\d)$\",\n  CMITimespan: \"^([0-9]{2,}):([0-9]{2}):([0-9]{2})(.[0-9]{1,2})?$\",\n\n  CMIInteger: \"^\\\\d+$\",\n  CMISInteger: \"^-?([0-9]+)$\",\n  CMIDecimal: \"^-?([0-9]{0,3})(.[0-9]*)?$\",\n\n  CMIIdentifier: \"^[\\\\u0021-\\\\u007E\\\\s]{0,255}$\",\n  CMIFeedback: \"^.{0,255}$\",\n  // This must be redefined\n  CMIIndex: \"[._](\\\\d+).\",\n  // Vocabulary Data Type Definition\n  CMIStatus: \"^(passed|completed|failed|incomplete|browsed)$\",\n  CMIStatus2: \"^(passed|completed|failed|incomplete|browsed|not attempted)$\",\n  CMIExit: \"^(time-out|suspend|logout|)$\",\n  CMIType:\n    \"^(true-false|choice|fill-in|matching|performance|sequencing|likert|numeric)$\",\n  CMIResult:\n    \"^(correct|wrong|unanticipated|neutral|([0-9]{0,3})?(\\\\.[0-9]*)?)$\",\n  NAVEvent: \"^(previous|continue)$\",\n  // Data ranges\n  score_range: \"0#100\",\n  audio_range: \"-1#100\",\n  speed_range: \"-100#100\",\n  weighting_range: \"-100#100\",\n  text_range: \"-1#1\",\n};\nconst aicc = {\n  ...scorm12,\n  ...{\n    CMIIdentifier: \"^\\\\w{1,255}$\",\n  },\n};\nconst scorm2004 = {\n  CMIString200: \"^[\\\\u0000-\\\\uFFFF]{0,200}$\",\n  CMIString250: \"^[\\\\u0000-\\\\uFFFF]{0,250}$\",\n  CMIString1000: \"^[\\\\u0000-\\\\uFFFF]{0,1000}$\",\n  CMIString4000: \"^[\\\\u0000-\\\\uFFFF]{0,4000}$\",\n  CMIString64000: \"^[\\\\u0000-\\\\uFFFF]{0,64000}$\",\n  CMILang: \"^([a-zA-Z]{2,3}|i|x)(-[a-zA-Z0-9-]{2,8})?$|^$\",\n\n  CMILangString250:\n    \"^({lang=([a-zA-Z]{2,3}|i|x)(-[a-zA-Z0-9-]{2,8})?})?((?!{.*$).{0,250}$)?$\",\n\n  CMILangcr: \"^(({lang=([a-zA-Z]{2,3}|i|x)?(-[a-zA-Z0-9-]{2,8})?}))(.*?)$\",\n\n  CMILangString250cr:\n    \"^(({lang=([a-zA-Z]{2,3}|i|x)?(-[a-zA-Z0-9-]{2,8})?})?(.{0,250})?)?$\",\n\n  CMILangString4000:\n    \"^({lang=([a-zA-Z]{2,3}|i|x)(-[a-zA-Z0-9-]{2,8})?})?((?!{.*$).{0,4000}$)?$\",\n\n  CMITime:\n    \"^(19[7-9]{1}[0-9]{1}|20[0-2]{1}[0-9]{1}|203[0-8]{1})((-(0[1-9]{1}|1[0-2]{1}))((-(0[1-9]{1}|[1-2]{1}[0-9]{1}|3[0-1]{1}))(T([0-1]{1}[0-9]{1}|2[0-3]{1})((:[0-5]{1}[0-9]{1})((:[0-5]{1}[0-9]{1})((\\\\.[0-9]{1,2})((Z|([+|-]([0-1]{1}[0-9]{1}|2[0-3]{1})))(:[0-5]{1}[0-9]{1})?)?)?)?)?)?)?)?$\",\n  CMITimespan:\n    \"^P(?:([.,\\\\d]+)Y)?(?:([.,\\\\d]+)M)?(?:([.,\\\\d]+)W)?(?:([.,\\\\d]+)D)?(?:T?(?:([.,\\\\d]+)H)?(?:([.,\\\\d]+)M)?(?:([.,\\\\d]+)S)?)?$\",\n  CMIInteger: \"^\\\\d+$\",\n  CMISInteger: \"^-?([0-9]+)$\",\n  CMIDecimal: \"^-?([0-9]{1,5})(\\\\.[0-9]{1,18})?$\",\n  CMIIdentifier: \"^\\\\S{1,250}[a-zA-Z0-9]$\",\n  CMIShortIdentifier: \"^[\\\\w\\\\.\\\\-\\\\_]{1,250}$\",\n  CMILongIdentifier:\n    \"^(?:(?!urn:)\\\\S{1,4000}|urn:[A-Za-z0-9-]{1,31}:\\\\S{1,4000}|.{1,4000})$\",\n  // need to re-examine this\n  CMIFeedback: \"^.*$\",\n  // This must be redefined\n  CMIIndex: \"[._](\\\\d+).\",\n  CMIIndexStore: \".N(\\\\d+).\",\n  // Vocabulary Data Type Definition\n  CMICStatus: \"^(completed|incomplete|not attempted|unknown)$\",\n  CMISStatus: \"^(passed|failed|unknown)$\",\n  CMIExit: \"^(time-out|suspend|logout|normal)$\",\n  CMIType:\n    \"^(true-false|choice|fill-in|long-fill-in|matching|performance|sequencing|likert|numeric|other)$\",\n  CMIResult:\n    \"^(correct|incorrect|unanticipated|neutral|-?([0-9]{1,4})(\\\\.[0-9]{1,18})?)$\",\n  NAVEvent:\n    \"^(previous|continue|exit|exitAll|abandon|abandonAll|suspendAll|_none_|(\\\\{target=\\\\S{0,}[a-zA-Z0-9-_]+})?choice|(\\\\{target=\\\\S{0,}[a-zA-Z0-9-_]+})?jump)$\",\n\n  NAVBoolean: \"^(unknown|true|false$)\",\n  NAVTarget: \"^{target=\\\\S{0,}[a-zA-Z0-9-_]+}$\",\n  // Data ranges\n  scaled_range: \"-1#1\",\n  audio_range: \"0#*\",\n  speed_range: \"0#*\",\n  text_range: \"-1#1\",\n  progress_range: \"0#1\",\n};\nconst Regex = {\n  aicc: aicc,\n  scorm12: scorm12,\n  scorm2004: scorm2004,\n};\nexport default Regex;\n","import { BaseScormValidationError } from \"../../exceptions\";\n\n/**\n * Check if the value matches the proper format. If not, throw proper error code.\n *\n * @param {string} value\n * @param {string} regexPattern\n * @param {number} errorCode\n * @param {typeof BaseScormValidationError} errorClass\n * @param {boolean} [allowEmptyString]\n * @return {boolean}\n */\nexport function checkValidFormat(\n  value: string,\n  regexPattern: string,\n  errorCode: number,\n  errorClass: typeof BaseScormValidationError,\n  allowEmptyString?: boolean,\n): boolean {\n  if (typeof value !== \"string\") {\n    return false;\n  }\n  const formatRegex = new RegExp(regexPattern);\n  const matches = value.match(formatRegex);\n  if (allowEmptyString && value === \"\") {\n    return true;\n  }\n  if (value === undefined || !matches || matches[0] === \"\") {\n    throw new errorClass(errorCode);\n  }\n  return true;\n}\n\n/**\n * Check if the value matches the proper range. If not, throw proper error code.\n *\n * @param {any} value\n * @param {string} rangePattern\n * @param {number} errorCode\n * @param {typeof BaseScormValidationError} errorClass\n * @return {boolean}\n */\nexport function checkValidRange(\n  value: any,\n  rangePattern: string,\n  errorCode: number,\n  errorClass: typeof BaseScormValidationError,\n): boolean {\n  const ranges = rangePattern.split(\"#\");\n  value = value * 1.0;\n  if (value >= ranges[0]) {\n    if (ranges[1] === \"*\" || value <= ranges[1]) {\n      return true;\n    } else {\n      throw new errorClass(errorCode);\n    }\n  } else {\n    throw new errorClass(errorCode);\n  }\n}\n","import {checkValidFormat, checkValidRange} from \"../common/validation\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport {Scorm12ValidationError} from \"../../exceptions\";\n\n/**\n * Helper method, no reason to have to pass the same error codes every time\n * @param {string} value\n * @param {string} regexPattern\n * @param {boolean} allowEmptyString\n * @return {boolean}\n */\nexport function check12ValidFormat(\n  value: string,\n  regexPattern: string,\n  allowEmptyString?: boolean,\n): boolean {\n  return checkValidFormat(\n    value,\n    regexPattern,\n    ErrorCodes.scorm12.TYPE_MISMATCH,\n    Scorm12ValidationError,\n    allowEmptyString,\n  );\n}\n\n/**\n * Helper method, no reason to have to pass the same error codes every time\n * @param {string} value\n * @param {string} rangePattern\n * @param {boolean} allowEmptyString\n * @return {boolean}\n */\nexport function check12ValidRange(\n  value: any,\n  rangePattern: string,\n  allowEmptyString?: boolean,\n): boolean {\n  if (!allowEmptyString && value === \"\") {\n    throw new Scorm12ValidationError(ErrorCodes.scorm12.VALUE_OUT_OF_RANGE);\n  }\n\n  return checkValidRange(\n    value,\n    rangePattern,\n    ErrorCodes.scorm12.VALUE_OUT_OF_RANGE,\n    Scorm12ValidationError,\n  );\n}","import APIConstants from \"../../constants/api_constants\";\nimport Regex from \"../../constants/regex\";\nimport { BaseCMI } from \"./base_cmi\";\nimport { checkValidFormat, checkValidRange } from \"./validation\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport { BaseScormValidationError } from \"../../exceptions\";\n\nconst scorm12_constants = APIConstants.scorm12;\nconst scorm12_regex = Regex.scorm12;\nexport const scorm12_error_codes = ErrorCodes.scorm12;\n\n/**\n * Base class for cmi *.score objects\n */\nexport class CMIScore extends BaseCMI {\n  private readonly __children: string;\n  private readonly __score_range: string | false;\n  private readonly __invalid_error_code: number;\n  private readonly __invalid_type_code: number;\n  private readonly __invalid_range_code: number;\n  private readonly __decimal_regex: string;\n  private readonly __error_class: typeof BaseScormValidationError;\n  private _raw = \"\";\n  private _min = \"\";\n  private _max: string;\n\n  /**\n   * Constructor for *.score\n   * @param {\n   *     score_children: string,\n   *     score_range: string,\n   *     max: string,\n   *     invalidErrorCode: number,\n   *     invalidTypeCode: number,\n   *     invalidRangeCode: number,\n   *     decimalRegex: string,\n   *     errorClass: typeof BaseScormValidationError\n   * } params\n   */\n  constructor(params: {\n    score_children?: string;\n    score_range?: string;\n    max?: string;\n    invalidErrorCode?: number;\n    invalidTypeCode?: number;\n    invalidRangeCode?: number;\n    decimalRegex?: string;\n    errorClass: typeof BaseScormValidationError;\n  }) {\n    super();\n\n    this.__children = params.score_children || scorm12_constants.score_children;\n    this.__score_range = !params.score_range\n      ? false\n      : scorm12_regex.score_range;\n    this._max = params.max || params.max === \"\" ? params.max : \"100\";\n    this.__invalid_error_code =\n      params.invalidErrorCode || scorm12_error_codes.INVALID_SET_VALUE;\n    this.__invalid_type_code =\n      params.invalidTypeCode || scorm12_error_codes.TYPE_MISMATCH;\n    this.__invalid_range_code =\n      params.invalidRangeCode || scorm12_error_codes.VALUE_OUT_OF_RANGE;\n    this.__decimal_regex = params.decimalRegex || scorm12_regex.CMIDecimal;\n    this.__error_class = params.errorClass;\n  }\n\n  /**\n   * Getter for _children\n   * @return {string}\n   */\n  get _children(): string {\n    return this.__children;\n  }\n\n  /**\n   * Setter for _children. Just throws an error.\n   * @param {string} _children\n   */\n  set _children(_children: string) {\n    throw new this.__error_class(this.__invalid_error_code);\n  }\n\n  /**\n   * Getter for _raw\n   * @return {string}\n   */\n  get raw(): string {\n    return this._raw;\n  }\n\n  /**\n   * Setter for _raw\n   * @param {string} raw\n   */\n  set raw(raw: string) {\n    if (\n      checkValidFormat(\n        raw,\n        this.__decimal_regex,\n        this.__invalid_type_code,\n        this.__error_class,\n      ) &&\n      (!this.__score_range ||\n        checkValidRange(\n          raw,\n          this.__score_range,\n          this.__invalid_range_code,\n          this.__error_class,\n        ))\n    ) {\n      this._raw = raw;\n    }\n  }\n\n  /**\n   * Getter for _min\n   * @return {string}\n   */\n  get min(): string {\n    return this._min;\n  }\n\n  /**\n   * Setter for _min\n   * @param {string} min\n   */\n  set min(min: string) {\n    if (\n      checkValidFormat(\n        min,\n        this.__decimal_regex,\n        this.__invalid_type_code,\n        this.__error_class,\n      ) &&\n      (!this.__score_range ||\n        checkValidRange(\n          min,\n          this.__score_range,\n          this.__invalid_range_code,\n          this.__error_class,\n        ))\n    ) {\n      this._min = min;\n    }\n  }\n\n  /**\n   * Getter for _max\n   * @return {string}\n   */\n  get max(): string {\n    return this._max;\n  }\n\n  /**\n   * Setter for _max\n   * @param {string} max\n   */\n  set max(max: string) {\n    if (\n      checkValidFormat(\n        max,\n        this.__decimal_regex,\n        this.__invalid_type_code,\n        this.__error_class,\n      ) &&\n      (!this.__score_range ||\n        checkValidRange(\n          max,\n          this.__score_range,\n          this.__invalid_range_code,\n          this.__error_class,\n        ))\n    ) {\n      this._max = max;\n    }\n  }\n\n  /**\n   * toJSON for *.score\n   * @return {\n   *    {\n   *      min: string,\n   *      max: string,\n   *      raw: string\n   *    }\n   *    }\n   */\n  toJSON(): {\n    min: string;\n    max: string;\n    raw: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      raw: this.raw,\n      min: this.min,\n      max: this.max,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n","export enum NAVBoolean {\n  unknown = \"unknown\",\n  true = \"true\",\n  false = \"false\",\n}\n\nexport enum SuccessStatus {\n  passed = \"passed\",\n  failed = \"failed\",\n  unknown = \"unknown\",\n}\n\nexport enum CompletionStatus {\n  completed = \"completed\",\n  incomplete = \"incomplete\",\n  unknown = \"unknown\",\n}\n","import { BaseCMI } from \"../common/base_cmi\";\nimport { CMIScore } from \"../common/score\";\nimport APIConstants from \"../../constants/api_constants\";\nimport Regex from \"../../constants/regex\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport { Scorm12ValidationError } from \"../../exceptions\";\nimport { check12ValidFormat } from \"../scorm12/validation\";\nimport * as Util from \"../../utilities\";\n\n/**\n * Class representing the `cmi.core` object\n * @extends BaseCMI\n */\nexport class CMICore extends BaseCMI {\n  /**\n   * Constructor for `cmi.core`\n   */\n  constructor() {\n    super();\n    this.score = new CMIScore({\n      score_children: APIConstants.scorm12.score_children,\n      score_range: Regex.scorm12.score_range,\n      invalidErrorCode: ErrorCodes.scorm12.INVALID_SET_VALUE,\n      invalidTypeCode: ErrorCodes.scorm12.TYPE_MISMATCH,\n      invalidRangeCode: ErrorCodes.scorm12.VALUE_OUT_OF_RANGE,\n      errorClass: Scorm12ValidationError,\n    });\n  }\n\n  public readonly score: CMIScore;\n\n  /**\n   * Called when the API has been initialized after the CMI has been created\n   */\n  initialize() {\n    super.initialize();\n    this.score?.initialize();\n  }\n\n  private __children = APIConstants.scorm12.core_children;\n  private _student_id = \"\";\n  private _student_name = \"\";\n  private _lesson_location = \"\";\n  private _credit = \"\";\n  private _lesson_status = \"not attempted\";\n  private _entry = \"\";\n  private _total_time = \"\";\n  private _lesson_mode = \"normal\";\n  private _exit = \"\";\n  private _session_time = \"00:00:00\";\n  private _suspend_data = \"\";\n\n  /**\n   * Getter for __children\n   * @return {string}\n   * @private\n   */\n  get _children(): string {\n    return this.__children;\n  }\n\n  /**\n   * Setter for __children. Just throws an error.\n   * @param {string} _children\n   * @private\n   */\n  set _children(_children: string) {\n    throw new Scorm12ValidationError(ErrorCodes.scorm12.INVALID_SET_VALUE);\n  }\n\n  /**\n   * Getter for _student_id\n   * @return {string}\n   */\n  get student_id(): string {\n    return this._student_id;\n  }\n\n  /**\n   * Setter for _student_id. Can only be called before  initialization.\n   * @param {string} student_id\n   */\n  set student_id(student_id: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._student_id = student_id;\n    }\n  }\n\n  /**\n   * Getter for _student_name\n   * @return {string}\n   */\n  get student_name(): string {\n    return this._student_name;\n  }\n\n  /**\n   * Setter for _student_name. Can only be called before  initialization.\n   * @param {string} student_name\n   */\n  set student_name(student_name: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._student_name = student_name;\n    }\n  }\n\n  /**\n   * Getter for _lesson_location\n   * @return {string}\n   */\n  get lesson_location(): string {\n    return this._lesson_location;\n  }\n\n  /**\n   * Setter for _lesson_location\n   * @param {string} lesson_location\n   */\n  set lesson_location(lesson_location: string) {\n    if (check12ValidFormat(lesson_location, Regex.scorm12.CMIString256, true)) {\n      this._lesson_location = lesson_location;\n    }\n  }\n\n  /**\n   * Getter for _credit\n   * @return {string}\n   */\n  get credit(): string {\n    return this._credit;\n  }\n\n  /**\n   * Setter for _credit. Can only be called before  initialization.\n   * @param {string} credit\n   */\n  set credit(credit: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._credit = credit;\n    }\n  }\n\n  /**\n   * Getter for _lesson_status\n   * @return {string}\n   */\n  get lesson_status(): string {\n    return this._lesson_status;\n  }\n\n  /**\n   * Setter for _lesson_status\n   * @param {string} lesson_status\n   */\n  set lesson_status(lesson_status: string) {\n    if (this.initialized) {\n      if (check12ValidFormat(lesson_status, Regex.scorm12.CMIStatus)) {\n        this._lesson_status = lesson_status;\n      }\n    } else {\n      if (check12ValidFormat(lesson_status, Regex.scorm12.CMIStatus2)) {\n        this._lesson_status = lesson_status;\n      }\n    }\n  }\n\n  /**\n   * Getter for _entry\n   * @return {string}\n   */\n  get entry(): string {\n    return this._entry;\n  }\n\n  /**\n   * Setter for _entry. Can only be called before  initialization.\n   * @param {string} entry\n   */\n  set entry(entry: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._entry = entry;\n    }\n  }\n\n  /**\n   * Getter for _total_time\n   * @return {string}\n   */\n  get total_time(): string {\n    return this._total_time;\n  }\n\n  /**\n   * Setter for _total_time. Can only be called before  initialization.\n   * @param {string} total_time\n   */\n  set total_time(total_time: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._total_time = total_time;\n    }\n  }\n\n  /**\n   * Getter for _lesson_mode\n   * @return {string}\n   */\n  get lesson_mode(): string {\n    return this._lesson_mode;\n  }\n\n  /**\n   * Setter for _lesson_mode. Can only be called before  initialization.\n   * @param {string} lesson_mode\n   */\n  set lesson_mode(lesson_mode: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._lesson_mode = lesson_mode;\n    }\n  }\n\n  /**\n   * Getter for _exit. Should only be called during JSON export.\n   * @return {string}\n   */\n  get exit(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._exit;\n  }\n\n  /**\n   * Setter for _exit\n   * @param {string} exit\n   */\n  set exit(exit: string) {\n    if (check12ValidFormat(exit, Regex.scorm12.CMIExit, true)) {\n      this._exit = exit;\n    }\n  }\n\n  /**\n   * Getter for _session_time. Should only be called during JSON export.\n   * @return {string}\n   */\n  get session_time(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._session_time;\n  }\n\n  /**\n   * Setter for _session_time\n   * @param {string} session_time\n   */\n  set session_time(session_time: string) {\n    if (check12ValidFormat(session_time, Regex.scorm12.CMITimespan)) {\n      this._session_time = session_time;\n    }\n  }\n\n  /**\n   * Getter for _suspend_data\n   * @return {string}\n   */\n  get suspend_data(): string {\n    return this._suspend_data;\n  }\n\n  /**\n   * Setter for _suspend_data\n   * @param {string} suspend_data\n   */\n  set suspend_data(suspend_data: string) {\n    if (check12ValidFormat(suspend_data, Regex.scorm12.CMIString4096, true)) {\n      this._suspend_data = suspend_data;\n    }\n  }\n\n  /**\n   * Adds the current session time to the existing total time.\n   * @param {number} start_time\n   * @return {string}\n   */\n  getCurrentTotalTime(start_time: number | undefined): string {\n    let sessionTime = this._session_time;\n    const startTime = start_time;\n\n    if (typeof startTime !== \"undefined\" && startTime !== null) {\n      const seconds = new Date().getTime() - startTime;\n      sessionTime = Util.getSecondsAsHHMMSS(seconds / 1000);\n    }\n\n    return Util.addHHMMSSTimeStrings(\n      this._total_time,\n      sessionTime,\n      new RegExp(Regex.scorm12.CMITimespan),\n    );\n  }\n\n  /**\n   * toJSON for cmi.core\n   *\n   * @return {\n   *    {\n   *      student_name: string,\n   *      entry: string,\n   *      exit: string,\n   *      score: CMIScore,\n   *      student_id: string,\n   *      lesson_mode: string,\n   *      lesson_location: string,\n   *      lesson_status: string,\n   *      credit: string,\n   *      session_time: string\n   *    }\n   *  }\n   */\n  toJSON(): {\n    student_name: string;\n    entry: string;\n    exit: string;\n    score: CMIScore;\n    student_id: string;\n    lesson_mode: string;\n    lesson_location: string;\n    lesson_status: string;\n    credit: string;\n    session_time: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      student_id: this.student_id,\n      student_name: this.student_name,\n      lesson_location: this.lesson_location,\n      credit: this.credit,\n      lesson_status: this.lesson_status,\n      entry: this.entry,\n      lesson_mode: this.lesson_mode,\n      exit: this.exit,\n      session_time: this.session_time,\n      score: this.score,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n","import {BaseCMI} from \"../common/base_cmi\";\nimport {CMIScore} from \"../common/score\";\nimport APIConstants from \"../../constants/api_constants\";\nimport Regex from \"../../constants/regex\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport {Scorm12ValidationError} from \"../../exceptions\";\nimport {check12ValidFormat} from \"./validation\";\nimport {CMIArray} from \"../common/array\";\n\n/**\n * Class representing SCORM 1.2's `cmi.objectives` object\n * @extends CMIArray\n */\nexport class CMIObjectives extends CMIArray {\n  /**\n   * Constructor for `cmi.objectives`\n   */\n  constructor() {\n    super({\n      children: APIConstants.scorm12.objectives_children,\n      errorCode: ErrorCodes.scorm12.INVALID_SET_VALUE,\n      errorClass: Scorm12ValidationError,\n    });\n  }\n}\n\n/**\n * Class representing SCORM 1.2's cmi.objectives.n object\n * @extends BaseCMI\n */\nexport class CMIObjectivesObject extends BaseCMI {\n  /**\n   * Constructor for cmi.objectives.n\n   */\n  constructor() {\n    super();\n    this.score = new CMIScore({\n      score_children: APIConstants.scorm12.score_children,\n      score_range: Regex.scorm12.score_range,\n      invalidErrorCode: ErrorCodes.scorm12.INVALID_SET_VALUE,\n      invalidTypeCode: ErrorCodes.scorm12.TYPE_MISMATCH,\n      invalidRangeCode: ErrorCodes.scorm12.VALUE_OUT_OF_RANGE,\n      errorClass: Scorm12ValidationError,\n    });\n  }\n\n  public readonly score: CMIScore;\n\n  private _id = \"\";\n  private _status = \"\";\n\n  /**\n   * Getter for _id\n   * @return {string}\n   */\n  get id(): string {\n    return this._id;\n  }\n\n  /**\n   * Setter for _id\n   * @param {string} id\n   */\n  set id(id: string) {\n    if (check12ValidFormat(id, Regex.scorm12.CMIIdentifier)) {\n      this._id = id;\n    }\n  }\n\n  /**\n   * Getter for _status\n   * @return {string}\n   */\n  get status(): string {\n    return this._status;\n  }\n\n  /**\n   * Setter for _status\n   * @param {string} status\n   */\n  set status(status: string) {\n    if (check12ValidFormat(status, Regex.scorm12.CMIStatus2)) {\n      this._status = status;\n    }\n  }\n\n  /**\n   * toJSON for cmi.objectives.n\n   * @return {\n   *    {\n   *      id: string,\n   *      status: string,\n   *      score: CMIScore\n   *    }\n   *  }\n   */\n  toJSON(): {\n    id: string;\n    status: string;\n    score: CMIScore;\n  } {\n    this.jsonString = true;\n    const result = {\n      id: this.id,\n      status: this.status,\n      score: this.score,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}","import { BaseCMI } from \"../common/base_cmi\";\nimport APIConstants from \"../../constants/api_constants\";\nimport { Scorm12ValidationError } from \"../../exceptions\";\nimport ErrorCodes from \"../../constants/error_codes\";\n\n/**\n * Class representing the SCORM 1.2 cmi.student_data object\n * @extends BaseCMI\n */\nexport class CMIStudentData extends BaseCMI {\n  private readonly __children;\n  private _mastery_score = \"\";\n  private _max_time_allowed = \"\";\n  private _time_limit_action = \"\";\n\n  /**\n   * Constructor for cmi.student_data\n   * @param {string} student_data_children\n   */\n  constructor(student_data_children?: string) {\n    super();\n    this.__children = student_data_children\n      ? student_data_children\n      : APIConstants.scorm12.student_data_children;\n  }\n\n  /**\n   * Getter for __children\n   * @return {string}\n   * @private\n   */\n  get _children(): string {\n    return this.__children;\n  }\n\n  /**\n   * Setter for __children. Just throws an error.\n   * @param {string} _children\n   * @private\n   */\n  set _children(_children: string) {\n    throw new Scorm12ValidationError(ErrorCodes.scorm12.INVALID_SET_VALUE);\n  }\n\n  /**\n   * Getter for _master_score\n   * @return {string}\n   */\n  get mastery_score(): string {\n    return this._mastery_score;\n  }\n\n  /**\n   * Setter for _master_score. Can only be called before  initialization.\n   * @param {string} mastery_score\n   */\n  set mastery_score(mastery_score: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._mastery_score = mastery_score;\n    }\n  }\n\n  /**\n   * Getter for _max_time_allowed\n   * @return {string}\n   */\n  get max_time_allowed(): string {\n    return this._max_time_allowed;\n  }\n\n  /**\n   * Setter for _max_time_allowed. Can only be called before  initialization.\n   * @param {string} max_time_allowed\n   */\n  set max_time_allowed(max_time_allowed: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._max_time_allowed = max_time_allowed;\n    }\n  }\n\n  /**\n   * Getter for _time_limit_action\n   * @return {string}\n   */\n  get time_limit_action(): string {\n    return this._time_limit_action;\n  }\n\n  /**\n   * Setter for _time_limit_action. Can only be called before  initialization.\n   * @param {string} time_limit_action\n   */\n  set time_limit_action(time_limit_action: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._time_limit_action = time_limit_action;\n    }\n  }\n\n  /**\n   * toJSON for cmi.student_data\n   *\n   * @return {\n   *    {\n   *      max_time_allowed: string,\n   *      time_limit_action: string,\n   *      mastery_score: string\n   *    }\n   *  }\n   */\n  toJSON(): {\n    mastery_score: string;\n    max_time_allowed: string;\n    time_limit_action: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      mastery_score: this.mastery_score,\n      max_time_allowed: this.max_time_allowed,\n      time_limit_action: this.time_limit_action,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n","import { BaseCMI } from \"../common/base_cmi\";\nimport APIConstants from \"../../constants/api_constants\";\nimport { Scorm12ValidationError } from \"../../exceptions\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport { check12ValidFormat, check12ValidRange } from \"./validation\";\nimport Regex from \"../../constants/regex\";\n\n/**\n * Class representing the SCORM 1.2 cmi.student_preference object\n * @extends BaseCMI\n */\nexport class CMIStudentPreference extends BaseCMI {\n  private readonly __children;\n\n  /**\n   * Constructor for cmi.student_preference\n   * @param {string} student_preference_children\n   */\n  constructor(student_preference_children?: string) {\n    super();\n    this.__children = student_preference_children\n      ? student_preference_children\n      : APIConstants.scorm12.student_preference_children;\n  }\n\n  private _audio = \"\";\n  private _language = \"\";\n  private _speed = \"\";\n  private _text = \"\";\n\n  /**\n   * Getter for __children\n   * @return {string}\n   * @private\n   */\n  get _children(): string {\n    return this.__children;\n  }\n\n  /**\n   * Setter for __children. Just throws an error.\n   * @param {string} _children\n   * @private\n   */\n  set _children(_children: string) {\n    throw new Scorm12ValidationError(ErrorCodes.scorm12.INVALID_SET_VALUE);\n  }\n\n  /**\n   * Getter for _audio\n   * @return {string}\n   */\n  get audio(): string {\n    return this._audio;\n  }\n\n  /**\n   * Setter for _audio\n   * @param {string} audio\n   */\n  set audio(audio: string) {\n    if (\n      check12ValidFormat(audio, Regex.scorm12.CMISInteger) &&\n      check12ValidRange(audio, Regex.scorm12.audio_range)\n    ) {\n      this._audio = audio;\n    }\n  }\n\n  /**\n   * Getter for _language\n   * @return {string}\n   */\n  get language(): string {\n    return this._language;\n  }\n\n  /**\n   * Setter for _language\n   * @param {string} language\n   */\n  set language(language: string) {\n    if (check12ValidFormat(language, Regex.scorm12.CMIString256)) {\n      this._language = language;\n    }\n  }\n\n  /**\n   * Getter for _speed\n   * @return {string}\n   */\n  get speed(): string {\n    return this._speed;\n  }\n\n  /**\n   * Setter for _speed\n   * @param {string} speed\n   */\n  set speed(speed: string) {\n    if (\n      check12ValidFormat(speed, Regex.scorm12.CMISInteger) &&\n      check12ValidRange(speed, Regex.scorm12.speed_range)\n    ) {\n      this._speed = speed;\n    }\n  }\n\n  /**\n   * Getter for _text\n   * @return {string}\n   */\n  get text(): string {\n    return this._text;\n  }\n\n  /**\n   * Setter for _text\n   * @param {string} text\n   */\n  set text(text: string) {\n    if (\n      check12ValidFormat(text, Regex.scorm12.CMISInteger) &&\n      check12ValidRange(text, Regex.scorm12.text_range)\n    ) {\n      this._text = text;\n    }\n  }\n\n  /**\n   * toJSON for cmi.student_preference\n   *\n   * @return {\n   *    {\n   *      audio: string,\n   *      language: string,\n   *      speed: string,\n   *      text: string\n   *    }\n   *  }\n   */\n  toJSON(): {\n    audio: string;\n    language: string;\n    speed: string;\n    text: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      audio: this.audio,\n      language: this.language,\n      speed: this.speed,\n      text: this.text,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n","import { CMIArray } from \"../common/array\";\nimport APIConstants from \"../../constants/api_constants\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport { Scorm12ValidationError } from \"../../exceptions\";\nimport { BaseCMI } from \"../common/base_cmi\";\nimport { check12ValidFormat, check12ValidRange } from \"./validation\";\nimport Regex from \"../../constants/regex\";\n\n/**\n * Class representing the SCORM 1.2 `cmi.interactions`\n * @extends CMIArray\n */\nexport class CMIInteractions extends CMIArray {\n  /**\n   * Constructor for `cmi.interactions`\n   */\n  constructor() {\n    super({\n      children: APIConstants.scorm12.interactions_children,\n      errorCode: ErrorCodes.scorm12.INVALID_SET_VALUE,\n      errorClass: Scorm12ValidationError,\n    });\n  }\n}\n\n/**\n * Class representing SCORM 1.2's cmi.interactions.n object\n * @extends BaseCMI\n */\nexport class CMIInteractionsObject extends BaseCMI {\n  /**\n   * Constructor for cmi.interactions.n object\n   */\n  constructor() {\n    super();\n    this.objectives = new CMIArray({\n      errorCode: ErrorCodes.scorm12.INVALID_SET_VALUE,\n      errorClass: Scorm12ValidationError,\n      children: APIConstants.scorm12.objectives_children,\n    });\n    this.correct_responses = new CMIArray({\n      errorCode: ErrorCodes.scorm12.INVALID_SET_VALUE,\n      errorClass: Scorm12ValidationError,\n      children: APIConstants.scorm12.correct_responses_children,\n    });\n  }\n\n  public readonly objectives: CMIArray;\n  public readonly correct_responses: CMIArray;\n\n  /**\n   * Called when the API has been initialized after the CMI has been created\n   */\n  initialize() {\n    super.initialize();\n    this.objectives?.initialize();\n    this.correct_responses?.initialize();\n  }\n\n  private _id = \"\";\n  private _time = \"\";\n  private _type = \"\";\n  private _weighting = \"\";\n  private _student_response = \"\";\n  private _result = \"\";\n  private _latency = \"\";\n\n  /**\n   * Getter for _id. Should only be called during JSON export.\n   * @return {string}\n   */\n  get id(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._id;\n  }\n\n  /**\n   * Setter for _id\n   * @param {string} id\n   */\n  set id(id: string) {\n    if (check12ValidFormat(id, Regex.scorm12.CMIIdentifier)) {\n      this._id = id;\n    }\n  }\n\n  /**\n   * Getter for _time. Should only be called during JSON export.\n   * @return {string}\n   */\n  get time(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._time;\n  }\n\n  /**\n   * Setter for _time\n   * @param {string} time\n   */\n  set time(time: string) {\n    if (check12ValidFormat(time, Regex.scorm12.CMITime)) {\n      this._time = time;\n    }\n  }\n\n  /**\n   * Getter for _type. Should only be called during JSON export.\n   * @return {string}\n   */\n  get type(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._type;\n  }\n\n  /**\n   * Setter for _type\n   * @param {string} type\n   */\n  set type(type: string) {\n    if (check12ValidFormat(type, Regex.scorm12.CMIType)) {\n      this._type = type;\n    }\n  }\n\n  /**\n   * Getter for _weighting. Should only be called during JSON export.\n   * @return {string}\n   */\n  get weighting(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._weighting;\n  }\n\n  /**\n   * Setter for _weighting\n   * @param {string} weighting\n   */\n  set weighting(weighting: string) {\n    if (\n      check12ValidFormat(weighting, Regex.scorm12.CMIDecimal) &&\n      check12ValidRange(weighting, Regex.scorm12.weighting_range)\n    ) {\n      this._weighting = weighting;\n    }\n  }\n\n  /**\n   * Getter for _student_response. Should only be called during JSON export.\n   * @return {string}\n   */\n  get student_response(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._student_response;\n  }\n\n  /**\n   * Setter for _student_response\n   * @param {string} student_response\n   */\n  set student_response(student_response: string) {\n    if (check12ValidFormat(student_response, Regex.scorm12.CMIFeedback, true)) {\n      this._student_response = student_response;\n    }\n  }\n\n  /**\n   * Getter for _result. Should only be called during JSON export.\n   * @return {string}\n   */\n  get result(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._result;\n  }\n\n  /**\n   * Setter for _result\n   * @param {string} result\n   */\n  set result(result: string) {\n    if (check12ValidFormat(result, Regex.scorm12.CMIResult)) {\n      this._result = result;\n    }\n  }\n\n  /**\n   * Getter for _latency. Should only be called during JSON export.\n   * @return {string}\n   */\n  get latency(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._latency;\n  }\n\n  /**\n   * Setter for _latency\n   * @param {string} latency\n   */\n  set latency(latency: string) {\n    if (check12ValidFormat(latency, Regex.scorm12.CMITimespan)) {\n      this._latency = latency;\n    }\n  }\n\n  /**\n   * toJSON for cmi.interactions.n\n   *\n   * @return {\n   *    {\n   *      id: string,\n   *      time: string,\n   *      type: string,\n   *      weighting: string,\n   *      student_response: string,\n   *      result: string,\n   *      latency: string,\n   *      objectives: CMIArray,\n   *      correct_responses: CMIArray\n   *    }\n   *  }\n   */\n  toJSON(): {\n    id: string;\n    time: string;\n    type: string;\n    weighting: string;\n    student_response: string;\n    result: string;\n    latency: string;\n    objectives: CMIArray;\n    correct_responses: CMIArray;\n  } {\n    this.jsonString = true;\n    const result = {\n      id: this.id,\n      time: this.time,\n      type: this.type,\n      weighting: this.weighting,\n      student_response: this.student_response,\n      result: this.result,\n      latency: this.latency,\n      objectives: this.objectives,\n      correct_responses: this.correct_responses,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n\n/**\n * Class representing SCORM 1.2's cmi.interactions.n.objectives.n object\n * @extends BaseCMI\n */\nexport class CMIInteractionsObjectivesObject extends BaseCMI {\n  /**\n   * Constructor for cmi.interactions.n.objectives.n\n   */\n  constructor() {\n    super();\n  }\n\n  private _id = \"\";\n\n  /**\n   * Getter for _id\n   * @return {string}\n   */\n  get id(): string {\n    return this._id;\n  }\n\n  /**\n   * Setter for _id\n   * @param {string} id\n   */\n  set id(id: string) {\n    if (check12ValidFormat(id, Regex.scorm12.CMIIdentifier)) {\n      this._id = id;\n    }\n  }\n\n  /**\n   * toJSON for cmi.interactions.n.objectives.n\n   * @return {\n   *    {\n   *      id: string\n   *    }\n   *  }\n   */\n  toJSON(): {\n    id: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      id: this.id,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n\n/**\n * Class representing SCORM 1.2's cmi.interactions.correct_responses.n object\n * @extends BaseCMI\n */\nexport class CMIInteractionsCorrectResponsesObject extends BaseCMI {\n  /**\n   * Constructor for cmi.interactions.correct_responses.n\n   */\n  constructor() {\n    super();\n  }\n\n  private _pattern = \"\";\n\n  /**\n   * Getter for _pattern\n   * @return {string}\n   */\n  get pattern(): string {\n    if (!this.jsonString) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.WRITE_ONLY_ELEMENT);\n    }\n    return this._pattern;\n  }\n\n  /**\n   * Setter for _pattern\n   * @param {string} pattern\n   */\n  set pattern(pattern: string) {\n    if (check12ValidFormat(pattern, Regex.scorm12.CMIFeedback, true)) {\n      this._pattern = pattern;\n    }\n  }\n\n  /**\n   * toJSON for cmi.interactions.correct_responses.n\n   * @return {\n   *    {\n   *      pattern: string\n   *    }\n   *  }\n   */\n  toJSON(): {\n    pattern: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      pattern: this._pattern,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}\n","import APIConstants from \"../../constants/api_constants\";\nimport ErrorCodes from \"../../constants/error_codes\";\nimport Regex from \"../../constants/regex\";\nimport { Scorm12ValidationError } from \"../../exceptions\";\nimport { BaseRootCMI } from \"../common/base_cmi\";\nimport { check12ValidFormat } from \"./validation\";\nimport { CMICore } from \"../aicc/core\";\nimport { CMIObjectives } from \"./objectives\";\nimport { CMIStudentData } from \"./student_data\";\nimport { CMIStudentPreference } from \"./student_preference\";\nimport { CMIInteractions } from \"./interactions\";\n\n/**\n * Class representing the cmi object for SCORM 1.2\n */\nexport class CMI extends BaseRootCMI {\n  private readonly __children: string = \"\";\n  private __version: string = \"3.4\";\n  private _launch_data: string = \"\";\n  private _comments: string = \"\";\n  private _comments_from_lms: string = \"\";\n\n  /**\n   * Constructor for the SCORM 1.2 cmi object\n   * @param {string} cmi_children\n   * @param {(CMIStudentData|AICCCMIStudentData)} student_data\n   * @param {boolean} initialized\n   */\n  constructor(\n    cmi_children?: string,\n    student_data?: CMIStudentData,\n    initialized?: boolean,\n  ) {\n    super();\n    if (initialized) this.initialize();\n    this.__children = cmi_children\n      ? cmi_children\n      : APIConstants.scorm12.cmi_children;\n    this.core = new CMICore();\n    this.objectives = new CMIObjectives();\n    this.student_data = student_data ? student_data : new CMIStudentData();\n    this.student_preference = new CMIStudentPreference();\n    this.interactions = new CMIInteractions();\n  }\n\n  public core: CMICore;\n  public objectives: CMIObjectives;\n  public student_data: CMIStudentData;\n  public student_preference: CMIStudentPreference;\n  public interactions: CMIInteractions;\n\n  /**\n   * Called when the API has been initialized after the CMI has been created\n   */\n  initialize() {\n    super.initialize();\n    this.core?.initialize();\n    this.objectives?.initialize();\n    this.student_data?.initialize();\n    this.student_preference?.initialize();\n    this.interactions?.initialize();\n  }\n\n  /**\n   * toJSON for cmi\n   *\n   * @return {\n   *    {\n   *      suspend_data: string,\n   *      launch_data: string,\n   *      comments: string,\n   *      comments_from_lms: string,\n   *      core: CMICore,\n   *      objectives: CMIObjectives,\n   *      student_data: CMIStudentData,\n   *      student_preference: CMIStudentPreference,\n   *      interactions: CMIInteractions\n   *    }\n   *  }\n   */\n  toJSON(): {\n    suspend_data: string;\n    launch_data: string;\n    comments: string;\n    comments_from_lms: string;\n    core: CMICore;\n    objectives: CMIObjectives;\n    student_data: CMIStudentData;\n    student_preference: CMIStudentPreference;\n    interactions: CMIInteractions;\n  } {\n    this.jsonString = true;\n    const result = {\n      suspend_data: this.suspend_data,\n      launch_data: this.launch_data,\n      comments: this.comments,\n      comments_from_lms: this.comments_from_lms,\n      core: this.core,\n      objectives: this.objectives,\n      student_data: this.student_data,\n      student_preference: this.student_preference,\n      interactions: this.interactions,\n    };\n    delete this.jsonString;\n    return result;\n  }\n\n  /**\n   * Getter for __version\n   * @return {string}\n   */\n  get _version(): string {\n    return this.__version;\n  }\n\n  /**\n   * Setter for __version. Just throws an error.\n   * @param {string} _version\n   */\n  set _version(_version: string) {\n    throw new Scorm12ValidationError(ErrorCodes.scorm12.INVALID_SET_VALUE);\n  }\n\n  /**\n   * Getter for __children\n   * @return {string}\n   */\n  get _children(): string {\n    return this.__children;\n  }\n\n  /**\n   * Setter for __version. Just throws an error.\n   * @param {string} _children\n   */\n  set _children(_children: string) {\n    throw new Scorm12ValidationError(ErrorCodes.scorm12.INVALID_SET_VALUE);\n  }\n\n  /**\n   * Getter for _suspend_data\n   * @return {string}\n   */\n  get suspend_data(): string {\n    return this.core?.suspend_data;\n  }\n\n  /**\n   * Setter for _suspend_data\n   * @param {string} suspend_data\n   */\n  set suspend_data(suspend_data: string) {\n    if (this.core) {\n      this.core.suspend_data = suspend_data;\n    }\n  }\n\n  /**\n   * Getter for _launch_data\n   * @return {string}\n   */\n  get launch_data(): string {\n    return this._launch_data;\n  }\n\n  /**\n   * Setter for _launch_data. Can only be called before  initialization.\n   * @param {string} launch_data\n   */\n  set launch_data(launch_data: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._launch_data = launch_data;\n    }\n  }\n\n  /**\n   * Getter for _comments\n   * @return {string}\n   */\n  get comments(): string {\n    return this._comments;\n  }\n\n  /**\n   * Setter for _comments\n   * @param {string} comments\n   */\n  set comments(comments: string) {\n    if (check12ValidFormat(comments, Regex.scorm12.CMIString4096, true)) {\n      this._comments = comments;\n    }\n  }\n\n  /**\n   * Getter for _comments_from_lms\n   * @return {string}\n   */\n  get comments_from_lms(): string {\n    return this._comments_from_lms;\n  }\n\n  /**\n   * Setter for _comments_from_lms. Can only be called before  initialization.\n   * @param {string} comments_from_lms\n   */\n  set comments_from_lms(comments_from_lms: string) {\n    if (this.initialized) {\n      throw new Scorm12ValidationError(ErrorCodes.scorm12.READ_ONLY_ELEMENT);\n    } else {\n      this._comments_from_lms = comments_from_lms;\n    }\n  }\n\n  /**\n   * Adds the current session time to the existing total time.\n   *\n   * @return {string}\n   */\n  getCurrentTotalTime(): string {\n    return this.core.getCurrentTotalTime(this.start_time);\n  }\n}\n","import {BaseCMI} from \"../common/base_cmi\";\nimport {check12ValidFormat} from \"./validation\";\nimport Regex from \"../../constants/regex\";\n\n/**\n * Class for AICC Navigation object\n */\nexport class NAV extends BaseCMI {\n  /**\n   * Constructor for NAV object\n   */\n  constructor() {\n    super();\n  }\n\n  private _event = \"\";\n\n  /**\n   * Getter for _event\n   * @return {string}\n   */\n  get event(): string {\n    return this._event;\n  }\n\n  /**\n   * Setter for _event\n   * @param {string} event\n   */\n  set event(event: string) {\n    if (check12ValidFormat(event, Regex.scorm12.NAVEvent)) {\n      this._event = event;\n    }\n  }\n\n  /**\n   * toJSON for nav object\n   * @return {\n   *    {\n   *      event: string\n   *    }\n   *  }\n   */\n  toJSON(): {\n    event: string;\n  } {\n    this.jsonString = true;\n    const result = {\n      event: this.event,\n    };\n    delete this.jsonString;\n    return result;\n  }\n}","import BaseAPI from \"./BaseAPI\";\nimport { CMI } from \"./cmi/scorm12/cmi\";\nimport * as Utilities from \"./utilities\";\nimport { stringMatches } from \"./utilities\";\nimport APIConstants from \"./constants/api_constants\";\nimport ErrorCodes from \"./constants/error_codes\";\n\nimport { BaseCMI } from \"./cmi/common/base_cmi\";\nimport { CMIObjectivesObject } from \"./cmi/scorm12/objectives\";\nimport {\n  CMIInteractionsCorrectResponsesObject,\n  CMIInteractionsObject,\n  CMIInteractionsObjectivesObject,\n} from \"./cmi/scorm12/interactions\";\nimport { NAV } from \"./cmi/scorm12/nav\";\nimport {\n  CommitObject,\n  RefObject,\n  ResultObject,\n  ScoreObject,\n  Settings,\n} from \"./types/api_types\";\nimport Regex from \"./constants/regex\";\nimport { CompletionStatus, SuccessStatus } from \"./constants/enums\";\n\n/**\n * API class for SCORM 1.2\n */\nexport default class Scorm12API extends BaseAPI {\n  /**\n   * Constructor for SCORM 1.2 API\n   * @param {object} settings\n   */\n  constructor(settings?: Settings) {\n    if (settings) {\n      if (settings.mastery_override === undefined) {\n        settings.mastery_override = false;\n      }\n    }\n\n    super(ErrorCodes.scorm12, settings);\n\n    this.cmi = new CMI();\n    this.nav = new NAV();\n\n    // Rename functions to match 1.2 Spec and expose to modules\n    this.LMSInitialize = this.lmsInitialize;\n    this.LMSFinish = this.lmsFinish;\n    this.LMSGetValue = this.lmsGetValue;\n    this.LMSSetValue = this.lmsSetValue;\n    this.LMSCommit = this.lmsCommit;\n    this.LMSGetLastError = this.lmsGetLastError;\n    this.LMSGetErrorString = this.lmsGetErrorString;\n    this.LMSGetDiagnostic = this.lmsGetDiagnostic;\n  }\n\n  public statusSetByModule = false;\n\n  public cmi: CMI;\n  public nav: NAV;\n\n  public LMSInitialize: () => string;\n  public LMSFinish: () => string;\n  public LMSGetValue: (CMIElement: string) => string;\n  public LMSSetValue: (CMIElement: string, value: any) => string;\n  public LMSCommit: () => string;\n  public LMSGetLastError: () => string;\n  public LMSGetErrorString: (CMIErrorCode: string) => string;\n  public LMSGetDiagnostic: (CMIErrorCode: string) => string;\n\n  /**\n   * Called when the API needs to be reset\n   */\n  reset(settings?: Settings) {\n    this.commonReset(settings);\n\n    this.cmi = new CMI();\n    this.nav = new NAV();\n  }\n\n  /**\n   * lmsInitialize function from SCORM 1.2 Spec\n   *\n   * @return {string} bool\n   */\n  lmsInitialize(): string {\n    this.cmi.initialize();\n    if (this.cmi.core.lesson_status) {\n      this.statusSetByModule = true;\n    } else {\n      this.cmi.core.lesson_status = \"not attempted\";\n    }\n    return this.initialize(\n      \"LMSInitialize\",\n      \"LMS was already initialized!\",\n      \"LMS is already finished!\",\n    );\n  }\n\n  /**\n   * LMSFinish function from SCORM 1.2 Spec\n   *\n   * @return {string} bool\n   */\n  lmsFinish(): string {\n    (async () => {\n      await this.internalFinish();\n    })();\n    return APIConstants.global.SCORM_TRUE;\n  }\n\n  async internalFinish(): Promise<string> {\n    const result = await this.terminate(\"LMSFinish\", true);\n\n    if (result === APIConstants.global.SCORM_TRUE) {\n      if (this.nav.event !== \"\") {\n        if (this.nav.event === \"continue\") {\n          this.processListeners(\"SequenceNext\");\n        } else {\n          this.processListeners(\"SequencePrevious\");\n        }\n      } else if (this.settings.autoProgress) {\n        this.processListeners(\"SequenceNext\");\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * LMSGetValue function from SCORM 1.2 Spec\n   *\n   * @param {string} CMIElement\n   * @return {string}\n   */\n  lmsGetValue(CMIElement: string): string {\n    return this.getValue(\"LMSGetValue\", false, CMIElement);\n  }\n\n  /**\n   * LMSSetValue function from SCORM 1.2 Spec\n   *\n   * @param {string} CMIElement\n   * @param {*} value\n   * @return {string}\n   */\n  lmsSetValue(CMIElement: string, value: any): string {\n    if (CMIElement === \"cmi.core.lesson_status\") {\n      this.statusSetByModule = true;\n    }\n    return this.setValue(\"LMSSetValue\", \"LMSCommit\", false, CMIElement, value);\n  }\n\n  /**\n   * LMSCommit function from SCORM 1.2 Spec\n   *\n   * @return {string} bool\n   */\n  lmsCommit(): string {\n    (async () => {\n      await this.commit(\"LMSCommit\", false);\n    })();\n    return APIConstants.global.SCORM_TRUE;\n  }\n\n  /**\n   * LMSGetLastError function from SCORM 1.2 Spec\n   *\n   * @return {string}\n   */\n  lmsGetLastError(): string {\n    return this.getLastError(\"LMSGetLastError\");\n  }\n\n  /**\n   * LMSGetErrorString function from SCORM 1.2 Spec\n   *\n   * @param {string} CMIErrorCode\n   * @return {string}\n   */\n  lmsGetErrorString(CMIErrorCode: string): string {\n    return this.getErrorString(\"LMSGetErrorString\", CMIErrorCode);\n  }\n\n  /**\n   * LMSGetDiagnostic function from SCORM 1.2 Spec\n   *\n   * @param {string} CMIErrorCode\n   * @return {string}\n   */\n  lmsGetDiagnostic(CMIErrorCode: string): string {\n    return this.getDiagnostic(\"LMSGetDiagnostic\", CMIErrorCode);\n  }\n\n  /**\n   * Sets a value on the CMI Object\n   *\n   * @param {string} CMIElement\n   * @param {*} value\n   * @return {string}\n   */\n  setCMIValue(CMIElement: string, value: any): string {\n    return this._commonSetCMIValue(\"LMSSetValue\", false, CMIElement, value);\n  }\n\n  /**\n   * Gets a value from the CMI Object\n   *\n   * @param {string} CMIElement\n   * @return {*}\n   */\n  getCMIValue(CMIElement: string): any {\n    return this._commonGetCMIValue(\"getCMIValue\", false, CMIElement);\n  }\n\n  /**\n   * Gets or builds a new child element to add to the array.\n   *\n   * @param {string} CMIElement\n   * @param {*} _value\n   * @param {boolean} foundFirstIndex\n   * @return {BaseCMI|null}\n   */\n  getChildElement(\n    CMIElement: string,\n    _value: any,\n    foundFirstIndex: boolean,\n  ): BaseCMI | null {\n    if (stringMatches(CMIElement, \"cmi\\\\.objectives\\\\.\\\\d+\")) {\n      return new CMIObjectivesObject();\n    } else if (\n      foundFirstIndex &&\n      stringMatches(\n        CMIElement,\n        \"cmi\\\\.interactions\\\\.\\\\d+\\\\.correct_responses\\\\.\\\\d+\",\n      )\n    ) {\n      return new CMIInteractionsCorrectResponsesObject();\n    } else if (\n      foundFirstIndex &&\n      stringMatches(CMIElement, \"cmi\\\\.interactions\\\\.\\\\d+\\\\.objectives\\\\.\\\\d+\")\n    ) {\n      return new CMIInteractionsObjectivesObject();\n    } else if (\n      !foundFirstIndex &&\n      stringMatches(CMIElement, \"cmi\\\\.interactions\\\\.\\\\d+\")\n    ) {\n      return new CMIInteractionsObject();\n    }\n\n    return null;\n  }\n\n  /**\n   * Validates Correct Response values\n   *\n   * @param {string} _CMIElement\n   * @param {*} _value\n   */\n  validateCorrectResponse(_CMIElement: string, _value: any) {\n    // do nothing\n  }\n\n  /**\n   * Returns the message that corresponds to errorNumber.\n   *\n   * @param {number|string} errorNumber\n   * @param {boolean} detail\n   * @return {string}\n   */\n  getLmsErrorMessageDetails(\n    errorNumber: number | string,\n    detail: boolean,\n  ): string {\n    let basicMessage = \"No Error\";\n    let detailMessage = \"No Error\";\n\n    // Set error number to string since inconsistent from modules if string or number\n    errorNumber = String(errorNumber);\n    if (APIConstants.scorm12.error_descriptions[errorNumber]) {\n      basicMessage =\n        APIConstants.scorm12.error_descriptions[errorNumber].basicMessage;\n      detailMessage =\n        APIConstants.scorm12.error_descriptions[errorNumber].detailMessage;\n    }\n\n    return detail ? detailMessage : basicMessage;\n  }\n\n  /**\n   * Replace the whole API with another\n   *\n   * @param {Scorm12API} newAPI\n   */\n  replaceWithAnotherScormAPI(newAPI: Scorm12API) {\n    // Data Model\n    this.cmi = newAPI.cmi;\n  }\n\n  /**\n   * Render the cmi object to the proper format for LMS commit\n   *\n   * @param {boolean} terminateCommit\n   * @return {object|Array}\n   */\n  renderCommitCMI(terminateCommit: boolean): object | Array<any> {\n    const cmiExport: RefObject = this.renderCMIToJSONObject();\n\n    if (terminateCommit) {\n      cmiExport.cmi.core.total_time = this.cmi.getCurrentTotalTime();\n    }\n\n    const result = [];\n    const flattened: RefObject = Utilities.flatten(cmiExport);\n    switch (this.settings.dataCommitFormat) {\n      case \"flattened\":\n        return Utilities.flatten(cmiExport);\n      case \"params\":\n        for (const item in flattened) {\n          if ({}.hasOwnProperty.call(flattened, item)) {\n            result.push(`${item}=${flattened[item]}`);\n          }\n        }\n        return result;\n      case \"json\":\n      default:\n        return cmiExport;\n    }\n  }\n\n  /**\n   * Render the cmi object to the proper format for LMS commit\n   * @param {boolean} terminateCommit\n   * @return {CommitObject}\n   */\n  renderCommitObject(terminateCommit: boolean): CommitObject {\n    const cmiExport = this.renderCommitCMI(terminateCommit);\n    const totalTimeHHMMSS = this.cmi.getCurrentTotalTime();\n    const totalTimeSeconds = Utilities.getTimeAsSeconds(\n      totalTimeHHMMSS,\n      Regex.scorm12.CMITimespan,\n    );\n    const lessonStatus = this.cmi.core.lesson_status;\n    let completionStatus = CompletionStatus.unknown;\n    let successStatus = SuccessStatus.unknown;\n    if (lessonStatus) {\n      completionStatus =\n        lessonStatus === \"completed\" || lessonStatus === \"passed\"\n          ? CompletionStatus.completed\n          : CompletionStatus.incomplete;\n      if (lessonStatus === \"passed\") {\n        successStatus = SuccessStatus.passed;\n      } else if (lessonStatus === \"failed\") {\n        successStatus = SuccessStatus.failed;\n      }\n    }\n\n    const score = this.cmi.core.score;\n    let scoreObject: ScoreObject = null;\n    if (score) {\n      scoreObject = {};\n\n      if (!Number.isNaN(Number.parseFloat(score.raw))) {\n        scoreObject.raw = Number.parseFloat(score.raw);\n      }\n      if (!Number.isNaN(Number.parseFloat(score.min))) {\n        scoreObject.min = Number.parseFloat(score.min);\n      }\n      if (!Number.isNaN(Number.parseFloat(score.max))) {\n        scoreObject.max = Number.parseFloat(score.max);\n      }\n    }\n\n    const commitObject: CommitObject = {\n      successStatus: successStatus,\n      completionStatus: completionStatus,\n      runtimeData: cmiExport,\n      totalTimeSeconds: totalTimeSeconds,\n    };\n    if (scoreObject) {\n      commitObject.score = scoreObject;\n    }\n    return commitObject;\n  }\n\n  /**\n   * Attempts to store the data to the LMS\n   *\n   * @param {boolean} terminateCommit\n   * @return {ResultObject}\n   */\n  async storeData(terminateCommit: boolean): Promise<ResultObject> {\n    if (terminateCommit) {\n      const originalStatus = this.cmi.core.lesson_status;\n      if (\n        !this.cmi.core.lesson_status ||\n        (!this.statusSetByModule &&\n          this.cmi.core.lesson_status === \"not attempted\")\n      ) {\n        this.cmi.core.lesson_status = \"completed\";\n      }\n\n      if (this.cmi.core.lesson_mode === \"normal\") {\n        if (this.cmi.core.credit === \"credit\") {\n          if (\n            this.settings.mastery_override &&\n            this.cmi.student_data.mastery_score !== \"\" &&\n            this.cmi.core.score.raw !== \"\"\n          ) {\n            this.cmi.core.lesson_status =\n              parseFloat(this.cmi.core.score.raw) >=\n              parseFloat(this.cmi.student_data.mastery_score)\n                ? \"passed\"\n                : \"failed\";\n          }\n        }\n      } else if (this.cmi.core.lesson_mode === \"browse\") {\n        if (\n          (this.startingData?.cmi?.core?.lesson_status || \"\") === \"\" &&\n          originalStatus === \"not attempted\"\n        ) {\n          this.cmi.core.lesson_status = \"browsed\";\n        }\n      }\n    }\n\n    const shouldTerminateCommit =\n      terminateCommit || this.settings.alwaysSendTotalTime;\n    const commitObject = this.settings.renderCommonCommitFields\n      ? this.renderCommitObject(shouldTerminateCommit)\n      : this.renderCommitCMI(shouldTerminateCommit);\n\n    if (this.apiLogLevel === APIConstants.global.LOG_LEVEL_DEBUG) {\n      console.debug(\n        \"Commit (terminated: \" + (terminateCommit ? \"yes\" : \"no\") + \"): \",\n      );\n      console.debug(commitObject);\n    }\n    if (typeof this.settings.lmsCommitUrl === \"string\") {\n      return await this.processHttpRequest(\n        this.settings.lmsCommitUrl,\n        commitObject,\n        terminateCommit,\n      );\n    } else {\n      return {\n        result: APIConstants.global.SCORM_TRUE,\n        errorCode: 0,\n      };\n    }\n  }\n}\n","import Scorm12API from \"../Scorm12API.ts\";\n\nwindow.Scorm12API = Scorm12API;\n"],"names":["root","factory","exports","module","define","amd","self","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","_","label","sent","trys","ops","g","Iterator","verb","Symbol","iterator","v","op","pop","push","SuppressedError","jsonString","_initialized","_start_time","initialize","setStartTime","Date","getTime","BaseCMI","global","GENERAL","INITIALIZATION_FAILED","INITIALIZED","TERMINATED","TERMINATION_FAILURE","TERMINATION_BEFORE_INIT","MULTIPLE_TERMINATION","RETRIEVE_BEFORE_INIT","RETRIEVE_AFTER_TERM","STORE_BEFORE_INIT","STORE_AFTER_TERM","COMMIT_BEFORE_INIT","COMMIT_AFTER_TERM","ARGUMENT_ERROR","CHILDREN_ERROR","COUNT_ERROR","GENERAL_GET_FAILURE","GENERAL_SET_FAILURE","GENERAL_COMMIT_FAILURE","UNDEFINED_DATA_MODEL","UNIMPLEMENTED_ELEMENT","VALUE_NOT_INITIALIZED","INVALID_SET_VALUE","READ_ONLY_ELEMENT","WRITE_ONLY_ELEMENT","TYPE_MISMATCH","VALUE_OUT_OF_RANGE","DEPENDENCY_NOT_ESTABLISHED","scorm12","scorm2004","MULTIPLE_TERMINATIONS","cmi_children","core_children","score_children","comments_children","objectives_children","correct_responses_children","student_data_children","student_preference_children","interactions_children","error_descriptions","basicMessage","detailMessage","SCORM_TRUE","SCORM_FALSE","STATE_NOT_INITIALIZED","STATE_INITIALIZED","STATE_TERMINATED","LOG_LEVEL_DEBUG","LOG_LEVEL_INFO","LOG_LEVEL_WARNING","LOG_LEVEL_ERROR","LOG_LEVEL_NONE","aicc","student_demographics_children","tries_children","attempt_records_children","paths_children","scorm12_errors","aicc_errors","scorm2004_errors","errorCode","toString","_errorCode","name","setMessage","message","Error","errorMessage","detailedMessage","_detailedMessage","_errorMessage","BaseScormValidationError","ValidationError","scorm12_error_codes","params","__children","children","_errorClass","errorClass","childArray","_children","_count","toJSON","SECONDS_PER_HOUR","getSecondsAsHHMMSS","totalSeconds","hours","Math","floor","dateObj","minutes","getUTCMinutes","seconds","getSeconds","ms","msStr","countDecimals","toFixed","split","replace","getTimeAsSeconds","timeString","timeRegex","RegExp","match","parts","Number","flatten","data","recurse","cur","prop","isArray","l","isEmpty","num","indexOf","stringMatches","str","tester","DefaultSettings","autocommit","autocommitSeconds","asyncCommit","sendFullCommit","lmsCommitUrl","dataCommitFormat","commitRequestDataType","autoProgress","logLevel","selfReportSessionTime","alwaysSendTotalTime","renderCommonCommitFields","strict_errors","xhrHeaders","xhrWithCredentials","responseHandler","response","JSON","parse","text","httpResult","status","requestHandler","commitObject","onLogMessage","messageLevel","logMessage","console","error","warn","info","debug","log","scoItemIds","scoItemIdValidator","API","when","callback","_cancelled","_API","_timeout","setTimeout","wrapper","bind","_callback","cancel","clearTimeout","commit","error_codes","settings","_settings","BaseAPI","currentState","lastErrorCode","listenerArray","_error_codes","apiLogLevel","commonReset","callbackName","initializeMessage","terminationMessage","returnValue","isInitialized","throwSCORMError","isTerminated","cmi","processListeners","apiLog","clearSCORMError","functionName","CMIElement","messageString","fillChars","j","formatMessage","terminate","checkTerminated","checkState","storeData","getValue","getCMIValue","handleValueAccessException","undefined","setValue","commitCallback","setCMIValue","scheduleCommit","clearScheduledCommit","getLastError","getErrorString","CMIErrorCode","getLmsErrorMessageDetails","getDiagnostic","beforeInitError","afterTermError","isNotInitialized","_errorNumber","_detail","_CMIElement","_value","_commonSetCMIValue","methodName","structure","refObject","foundFirstIndex","invalidErrorMessage","invalidErrorCode","idx","attribute","substring","_checkObjectHasProperty","validateCorrectResponse","CMIArray","index","parseInt","isNaN","item","newChild","getChildElement","initialized","_commonGetCMIValue","uninitializedErrorMessage","_isTargetValid","target","on","listenerName","listenerFunctions","listenerSplit","off","removeIndex","findIndex","obj","splice","clear","filter","listener","functionsMatch","listenerHasCMIElement","CMIElementsMatch","errorNumber","success","loadFromFlattenedJSON","json","int_pattern","obj_pattern","keys","map","key","sort","test","a","c","testPattern","forEach","element","loadFromJSON","regex","m","exec","unflatten","a_pattern","c_match","a_match","a_num","c_num","startingData","currentCMIElement","renderCMIToJSONString","stringify","k","renderCMIToJSONObject","processHttpRequest","url","immediate","api","genericError","performFetch","transformResponse","process","debouncedProcess","func","wait","timeout","context","callNow","args","debounce","ScheduledCommit","getOwnPropertyDescriptor","getPrototypeOf","fetch","method","join","headers","credentials","keepalive","CMIString256","CMIString4096","CMITime","CMITimespan","CMIInteger","CMISInteger","CMIDecimal","CMIIdentifier","CMIFeedback","CMIIndex","CMIStatus","CMIStatus2","CMIExit","CMIType","CMIResult","NAVEvent","score_range","audio_range","speed_range","weighting_range","text_range","CMIString200","CMIString250","CMIString1000","CMIString4000","CMIString64000","CMILang","CMILangString250","CMILangcr","CMILangString250cr","CMILangString4000","CMIShortIdentifier","CMILongIdentifier","CMIIndexStore","CMICStatus","CMISStatus","NAVBoolean","NAVTarget","scaled_range","progress_range","checkValidFormat","regexPattern","allowEmptyString","formatRegex","matches","checkValidRange","rangePattern","ranges","check12ValidFormat","Scorm12ValidationError","check12ValidRange","SuccessStatus","CompletionStatus","scorm12_constants","scorm12_regex","_raw","_min","__score_range","_max","max","__invalid_error_code","__invalid_type_code","invalidTypeCode","__invalid_range_code","invalidRangeCode","__decimal_regex","decimalRegex","__error_class","raw","min","_student_id","_student_name","_lesson_location","_credit","_lesson_status","_entry","_total_time","_lesson_mode","_exit","_session_time","_suspend_data","score","CMIScore","student_id","student_name","lesson_location","credit","lesson_status","entry","total_time","lesson_mode","exit","session_time","suspend_data","getCurrentTotalTime","start_time","first","second","sessionTime","startTime","_id","_status","id","_mastery_score","_max_time_allowed","_time_limit_action","mastery_score","max_time_allowed","time_limit_action","_audio","_language","_speed","_text","audio","language","speed","_time","_type","_weighting","_student_response","_result","_latency","objectives","correct_responses","time","type","weighting","student_response","latency","_pattern","pattern","student_data","__version","_launch_data","_comments","_comments_from_lms","core","CMICore","CMIObjectives","CMIStudentData","student_preference","CMIStudentPreference","interactions","CMIInteractions","launch_data","comments","comments_from_lms","_version","BaseRootCMI","_event","event","mastery_override","statusSetByModule","CMI","nav","NAV","LMSInitialize","lmsInitialize","LMSFinish","lmsFinish","LMSGetValue","lmsGetValue","LMSSetValue","lmsSetValue","LMSCommit","lmsCommit","LMSGetLastError","lmsGetLastError","LMSGetErrorString","lmsGetErrorString","LMSGetDiagnostic","lmsGetDiagnostic","reset","internalFinish","CMIObjectivesObject","CMIInteractionsCorrectResponsesObject","CMIInteractionsObjectivesObject","CMIInteractionsObject","detail","replaceWithAnotherScormAPI","newAPI","renderCommitCMI","terminateCommit","cmiExport","flattened","renderCommitObject","totalTimeSeconds","lessonStatus","completionStatus","unknown","successStatus","completed","incomplete","passed","failed","scoreObject","parseFloat","runtimeData","originalStatus","shouldTerminateCommit","window","Scorm12API"],"sourceRoot":""}