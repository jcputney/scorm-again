this.AICC=function(){"use strict";var __defProp$5=Object.defineProperty,__getOwnPropSymbols$5=Object.getOwnPropertySymbols,__hasOwnProp$5={}.hasOwnProperty,__propIsEnum$5={}.propertyIsEnumerable,__defNormalProp$5=(obj,key,value)=>key in obj?__defProp$5(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues$5=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$5.call(b,prop)&&__defNormalProp$5(a,prop,b[prop]);if(__getOwnPropSymbols$5)for(var prop of __getOwnPropSymbols$5(b))__propIsEnum$5.call(b,prop)&&__defNormalProp$5(a,prop,b[prop]);return a};const scorm12_constants={cmi_children:"core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions",core_children:"student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,exit,session_time",score_children:"raw,min,max",comments_children:"content,location,time",objectives_children:"id,score,status",correct_responses_children:"pattern",student_data_children:"mastery_score,max_time_allowed,time_limit_action",student_preference_children:"audio,language,speed,text",interactions_children:"id,objectives,time,type,correct_responses,weighting,student_response,result,latency",error_descriptions:{101:{basicMessage:"General Exception",detailMessage:"No specific error code exists to describe the error. Use LMSGetDiagnostic for more information"},201:{basicMessage:"Invalid argument error",detailMessage:"Indicates that an argument represents an invalid data model element or is otherwise incorrect."},202:{basicMessage:"Element cannot have children",detailMessage:'Indicates that LMSGetValue was called with a data model element name that ends in "_children" for a data model element that does not support the "_children" suffix.'},203:{basicMessage:"Element not an array - cannot have count",detailMessage:'Indicates that LMSGetValue was called with a data model element name that ends in "_count" for a data model element that does not support the "_count" suffix.'},301:{basicMessage:"Not initialized",detailMessage:"Indicates that an API call was made before the call to lmsInitialize."},401:{basicMessage:"Not implemented error",detailMessage:"The data model element indicated in a call to LMSGetValue or LMSSetValue is valid, but was not implemented by this LMS. SCORM 1.2 defines a set of data model elements as being optional for an LMS to implement."},402:{basicMessage:"Invalid set value, element is a keyword",detailMessage:'Indicates that LMSSetValue was called on a data model element that represents a keyword (elements that end in "_children" and "_count").'},403:{basicMessage:"Element is read only",detailMessage:"LMSSetValue was called with a data model element that can only be read."},404:{basicMessage:"Element is write only",detailMessage:"LMSGetValue was called on a data model element that can only be written to."},405:{basicMessage:"Incorrect Data Type",detailMessage:"LMSSetValue was called with a value that is not consistent with the data format of the supplied data model element."},407:{basicMessage:"Element Value Out Of Range",detailMessage:"The numeric value supplied to a LMSSetValue call is outside of the numeric range allowed for the supplied data model element."},408:{basicMessage:"Data Model Dependency Not Established",detailMessage:"Some data model elements cannot be set until another data model element was set. This error condition indicates that the prerequisite element was not set before the dependent element."}}},aicc_constants=__spreadValues$5(__spreadValues$5({},scorm12_constants),{cmi_children:"core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions,evaluation",student_preference_children:"audio,language,lesson_type,speed,text,text_color,text_location,text_size,video,windows",student_data_children:"attempt_number,tries,mastery_score,max_time_allowed,time_limit_action",student_demographics_children:"city,class,company,country,experience,familiar_name,instructor_name,title,native_language,state,street_address,telephone,years_experience",tries_children:"time,status,score",attempt_records_children:"score,lesson_status",paths_children:"location_id,date,time,status,why_left,time_in_element"});var __defProp$4=Object.defineProperty,__defProps$3=Object.defineProperties,__getOwnPropDescs$3=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$4=Object.getOwnPropertySymbols,__hasOwnProp$4={}.hasOwnProperty,__propIsEnum$4={}.propertyIsEnumerable,__defNormalProp$4=(obj,key,value)=>key in obj?__defProp$4(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues$4=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$4.call(b,prop)&&__defNormalProp$4(a,prop,b[prop]);if(__getOwnPropSymbols$4)for(var prop of __getOwnPropSymbols$4(b))__propIsEnum$4.call(b,prop)&&__defNormalProp$4(a,prop,b[prop]);return a},__spreadProps$3=(a,b)=>__defProps$3(a,__getOwnPropDescs$3(b));const global_errors={GENERAL:101,INITIALIZATION_FAILED:101,INITIALIZED:101,TERMINATED:101,TERMINATION_FAILURE:101,TERMINATION_BEFORE_INIT:101,MULTIPLE_TERMINATION:101,RETRIEVE_BEFORE_INIT:101,RETRIEVE_AFTER_TERM:101,STORE_BEFORE_INIT:101,STORE_AFTER_TERM:101,COMMIT_BEFORE_INIT:101,COMMIT_AFTER_TERM:101,ARGUMENT_ERROR:101,CHILDREN_ERROR:101,COUNT_ERROR:101,GENERAL_GET_FAILURE:101,GENERAL_SET_FAILURE:101,GENERAL_COMMIT_FAILURE:101,UNDEFINED_DATA_MODEL:101,UNIMPLEMENTED_ELEMENT:101,VALUE_NOT_INITIALIZED:101,INVALID_SET_VALUE:101,READ_ONLY_ELEMENT:101,WRITE_ONLY_ELEMENT:101,TYPE_MISMATCH:101,VALUE_OUT_OF_RANGE:101,DEPENDENCY_NOT_ESTABLISHED:101},scorm12_errors$1=__spreadProps$3(__spreadValues$4({},global_errors),{RETRIEVE_BEFORE_INIT:301,STORE_BEFORE_INIT:301,COMMIT_BEFORE_INIT:301,ARGUMENT_ERROR:201,CHILDREN_ERROR:202,COUNT_ERROR:203,UNDEFINED_DATA_MODEL:401,UNIMPLEMENTED_ELEMENT:401,VALUE_NOT_INITIALIZED:301,INVALID_SET_VALUE:402,READ_ONLY_ELEMENT:403,WRITE_ONLY_ELEMENT:404,TYPE_MISMATCH:405,VALUE_OUT_OF_RANGE:407,DEPENDENCY_NOT_ESTABLISHED:408});__spreadProps$3(__spreadValues$4({},global_errors),{INITIALIZATION_FAILED:102,INITIALIZED:103,TERMINATED:104,TERMINATION_FAILURE:111,TERMINATION_BEFORE_INIT:112,MULTIPLE_TERMINATIONS:113,RETRIEVE_BEFORE_INIT:122,RETRIEVE_AFTER_TERM:123,STORE_BEFORE_INIT:132,STORE_AFTER_TERM:133,COMMIT_BEFORE_INIT:142,COMMIT_AFTER_TERM:143,ARGUMENT_ERROR:201,GENERAL_GET_FAILURE:301,GENERAL_SET_FAILURE:351,GENERAL_COMMIT_FAILURE:391,UNDEFINED_DATA_MODEL:401,UNIMPLEMENTED_ELEMENT:402,VALUE_NOT_INITIALIZED:403,READ_ONLY_ELEMENT:404,WRITE_ONLY_ELEMENT:405,TYPE_MISMATCH:406,VALUE_OUT_OF_RANGE:407,DEPENDENCY_NOT_ESTABLISHED:408});var __defProp$3=Object.defineProperty,__getOwnPropSymbols$3=Object.getOwnPropertySymbols,__hasOwnProp$3={}.hasOwnProperty,__propIsEnum$3={}.propertyIsEnumerable,__defNormalProp$3=(obj,key,value)=>key in obj?__defProp$3(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues$3=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$3.call(b,prop)&&__defNormalProp$3(a,prop,b[prop]);if(__getOwnPropSymbols$3)for(var prop of __getOwnPropSymbols$3(b))__propIsEnum$3.call(b,prop)&&__defNormalProp$3(a,prop,b[prop]);return a};const scorm12_regex={CMIString256:"^.{0,255}$",CMIString4096:"^.{0,4096}$",CMITime:"^(?:[01]\\d|2[0123]):(?:[012345]\\d):(?:[012345]\\d)$",CMITimespan:"^([0-9]{2,}):([0-9]{2}):([0-9]{2})(.[0-9]{1,2})?$",CMIInteger:"^\\d+$",CMISInteger:"^-?([0-9]+)$",CMIDecimal:"^-?([0-9]{0,3})(.[0-9]*)?$",CMIIdentifier:"^[\\u0021-\\u007E\\s]{0,255}$",CMIFeedback:"^.{0,255}$",CMIIndex:"[._](\\d+).",CMIStatus:"^(passed|completed|failed|incomplete|browsed)$",CMIStatus2:"^(passed|completed|failed|incomplete|browsed|not attempted)$",CMIExit:"^(time-out|suspend|logout|)$",CMIType:"^(true-false|choice|fill-in|matching|performance|sequencing|likert|numeric)$",CMIResult:"^(correct|wrong|unanticipated|neutral|([0-9]{0,3})?(\\.[0-9]*)?)$",NAVEvent:"^(previous|continue)$",score_range:"0#100",audio_range:"-1#100",speed_range:"-100#100",weighting_range:"-100#100",text_range:"-1#1"},aicc_regex=__spreadValues$3(__spreadValues$3({},scorm12_regex),{CMIIdentifier:"^\\w{1,255}$"});class BaseScormValidationError extends Error{constructor(CMIElement,errorCode){super(`${CMIElement} : ${""+errorCode}`),this._errorCode=errorCode,Object.setPrototypeOf(this,BaseScormValidationError.prototype)}get errorCode(){return this._errorCode}}class ValidationError extends BaseScormValidationError{constructor(CMIElement,errorCode,errorMessage,detailedMessage){super(CMIElement,errorCode),this._detailedMessage="",this.message=`${CMIElement} : ${errorMessage}`,this._errorMessage=errorMessage,detailedMessage&&(this._detailedMessage=detailedMessage),Object.setPrototypeOf(this,ValidationError.prototype)}get errorMessage(){return this._errorMessage}get detailedMessage(){return this._detailedMessage}}const scorm12_errors=scorm12_constants.error_descriptions;class Scorm12ValidationError extends ValidationError{constructor(CMIElement,errorCode){!{}.hasOwnProperty.call(scorm12_errors,errorCode+"")?super(CMIElement,101,scorm12_errors[101].basicMessage,scorm12_errors[101].detailMessage):super(CMIElement,errorCode,scorm12_errors[errorCode+""].basicMessage,scorm12_errors[errorCode+""].detailMessage),Object.setPrototypeOf(this,Scorm12ValidationError.prototype)}}class BaseCMI{constructor(cmi_element){this.jsonString=!1,this._initialized=!1,this._cmi_element=cmi_element}get initialized(){return this._initialized}get start_time(){return this._start_time}initialize(){this._initialized=!0}setStartTime(){this._start_time=(new Date).getTime()}}class BaseRootCMI extends BaseCMI{}const getSecondsAsHHMMSS=memoize((totalSeconds=>{if(!totalSeconds||0>=totalSeconds)return"00:00:00";const hours=Math.floor(totalSeconds/3600),dateObj=new Date(1e3*totalSeconds),minutes=dateObj.getUTCMinutes(),seconds=dateObj.getSeconds(),ms=totalSeconds%1;let msStr="";return countDecimals(ms)>0&&(msStr=countDecimals(ms)>2?ms.toFixed(2):ms+"",msStr="."+msStr.split(".")[1]),(hours+":"+minutes+":"+seconds).replace(/\b\d\b/g,"0$&")+msStr})),getTimeAsSeconds=memoize(((timeString,timeRegex)=>{var _a;if("number"!=typeof timeString&&"boolean"!=typeof timeString||(timeString+=""),"string"==typeof timeRegex&&(timeRegex=RegExp(timeRegex)),!timeString||!(null==(_a=null==timeString?void 0:timeString.match)?void 0:_a.call(timeString,timeRegex)))return 0;const parts=timeString.split(":");return 3600*+parts[0]+60*+parts[1]+ +parts[2]}),((timeString,timeRegex)=>{var _a;return`${"string"==typeof timeString?timeString:(null!=timeString?timeString:"")+""}:${"string"==typeof timeRegex?timeRegex:null!=(_a=null==timeRegex?void 0:""+timeRegex)?_a:""}`}));function flatten(data){const result={};return function recurse(cur,prop){if(Object(cur)!==cur)result[prop]=cur;else if(Array.isArray(cur))cur.forEach(((item,i)=>{recurse(item,`${prop}[${i}]`)})),0===cur.length&&(result[prop]=[]);else{const keys=Object.keys(cur).filter((p=>({}.hasOwnProperty.call(cur,p)))),isEmpty=0===keys.length;keys.forEach((p=>{recurse(cur[p],prop?`${prop}.${p}`:p)})),isEmpty&&prop&&(result[prop]={})}}(data,""),result}function countDecimals(num){var _a,_b,_c,_d;if(Math.floor(num)===num||0>(null==(_b=null==(_a=num+"")?void 0:_a.indexOf)?void 0:_b.call(_a,".")))return 0;const parts=null==(_c=(""+num).split("."))?void 0:_c[1];return null!=(_d=null==parts?void 0:parts.length)?_d:0}function stringMatches(str,tester){return null!==(null==str?void 0:str.match(tester))}function memoize(fn,keyFn){const cache=new Map;return(...args)=>{const key=keyFn?keyFn(...args):JSON.stringify(args);return cache.has(key)?cache.get(key):(()=>{const result=fn(...args);return cache.set(key,result),result})()}}const checkValidFormat=memoize(((CMIElement,value,regexPattern,errorCode,errorClass,allowEmptyString)=>{if("string"!=typeof value)return!1;const formatRegex=RegExp(regexPattern),matches=value.match(formatRegex);if(allowEmptyString&&""===value)return!0;if(void 0===value||!matches||""===matches[0])throw new errorClass(CMIElement,errorCode);return!0}),((CMIElement,value,regexPattern,errorCode,_errorClass,allowEmptyString)=>`${CMIElement}:${"string"==typeof value?value:`[${typeof value}]`}:${regexPattern}:${errorCode}:${allowEmptyString||!1}`)),checkValidRange=memoize(((CMIElement,value,rangePattern,errorCode,errorClass)=>{const ranges=rangePattern.split("#");if(ranges[0]>(value*=1))throw new errorClass(CMIElement,errorCode);if("*"!==ranges[1]&&value>ranges[1])throw new errorClass(CMIElement,errorCode);return!0}),((CMIElement,value,rangePattern,errorCode,_errorClass)=>`${CMIElement}:${value}:${rangePattern}:${errorCode}`));function check12ValidFormat(CMIElement,value,regexPattern,allowEmptyString){return checkValidFormat(CMIElement,value,regexPattern,scorm12_errors$1.TYPE_MISMATCH,Scorm12ValidationError,allowEmptyString)}function check12ValidRange(CMIElement,value,rangePattern,allowEmptyString){if(""===value)throw new Scorm12ValidationError(CMIElement,scorm12_errors$1.VALUE_OUT_OF_RANGE);return checkValidRange(CMIElement,value,rangePattern,scorm12_errors$1.VALUE_OUT_OF_RANGE,Scorm12ValidationError)}const validationService=new class{validateScore(CMIElement,value,decimalRegex,scoreRange,invalidTypeCode,invalidRangeCode,errorClass){return checkValidFormat(CMIElement,value,decimalRegex,invalidTypeCode,errorClass)&&(!scoreRange||checkValidRange(CMIElement,value,scoreRange,invalidRangeCode,errorClass))}validateScorm12Audio(CMIElement,value){return check12ValidFormat(CMIElement,value,scorm12_regex.CMISInteger)&&check12ValidRange(CMIElement,value,scorm12_regex.audio_range)}validateScorm12Language(CMIElement,value){return check12ValidFormat(CMIElement,value,scorm12_regex.CMIString256)}validateScorm12Speed(CMIElement,value){return check12ValidFormat(CMIElement,value,scorm12_regex.CMISInteger)&&check12ValidRange(CMIElement,value,scorm12_regex.speed_range)}validateScorm12Text(CMIElement,value){return check12ValidFormat(CMIElement,value,scorm12_regex.CMISInteger)&&check12ValidRange(CMIElement,value,scorm12_regex.text_range)}validateReadOnly(CMIElement,initialized){if(initialized)throw new Scorm12ValidationError(CMIElement,scorm12_errors$1.READ_ONLY_ELEMENT)}};class CMIScore extends BaseCMI{constructor(params){super(params.CMIElement),this._raw="",this._min="",this.__children=params.score_children||scorm12_constants.score_children,this.__score_range=!!params.score_range&&scorm12_regex.score_range,this._max=params.max||""===params.max?params.max:"100",this.__invalid_error_code=params.invalidErrorCode||scorm12_errors$1.INVALID_SET_VALUE,this.__invalid_type_code=params.invalidTypeCode||scorm12_errors$1.TYPE_MISMATCH,this.__invalid_range_code=params.invalidRangeCode||scorm12_errors$1.VALUE_OUT_OF_RANGE,this.__decimal_regex=params.decimalRegex||scorm12_regex.CMIDecimal,this.__error_class=params.errorClass}reset(){this._initialized=!1}get _children(){return this.__children}set _children(_children){throw new this.__error_class(this._cmi_element+"._children",this.__invalid_error_code)}get raw(){return this._raw}set raw(raw){validationService.validateScore(this._cmi_element+".raw",raw,this.__decimal_regex,this.__score_range,this.__invalid_type_code,this.__invalid_range_code,this.__error_class)&&(this._raw=raw)}get min(){return this._min}set min(min){validationService.validateScore(this._cmi_element+".min",min,this.__decimal_regex,this.__score_range,this.__invalid_type_code,this.__invalid_range_code,this.__error_class)&&(this._min=min)}get max(){return this._max}set max(max){validationService.validateScore(this._cmi_element+".max",max,this.__decimal_regex,this.__score_range,this.__invalid_type_code,this.__invalid_range_code,this.__error_class)&&(this._max=max)}toJSON(){this.jsonString=!0;const result={raw:this.raw,min:this.min,max:this.max};return delete this.jsonString,result}}class CMICore extends BaseCMI{constructor(){super("cmi.core"),this.__children=scorm12_constants.core_children,this._student_id="",this._student_name="",this._lesson_location="",this._credit="",this._lesson_status="not attempted",this._entry="",this._total_time="",this._lesson_mode="normal",this._exit="",this._session_time="00:00:00",this._suspend_data="",this.score=new CMIScore({CMIElement:"cmi.core.score",score_children:scorm12_constants.score_children,score_range:scorm12_regex.score_range,invalidErrorCode:scorm12_errors$1.INVALID_SET_VALUE,invalidTypeCode:scorm12_errors$1.TYPE_MISMATCH,invalidRangeCode:scorm12_errors$1.VALUE_OUT_OF_RANGE,errorClass:Scorm12ValidationError})}initialize(){var _a;super.initialize(),null==(_a=this.score)||_a.initialize()}reset(){var _a;this._initialized=!1,this._exit="",this._entry="",this._session_time="00:00:00",null==(_a=this.score)||_a.reset()}get _children(){return this.__children}set _children(_children){throw new Scorm12ValidationError(this._cmi_element+"._children",scorm12_errors$1.INVALID_SET_VALUE)}get student_id(){return this._student_id}set student_id(student_id){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".student_id",scorm12_errors$1.READ_ONLY_ELEMENT);this._student_id=student_id}get student_name(){return this._student_name}set student_name(student_name){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".student_name",scorm12_errors$1.READ_ONLY_ELEMENT);this._student_name=student_name}get lesson_location(){return this._lesson_location}set lesson_location(lesson_location){check12ValidFormat(this._cmi_element+".lesson_location",lesson_location,scorm12_regex.CMIString256,!0)&&(this._lesson_location=lesson_location)}get credit(){return this._credit}set credit(credit){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".credit",scorm12_errors$1.READ_ONLY_ELEMENT);this._credit=credit}get lesson_status(){return this._lesson_status}set lesson_status(lesson_status){this.initialized?check12ValidFormat(this._cmi_element+".lesson_status",lesson_status,scorm12_regex.CMIStatus)&&(this._lesson_status=lesson_status):check12ValidFormat(this._cmi_element+".lesson_status",lesson_status,scorm12_regex.CMIStatus2)&&(this._lesson_status=lesson_status)}get entry(){return this._entry}set entry(entry){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".entry",scorm12_errors$1.READ_ONLY_ELEMENT);this._entry=entry}get total_time(){return this._total_time}set total_time(total_time){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".total_time",scorm12_errors$1.READ_ONLY_ELEMENT);this._total_time=total_time}get lesson_mode(){return this._lesson_mode}set lesson_mode(lesson_mode){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".lesson_mode",scorm12_errors$1.READ_ONLY_ELEMENT);this._lesson_mode=lesson_mode}get exit(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".exit",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._exit}set exit(exit){check12ValidFormat(this._cmi_element+".exit",exit,scorm12_regex.CMIExit,!0)&&(this._exit=exit)}get session_time(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".session_time",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._session_time}set session_time(session_time){check12ValidFormat(this._cmi_element+".session_time",session_time,scorm12_regex.CMITimespan)&&(this._session_time=session_time)}get suspend_data(){return this._suspend_data}set suspend_data(suspend_data){check12ValidFormat(this._cmi_element+".suspend_data",suspend_data,scorm12_regex.CMIString4096,!0)&&(this._suspend_data=suspend_data)}getCurrentTotalTime(start_time){let sessionTime=this._session_time;const startTime=start_time;if(null!=startTime){const seconds=(new Date).getTime()-startTime;sessionTime=getSecondsAsHHMMSS(seconds/1e3)}return first=this._total_time,second=sessionTime,"string"==typeof(timeRegex=RegExp(scorm12_regex.CMITimespan))&&(timeRegex=RegExp(timeRegex)),getSecondsAsHHMMSS(getTimeAsSeconds(first,timeRegex)+getTimeAsSeconds(second,timeRegex));var first,second,timeRegex}toJSON(){this.jsonString=!0;const result={student_id:this.student_id,student_name:this.student_name,lesson_location:this.lesson_location,credit:this.credit,lesson_status:this.lesson_status,entry:this.entry,lesson_mode:this.lesson_mode,exit:this.exit,session_time:this.session_time,score:this.score};return delete this.jsonString,result}}class CMIArray extends BaseCMI{constructor(params){super(params.CMIElement),this.__children=params.children,this._errorCode=params.errorCode||scorm12_errors$1.GENERAL,this._errorClass=params.errorClass||BaseScormValidationError,this.childArray=[]}reset(wipe=!1){if(this._initialized=!1,wipe)this.childArray=[];else for(let i=0;this.childArray.length>i;i++)this.childArray[i].reset()}get _children(){return this.__children}set _children(_children){throw new this._errorClass(this._cmi_element+"._children",this._errorCode)}get _count(){return this.childArray.length}set _count(_count){throw new this._errorClass(this._cmi_element+"._count",this._errorCode)}toJSON(){this.jsonString=!0;const result={};for(let i=0;this.childArray.length>i;i++)result[i+""]=this.childArray[i];return delete this.jsonString,result}}class CMIObjectives extends CMIArray{constructor(){super({CMIElement:"cmi.objectives",children:scorm12_constants.objectives_children,errorCode:scorm12_errors$1.INVALID_SET_VALUE,errorClass:Scorm12ValidationError})}}class CMIObjectivesObject extends BaseCMI{constructor(){super("cmi.objectives.n"),this._id="",this._status="",this.score=new CMIScore({CMIElement:"cmi.objectives.n.score",score_children:scorm12_constants.score_children,score_range:scorm12_regex.score_range,invalidErrorCode:scorm12_errors$1.INVALID_SET_VALUE,invalidTypeCode:scorm12_errors$1.TYPE_MISMATCH,invalidRangeCode:scorm12_errors$1.VALUE_OUT_OF_RANGE,errorClass:Scorm12ValidationError})}reset(){var _a;this._initialized=!1,this._id="",this._status="",null==(_a=this.score)||_a.reset()}get id(){return this._id}set id(id){check12ValidFormat(this._cmi_element+".id",id,scorm12_regex.CMIIdentifier)&&(this._id=id)}get status(){return this._status}set status(status){check12ValidFormat(this._cmi_element+".status",status,scorm12_regex.CMIStatus2)&&(this._status=status)}toJSON(){this.jsonString=!0;const result={id:this.id,status:this.status,score:this.score};return delete this.jsonString,result}}class CMIStudentData extends BaseCMI{constructor(student_data_children){super("cmi.student_data"),this._mastery_score="",this._max_time_allowed="",this._time_limit_action="",this.__children=student_data_children||scorm12_constants.student_data_children}reset(){this._initialized=!1}get _children(){return this.__children}set _children(_children){throw new Scorm12ValidationError(this._cmi_element+"._children",scorm12_errors$1.INVALID_SET_VALUE)}get mastery_score(){return this._mastery_score}set mastery_score(mastery_score){validationService.validateReadOnly(this._cmi_element+".mastery_score",this.initialized),this._mastery_score=mastery_score}get max_time_allowed(){return this._max_time_allowed}set max_time_allowed(max_time_allowed){validationService.validateReadOnly(this._cmi_element+".max_time_allowed",this.initialized),this._max_time_allowed=max_time_allowed}get time_limit_action(){return this._time_limit_action}set time_limit_action(time_limit_action){validationService.validateReadOnly(this._cmi_element+".time_limit_action",this.initialized),this._time_limit_action=time_limit_action}toJSON(){this.jsonString=!0;const result={mastery_score:this.mastery_score,max_time_allowed:this.max_time_allowed,time_limit_action:this.time_limit_action};return delete this.jsonString,result}}class CMIStudentPreference extends BaseCMI{constructor(student_preference_children){super("cmi.student_preference"),this._audio="",this._language="",this._speed="",this._text="",this.__children=student_preference_children||scorm12_constants.student_preference_children}reset(){this._initialized=!1}get _children(){return this.__children}set _children(_children){throw new Scorm12ValidationError(this._cmi_element+"._children",scorm12_errors$1.INVALID_SET_VALUE)}get audio(){return this._audio}set audio(audio){validationService.validateScorm12Audio(this._cmi_element+".audio",audio)&&(this._audio=audio)}get language(){return this._language}set language(language){validationService.validateScorm12Language(this._cmi_element+".language",language)&&(this._language=language)}get speed(){return this._speed}set speed(speed){validationService.validateScorm12Speed(this._cmi_element+".speed",speed)&&(this._speed=speed)}get text(){return this._text}set text(text){validationService.validateScorm12Text(this._cmi_element+".text",text)&&(this._text=text)}toJSON(){this.jsonString=!0;const result={audio:this.audio,language:this.language,speed:this.speed,text:this.text};return delete this.jsonString,result}}class CMIInteractions extends CMIArray{constructor(){super({CMIElement:"cmi.interactions",children:scorm12_constants.interactions_children,errorCode:scorm12_errors$1.INVALID_SET_VALUE,errorClass:Scorm12ValidationError})}}class CMIInteractionsObject extends BaseCMI{constructor(){super("cmi.interactions.n"),this._id="",this._time="",this._type="",this._weighting="",this._student_response="",this._result="",this._latency="",this.objectives=new CMIArray({CMIElement:"cmi.interactions.n.objectives",errorCode:scorm12_errors$1.INVALID_SET_VALUE,errorClass:Scorm12ValidationError,children:scorm12_constants.objectives_children}),this.correct_responses=new CMIArray({CMIElement:"cmi.interactions.correct_responses",errorCode:scorm12_errors$1.INVALID_SET_VALUE,errorClass:Scorm12ValidationError,children:scorm12_constants.correct_responses_children})}initialize(){var _a,_b;super.initialize(),null==(_a=this.objectives)||_a.initialize(),null==(_b=this.correct_responses)||_b.initialize()}reset(){var _a,_b;this._initialized=!1,this._id="",this._time="",this._type="",this._weighting="",this._student_response="",this._result="",this._latency="",null==(_a=this.objectives)||_a.reset(),null==(_b=this.correct_responses)||_b.reset()}get id(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".id",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._id}set id(id){check12ValidFormat(this._cmi_element+".id",id,scorm12_regex.CMIIdentifier)&&(this._id=id)}get time(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".time",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._time}set time(time){check12ValidFormat(this._cmi_element+".time",time,scorm12_regex.CMITime)&&(this._time=time)}get type(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".type",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._type}set type(type){check12ValidFormat(this._cmi_element+".type",type,scorm12_regex.CMIType)&&(this._type=type)}get weighting(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".weighting",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._weighting}set weighting(weighting){check12ValidFormat(this._cmi_element+".weighting",weighting,scorm12_regex.CMIDecimal)&&check12ValidRange(this._cmi_element+".weighting",weighting,scorm12_regex.weighting_range)&&(this._weighting=weighting)}get student_response(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".student_response",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._student_response}set student_response(student_response){check12ValidFormat(this._cmi_element+".student_response",student_response,scorm12_regex.CMIFeedback,!0)&&(this._student_response=student_response)}get result(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".result",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._result}set result(result){check12ValidFormat(this._cmi_element+".result",result,scorm12_regex.CMIResult)&&(this._result=result)}get latency(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".latency",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._latency}set latency(latency){check12ValidFormat(this._cmi_element+".latency",latency,scorm12_regex.CMITimespan)&&(this._latency=latency)}toJSON(){this.jsonString=!0;const result={id:this.id,time:this.time,type:this.type,weighting:this.weighting,student_response:this.student_response,result:this.result,latency:this.latency,objectives:this.objectives,correct_responses:this.correct_responses};return delete this.jsonString,result}}class CMIInteractionsObjectivesObject extends BaseCMI{constructor(){super("cmi.interactions.n.objectives.n"),this._id=""}reset(){this._initialized=!1,this._id=""}get id(){return this._id}set id(id){check12ValidFormat(this._cmi_element+".id",id,scorm12_regex.CMIIdentifier)&&(this._id=id)}toJSON(){this.jsonString=!0;const result={id:this.id};return delete this.jsonString,result}}class CMIInteractionsCorrectResponsesObject extends BaseCMI{constructor(){super("cmi.interactions.correct_responses.n"),this._pattern=""}reset(){this._initialized=!1,this._pattern=""}get pattern(){if(!this.jsonString)throw new Scorm12ValidationError(this._cmi_element+".pattern",scorm12_errors$1.WRITE_ONLY_ELEMENT);return this._pattern}set pattern(pattern){check12ValidFormat(this._cmi_element+".pattern",pattern,scorm12_regex.CMIFeedback,!0)&&(this._pattern=pattern)}toJSON(){this.jsonString=!0;const result={pattern:this._pattern};return delete this.jsonString,result}}let CMI$1=class extends BaseRootCMI{constructor(cmi_children,student_data,initialized){super("cmi"),this.__children="",this.__version="3.4",this._launch_data="",this._comments="",this._comments_from_lms="",initialized&&this.initialize(),this.__children=cmi_children||scorm12_constants.cmi_children,this.core=new CMICore,this.objectives=new CMIObjectives,this.student_data=student_data||new CMIStudentData,this.student_preference=new CMIStudentPreference,this.interactions=new CMIInteractions}reset(){var _a,_b,_c;this._initialized=!1,this._launch_data="",this._comments="",null==(_a=this.core)||_a.reset(),this.objectives=new CMIObjectives,this.interactions=new CMIInteractions,null==(_b=this.student_data)||_b.reset(),null==(_c=this.student_preference)||_c.reset()}initialize(){var _a,_b,_c,_d,_e;super.initialize(),null==(_a=this.core)||_a.initialize(),null==(_b=this.objectives)||_b.initialize(),null==(_c=this.student_data)||_c.initialize(),null==(_d=this.student_preference)||_d.initialize(),null==(_e=this.interactions)||_e.initialize()}toJSON(){this.jsonString=!0;const result={suspend_data:this.suspend_data,launch_data:this.launch_data,comments:this.comments,comments_from_lms:this.comments_from_lms,core:this.core,objectives:this.objectives,student_data:this.student_data,student_preference:this.student_preference,interactions:this.interactions};return delete this.jsonString,result}get _version(){return this.__version}set _version(_version){throw new Scorm12ValidationError(this._cmi_element+"._version",scorm12_errors$1.INVALID_SET_VALUE)}get _children(){return this.__children}set _children(_children){throw new Scorm12ValidationError(this._cmi_element+"._children",scorm12_errors$1.INVALID_SET_VALUE)}get suspend_data(){var _a;return null==(_a=this.core)?void 0:_a.suspend_data}set suspend_data(suspend_data){this.core&&(this.core.suspend_data=suspend_data)}get launch_data(){return this._launch_data}set launch_data(launch_data){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".launch_data",scorm12_errors$1.READ_ONLY_ELEMENT);this._launch_data=launch_data}get comments(){return this._comments}set comments(comments){check12ValidFormat(this._cmi_element+".comments",comments,scorm12_regex.CMIString4096,!0)&&(this._comments=comments)}get comments_from_lms(){return this._comments_from_lms}set comments_from_lms(comments_from_lms){if(this.initialized)throw new Scorm12ValidationError(this._cmi_element+".comments_from_lms",scorm12_errors$1.READ_ONLY_ELEMENT);this._comments_from_lms=comments_from_lms}getCurrentTotalTime(){return this.core.getCurrentTotalTime(this.start_time)}};class NAV extends BaseCMI{constructor(){super("cmi.nav"),this._event=""}reset(){this._event="",this._initialized=!1}get event(){return this._event}set event(event){(""===event||check12ValidFormat(this._cmi_element+".event",event,scorm12_regex.NAVEvent))&&(this._event=event)}toJSON(){this.jsonString=!0;const result={event:this.event};return delete this.jsonString,result}}const LogLevelEnum={_:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5},DefaultSettings={autocommit:!1,autocommitSeconds:10,asyncCommit:!1,sendFullCommit:!0,lmsCommitUrl:!1,dataCommitFormat:"json",commitRequestDataType:"application/json;charset=UTF-8",autoProgress:!1,logLevel:LogLevelEnum.ERROR,selfReportSessionTime:!1,alwaysSendTotalTime:!1,renderCommonCommitFields:!1,strict_errors:!0,xhrHeaders:{},xhrWithCredentials:!1,fetchMode:"cors",responseHandler:function(response){return __this=this,generator=function*(){if(void 0!==response){let httpResult=null;try{if("function"==typeof response.json)httpResult=yield response.json();else if("function"==typeof response.text){const responseText=yield response.text();responseText&&(httpResult=JSON.parse(responseText))}}catch(e){}return null!==httpResult&&{}.hasOwnProperty.call(httpResult,"result")?{result:httpResult.result,errorCode:httpResult.errorCode?httpResult.errorCode:"true"===httpResult.result?0:101}:200===response.status?{result:"true",errorCode:0}:{result:"false",errorCode:101}}return{result:"false",errorCode:101}},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,null)).next())}));var __this,generator},requestHandler:function(commitObject){return commitObject},onLogMessage:defaultLogHandler,scoItemIds:[],scoItemIdValidator:!1,globalObjectiveIds:[],enableOfflineSupport:!1,courseId:"",syncOnInitialize:!0,syncOnTerminate:!0,maxSyncAttempts:5};function defaultLogHandler(messageLevel,logMessage){switch(messageLevel){case"4":case 4:case"ERROR":case LogLevelEnum.ERROR:console.error(logMessage);break;case"3":case 3:case"WARN":case LogLevelEnum.WARN:console.warn(logMessage);break;case"2":case 2:case"INFO":case LogLevelEnum.INFO:console.info(logMessage);break;case"1":case 1:case"DEBUG":case LogLevelEnum.DEBUG:console.debug?console.debug(logMessage):console.log(logMessage)}}class ScheduledCommit{constructor(API,when,callback){this._cancelled=!1,this._API=API,this._timeout=setTimeout(this.wrapper.bind(this),when),this._callback=callback}cancel(){this._cancelled=!0,this._timeout&&clearTimeout(this._timeout)}wrapper(){this._cancelled||(()=>{return __this=this,generator=function*(){return yield this._API.commit(this._callback)},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,null)).next())}));var __this,generator})()}}var __defProp$2=Object.defineProperty,__defProps$2=Object.defineProperties,__getOwnPropDescs$2=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$2=Object.getOwnPropertySymbols,__hasOwnProp$2={}.hasOwnProperty,__propIsEnum$2={}.propertyIsEnumerable,__defNormalProp$2=(obj,key,value)=>key in obj?__defProp$2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues$2=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$2.call(b,prop)&&__defNormalProp$2(a,prop,b[prop]);if(__getOwnPropSymbols$2)for(var prop of __getOwnPropSymbols$2(b))__propIsEnum$2.call(b,prop)&&__defNormalProp$2(a,prop,b[prop]);return a},__async$3=(__this,__arguments,generator)=>new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));class HttpService{constructor(settings,error_codes){this.settings=settings,this.error_codes=error_codes}processHttpRequest(url,params,immediate=!1,apiLog,processListeners){return __async$3(this,null,(function*(){const genericError={result:"false",errorCode:this.error_codes.GENERAL};return immediate?(this.performFetch(url,params).then((response=>__async$3(this,null,(function*(){yield this.transformResponse(response,processListeners)})))),{result:"true",errorCode:0}):yield((url2,params2,settings)=>__async$3(this,null,(function*(){try{params2=settings.requestHandler(params2);const response=yield this.performFetch(url2,params2);return this.transformResponse(response,processListeners)}catch(e){return apiLog("processHttpRequest",e,LogLevelEnum.ERROR),processListeners("CommitError"),genericError}})))(url,params,this.settings)}))}performFetch(url,params){return __async$3(this,null,(function*(){return fetch(url,{method:"POST",mode:this.settings.fetchMode,body:params instanceof Array?params.join("&"):JSON.stringify(params),headers:(a=__spreadValues$2({},this.settings.xhrHeaders),b={"Content-Type":this.settings.commitRequestDataType},__defProps$2(a,__getOwnPropDescs$2(b))),credentials:this.settings.xhrWithCredentials?"include":void 0,keepalive:!0});var a,b}))}transformResponse(response,processListeners){return __async$3(this,null,(function*(){const result="function"==typeof this.settings.responseHandler?yield this.settings.responseHandler(response):yield response.json();return 200>response.status||response.status>299||!0!==result.result&&"true"!==result.result?(Object.hasOwnProperty.call(result,"errorCode")||(result.errorCode=this.error_codes.GENERAL),processListeners("CommitError",null,result.errorCode)):(processListeners("CommitSuccess"),Object.hasOwnProperty.call(result,"errorCode")||(result.errorCode=0)),result}))}updateSettings(settings){this.settings=settings}}class EventService{constructor(apiLog){this.listenerMap=new Map,this.listenerCount=0,this.apiLog=apiLog}parseListenerName(listenerName){const listenerSplit=listenerName.split(".");if(0===listenerSplit.length)return null;const functionName=listenerSplit[0];let CMIElement=null;return listenerSplit.length>1&&(CMIElement=listenerName.replace(functionName+".","")),{functionName:functionName,CMIElement:CMIElement}}on(listenerName,callback){var _a;if(!callback)return;const listenerFunctions=listenerName.split(" ");for(const listenerFunction of listenerFunctions){const parsedListener=this.parseListenerName(listenerFunction);if(!parsedListener)continue;const{functionName:functionName,CMIElement:CMIElement}=parsedListener,listeners=null!=(_a=this.listenerMap.get(functionName))?_a:[];listeners.push({functionName:functionName,CMIElement:CMIElement,callback:callback}),this.listenerMap.set(functionName,listeners),this.listenerCount++,this.apiLog("on","Added event listener: "+this.listenerCount,LogLevelEnum.INFO,functionName)}}off(listenerName,callback){if(!callback)return;const listenerFunctions=listenerName.split(" ");for(const listenerFunction of listenerFunctions){const parsedListener=this.parseListenerName(listenerFunction);if(!parsedListener)continue;const{functionName:functionName,CMIElement:CMIElement}=parsedListener,listeners=this.listenerMap.get(functionName);if(!listeners)continue;const removeIndex=listeners.findIndex((obj=>obj.CMIElement===CMIElement&&obj.callback===callback));-1!==removeIndex&&(listeners.splice(removeIndex,1),this.listenerCount--,0===listeners.length?this.listenerMap.delete(functionName):this.listenerMap.set(functionName,listeners),this.apiLog("off","Removed event listener: "+this.listenerCount,LogLevelEnum.INFO,functionName))}}clear(listenerName){const listenerFunctions=listenerName.split(" ");for(const listenerFunction of listenerFunctions){const parsedListener=this.parseListenerName(listenerFunction);if(!parsedListener)continue;const{functionName:functionName,CMIElement:CMIElement}=parsedListener;if(this.listenerMap.has(functionName)){const listeners=this.listenerMap.get(functionName),newListeners=listeners.filter((obj=>obj.CMIElement!==CMIElement));this.listenerCount-=listeners.length-newListeners.length,0===newListeners.length?this.listenerMap.delete(functionName):this.listenerMap.set(functionName,newListeners)}}}processListeners(functionName,CMIElement,value){this.apiLog(functionName,value,LogLevelEnum.INFO,CMIElement);const listeners=this.listenerMap.get(functionName);if(listeners)for(const listener of listeners){const listenerHasCMIElement=!!listener.CMIElement;let CMIElementsMatch=!1;if(CMIElement&&listener.CMIElement)if(listener.CMIElement.endsWith("*")){const prefix=listener.CMIElement.slice(0,-1);CMIElementsMatch=CMIElement.startsWith(prefix)}else CMIElementsMatch=listener.CMIElement===CMIElement;listenerHasCMIElement&&!CMIElementsMatch||(this.apiLog("processListeners","Processing listener: "+listener.functionName,LogLevelEnum.DEBUG,CMIElement),functionName.startsWith("Sequence")||"CommitError"===functionName?listener.callback(value):"CommitSuccess"===functionName?listener.callback():listener.callback(CMIElement,value))}}reset(){this.listenerMap.clear(),this.listenerCount=0}}class SerializationService{loadFromFlattenedJSON(json,CMIElement="",setCMIValue,isNotInitialized,setStartingData){if(!isNotInitialized())return void console.error("loadFromFlattenedJSON can only be called before the call to lmsInitialize.");const int_pattern=/^(cmi\.interactions\.)(\d+)\.(.*)$/,obj_pattern=/^(cmi\.objectives\.)(\d+)\.(.*)$/,interactions=[],objectives=[],others=[];for(const key in json)if({}.hasOwnProperty.call(json,key)){const intMatch=key.match(int_pattern);if(intMatch){interactions.push({key:key,value:json[key],index:+intMatch[2],field:intMatch[3]});continue}const objMatch=key.match(obj_pattern);if(objMatch){objectives.push({key:key,value:json[key],index:+objMatch[2],field:objMatch[3]});continue}others.push({key:key,value:json[key]})}interactions.sort(((a,b)=>a.index!==b.index?a.index-b.index:"id"===a.field?-1:"id"===b.field?1:"type"===a.field?-1:"type"===b.field?1:a.field.localeCompare(b.field))),objectives.sort(((a,b)=>a.index!==b.index?a.index-b.index:"id"===a.field?-1:"id"===b.field?1:a.field.localeCompare(b.field))),others.sort(((a,b)=>a.key.localeCompare(b.key)));const processItems=items=>{items.forEach((item=>{const obj={};obj[item.key]=item.value,this.loadFromJSON(function(data){var _a;if(Object(data)!==data||Array.isArray(data))return data;const result={},pattern=/\.?([^.[\]]+)|\[(\d+)]/g;return Object.keys(data).filter((p=>({}.hasOwnProperty.call(data,p)))).forEach((p=>{var _a2,_b;let cur=result,prop="";const regex=RegExp(pattern);Array.from({length:null!=(_b=null==(_a2=p.match(RegExp(pattern,"g")))?void 0:_a2.length)?_b:0},(()=>regex.exec(p))).forEach((m=>{var _a3;m&&(cur=null!=(_a3=cur[prop])?_a3:cur[prop]=m[2]?[]:{},prop=m[2]||m[1])})),cur[prop]=data[p]})),null!=(_a=result[""])?_a:result}(obj),CMIElement,setCMIValue,isNotInitialized,setStartingData)}))};processItems(interactions),processItems(objectives),processItems(others)}loadFromJSON(json,CMIElement="",setCMIValue,isNotInitialized,setStartingData){if(isNotInitialized()){CMIElement=void 0!==CMIElement?CMIElement:"cmi",setStartingData(json);for(const key in json)if({}.hasOwnProperty.call(json,key)&&json[key]){const currentCMIElement=(CMIElement?CMIElement+".":"")+key,value=json[key];if(value.constructor===Array){for(let i=0;value.length>i;i++)if(value[i]){const item=value[i],tempCMIElement=`${currentCMIElement}.${i}`;item.constructor===Object?this.loadFromJSON(item,tempCMIElement,setCMIValue,isNotInitialized,setStartingData):setCMIValue(tempCMIElement,item)}}else value.constructor===Object?this.loadFromJSON(value,currentCMIElement,setCMIValue,isNotInitialized,setStartingData):setCMIValue(currentCMIElement,value)}}else console.error("loadFromJSON can only be called before the call to lmsInitialize.")}renderCMIToJSONString(cmi,sendFullCommit){return sendFullCommit?JSON.stringify({cmi:cmi}):JSON.stringify({cmi:cmi},((k,v)=>void 0===v?null:v),2)}renderCMIToJSONObject(cmi,sendFullCommit){return JSON.parse(this.renderCMIToJSONString(cmi,sendFullCommit))}getCommitObject(terminateCommit,alwaysSendTotalTime,renderCommonCommitFields,renderCommitObject,renderCommitCMI,apiLogLevel){const shouldTerminateCommit=terminateCommit||alwaysSendTotalTime,commitObject=renderCommonCommitFields?renderCommitObject(shouldTerminateCommit):renderCommitCMI(shouldTerminateCommit);return[LogLevelEnum.DEBUG,"1",1,"DEBUG"].includes(apiLogLevel)&&(console.debug("Commit (terminated: "+(terminateCommit?"yes":"no")+"): "),console.debug(commitObject)),commitObject}}class LoggingService{constructor(){this._logLevel=LogLevelEnum.ERROR,this._logHandler=defaultLogHandler}static getInstance(){return LoggingService._instance||(LoggingService._instance=new LoggingService),LoggingService._instance}setLogLevel(level){this._logLevel=level}getLogLevel(){return this._logLevel}setLogHandler(handler){this._logHandler=handler}log(messageLevel,logMessage){this.shouldLog(messageLevel)&&this._logHandler(messageLevel,logMessage)}error(logMessage){this.log(LogLevelEnum.ERROR,logMessage)}warn(logMessage){this.log(LogLevelEnum.WARN,logMessage)}info(logMessage){this.log(LogLevelEnum.INFO,logMessage)}debug(logMessage){this.log(LogLevelEnum.DEBUG,logMessage)}shouldLog(messageLevel){return this.getNumericLevel(messageLevel)>=this.getNumericLevel(this._logLevel)}getNumericLevel(level){if(void 0===level)return LogLevelEnum.NONE;if("number"==typeof level)return level;switch(level){case"1":case"DEBUG":return LogLevelEnum.DEBUG;case"2":case"INFO":return LogLevelEnum.INFO;case"3":case"WARN":return LogLevelEnum.WARN;case"4":case"ERROR":default:return LogLevelEnum.ERROR;case"5":case"NONE":return LogLevelEnum.NONE}}}function getLoggingService(){return LoggingService.getInstance()}class ErrorHandlingService{constructor(errorCodes,apiLog,getLmsErrorMessageDetails,loggingService){this._lastErrorCode="0",this._errorCodes=errorCodes,this._apiLog=apiLog,this._getLmsErrorMessageDetails=getLmsErrorMessageDetails,this._loggingService=loggingService||getLoggingService()}get lastErrorCode(){return this._lastErrorCode}set lastErrorCode(errorCode){this._lastErrorCode=errorCode}throwSCORMError(CMIElement,errorNumber,message){message||(message=this._getLmsErrorMessageDetails(errorNumber,!0));const formattedMessage=`SCORM Error ${errorNumber}: ${message}${CMIElement?` [Element: ${CMIElement}]`:""}`;this._apiLog("throwSCORMError",errorNumber+": "+message,LogLevelEnum.ERROR,CMIElement),this._loggingService.error(formattedMessage),this._lastErrorCode=errorNumber+""}clearSCORMError(success){void 0!==success&&"false"!==success&&(this._lastErrorCode="0")}handleValueAccessException(CMIElement,e,returnValue){if(e instanceof ValidationError){const validationError=e;this._lastErrorCode=validationError.errorCode+"",this._loggingService.warn(`Validation Error ${validationError.errorCode}: ${validationError.message} [Element: ${CMIElement}]`),returnValue="false"}else if(e instanceof Error){const errorType=e.constructor.name;this._loggingService.error(`${errorType}: ${e.message} [Element: ${CMIElement}]\n${e.stack||""}`),this.throwSCORMError(CMIElement,this._errorCodes.GENERAL,`${errorType}: ${e.message}`)}else{this._loggingService.error(`Unknown error occurred while accessing [Element: ${CMIElement}]`);try{const errorDetails=JSON.stringify(e);this._loggingService.error("Error details: "+errorDetails)}catch(jsonError){this._loggingService.error("Could not stringify error object for details")}this.throwSCORMError(CMIElement,this._errorCodes.GENERAL,"Unknown error")}return returnValue}get errorCodes(){return this._errorCodes}}var __defProp$1=Object.defineProperty,__defProps$1=Object.defineProperties,__getOwnPropDescs$1=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1=Object.getOwnPropertySymbols,__hasOwnProp$1={}.hasOwnProperty,__propIsEnum$1={}.propertyIsEnumerable,__defNormalProp$1=(obj,key,value)=>key in obj?__defProp$1(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues$1=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$1.call(b,prop)&&__defNormalProp$1(a,prop,b[prop]);if(__getOwnPropSymbols$1)for(var prop of __getOwnPropSymbols$1(b))__propIsEnum$1.call(b,prop)&&__defNormalProp$1(a,prop,b[prop]);return a},__async$2=(__this,__arguments,generator)=>new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));class OfflineStorageService{constructor(settings,error_codes,apiLog){this.apiLog=apiLog,this.storeName="scorm_again_offline_data",this.syncQueue="scorm_again_sync_queue",this.isOnline=navigator.onLine,this.syncInProgress=!1,this.settings=settings,this.error_codes=error_codes,window.addEventListener("online",this.handleOnlineStatusChange.bind(this)),window.addEventListener("offline",this.handleOnlineStatusChange.bind(this))}handleOnlineStatusChange(){const wasOnline=this.isOnline;this.isOnline=navigator.onLine,!wasOnline&&this.isOnline?(this.apiLog("OfflineStorageService","Device is back online, attempting to sync...",LogLevelEnum.INFO),this.syncOfflineData()):wasOnline&&!this.isOnline&&this.apiLog("OfflineStorageService","Device is offline, data will be stored locally",LogLevelEnum.INFO)}storeOffline(courseId,commitData){return __async$2(this,null,(function*(){try{const queueItem={id:`${courseId}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,courseId:courseId,timestamp:Date.now(),data:commitData,syncAttempts:0},currentQueue=(yield this.getFromStorage(this.syncQueue))||[];return currentQueue.push(queueItem),yield this.saveToStorage(this.syncQueue,currentQueue),yield this.saveToStorage(`${this.storeName}_${courseId}`,commitData),this.apiLog("OfflineStorageService","Stored data offline for course "+courseId,LogLevelEnum.INFO),{result:"true",errorCode:0}}catch(error){return this.apiLog("OfflineStorageService","Error storing offline data: "+error,LogLevelEnum.ERROR),{result:"false",errorCode:this.error_codes.GENERAL}}}))}getOfflineData(courseId){return __async$2(this,null,(function*(){try{return(yield this.getFromStorage(`${this.storeName}_${courseId}`))||null}catch(error){return this.apiLog("OfflineStorageService","Error retrieving offline data: "+error,LogLevelEnum.ERROR),null}}))}syncOfflineData(){return __async$2(this,null,(function*(){if(this.syncInProgress||!this.isOnline)return!1;this.syncInProgress=!0;try{const syncQueue=(yield this.getFromStorage(this.syncQueue))||[];if(0===syncQueue.length)return this.syncInProgress=!1,!0;this.apiLog("OfflineStorageService",`Found ${syncQueue.length} items to sync`,LogLevelEnum.INFO);const remainingQueue=[];for(const item of syncQueue)if(5>item.syncAttempts)try{"true"===(yield this.sendDataToLMS(item.data)).result?this.apiLog("OfflineStorageService","Successfully synced item "+item.id,LogLevelEnum.INFO):(item.syncAttempts++,remainingQueue.push(item),this.apiLog("OfflineStorageService",`Failed to sync item ${item.id}, attempt #${item.syncAttempts}`,LogLevelEnum.WARN))}catch(error){item.syncAttempts++,remainingQueue.push(item),this.apiLog("OfflineStorageService",`Error syncing item ${item.id}: ${error}`,LogLevelEnum.ERROR)}else this.apiLog("OfflineStorageService",`Skipping item ${item.id} after 5 failed attempts`,LogLevelEnum.WARN);return yield this.saveToStorage(this.syncQueue,remainingQueue),this.apiLog("OfflineStorageService",`Sync completed. ${syncQueue.length-remainingQueue.length} items synced, ${remainingQueue.length} items remaining`,LogLevelEnum.INFO),this.syncInProgress=!1,!0}catch(error){return this.apiLog("OfflineStorageService","Error during sync process: "+error,LogLevelEnum.ERROR),this.syncInProgress=!1,!1}}))}sendDataToLMS(data){return __async$2(this,null,(function*(){if(!this.settings.lmsCommitUrl)return{result:"false",errorCode:this.error_codes.GENERAL};try{const processedData=this.settings.requestHandler(data),response=yield fetch(this.settings.lmsCommitUrl,{method:"POST",mode:this.settings.fetchMode,body:JSON.stringify(processedData),headers:(a=__spreadValues$1({},this.settings.xhrHeaders),b={"Content-Type":this.settings.commitRequestDataType},__defProps$1(a,__getOwnPropDescs$1(b))),credentials:this.settings.xhrWithCredentials?"include":void 0}),result="function"==typeof this.settings.responseHandler?yield this.settings.responseHandler(response):yield response.json();return 200>response.status||response.status>299||!0!==result.result&&"true"!==result.result?(Object.hasOwnProperty.call(result,"errorCode")||(result.errorCode=this.error_codes.GENERAL),result):(Object.hasOwnProperty.call(result,"errorCode")||(result.errorCode=0),result)}catch(error){return this.apiLog("OfflineStorageService","Error sending data to LMS: "+error,LogLevelEnum.ERROR),{result:"false",errorCode:this.error_codes.GENERAL}}var a,b}))}isDeviceOnline(){return this.isOnline}getFromStorage(key){return __async$2(this,null,(function*(){const storedData=localStorage.getItem(key);if(storedData)try{return JSON.parse(storedData)}catch(e){return null}return null}))}saveToStorage(key,data){return __async$2(this,null,(function*(){localStorage.setItem(key,JSON.stringify(data))}))}hasPendingOfflineData(courseId){return __async$2(this,null,(function*(){return((yield this.getFromStorage(this.syncQueue))||[]).some((item=>item.courseId===courseId))}))}updateSettings(settings){this.settings=settings}}var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp={}.hasOwnProperty,__propIsEnum={}.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__async$1=(__this,__arguments,generator)=>new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));class BaseAPI{constructor(error_codes,settings,httpService,eventService,serializationService,cmiDataService,errorHandlingService,loggingService,offlineStorageService){if(this._settings=DefaultSettings,this._courseId="",new.target===BaseAPI)throw new TypeError("Cannot construct BaseAPI instances directly");this.currentState=0,this._error_codes=error_codes,settings&&(this.settings=settings),this.apiLogLevel=this.settings.logLevel,this.selfReportSessionTime=this.settings.selfReportSessionTime,void 0===this.apiLogLevel&&(this.apiLogLevel=LogLevelEnum.NONE),this._loggingService=loggingService||getLoggingService(),this._loggingService.setLogLevel(this.apiLogLevel),this.settings.onLogMessage&&this._loggingService.setLogHandler(this.settings.onLogMessage),this._httpService=httpService||new HttpService(this.settings,this._error_codes),this._eventService=eventService||new EventService(((functionName,message,level,element)=>this.apiLog(functionName,message,level,element))),this._serializationService=serializationService||new SerializationService,this._errorHandlingService=errorHandlingService||new ErrorHandlingService(this._error_codes,((functionName,message,level,element)=>this.apiLog(functionName,message,level,element)),((errorNumber,detail)=>this.getLmsErrorMessageDetails(errorNumber,detail)),void 0),this.settings.enableOfflineSupport&&(this._offlineStorageService=offlineStorageService||new OfflineStorageService(this.settings,this._error_codes,((functionName,message,level,element)=>this.apiLog(functionName,message,level,element))),this.settings.courseId&&(this._courseId=this.settings.courseId),this._offlineStorageService&&this._courseId&&this._offlineStorageService.getOfflineData(this._courseId).then((offlineData=>{offlineData&&(this.apiLog("constructor","Found offline data to restore",LogLevelEnum.INFO),this.loadFromJSON(offlineData.runtimeData))})).catch((error=>{this.apiLog("constructor","Error retrieving offline data: "+error,LogLevelEnum.ERROR)})))}get lastErrorCode(){var _a,_b;return null!=(_b=null==(_a=this._errorHandlingService)?void 0:_a.lastErrorCode)?_b:"0"}set lastErrorCode(errorCode){this._errorHandlingService&&(this._errorHandlingService.lastErrorCode=errorCode)}commonReset(settings){this.apiLog("reset","Called",LogLevelEnum.INFO),this.settings=__spreadValues(__spreadValues({},this.settings),settings),this.clearScheduledCommit(),this.currentState=0,this.lastErrorCode="0",this._eventService.reset(),this.startingData=void 0,this._offlineStorageService&&(this._offlineStorageService.updateSettings(this.settings),(null==settings?void 0:settings.courseId)&&(this._courseId=settings.courseId))}initialize(callbackName,initializeMessage,terminationMessage){let returnValue="false";return this.isInitialized()?this.throwSCORMError("api",this._error_codes.INITIALIZED,initializeMessage):this.isTerminated()?this.throwSCORMError("api",this._error_codes.TERMINATED,terminationMessage):(this.selfReportSessionTime&&this.cmi.setStartTime(),this.currentState=1,this.lastErrorCode="0",returnValue="true",this.processListeners(callbackName),this.settings.enableOfflineSupport&&this._offlineStorageService&&this._courseId&&this.settings.syncOnInitialize&&this._offlineStorageService.isDeviceOnline()&&this._offlineStorageService.hasPendingOfflineData(this._courseId).then((hasPendingData=>{var _a;hasPendingData&&(this.apiLog(callbackName,"Syncing pending offline data on initialization",LogLevelEnum.INFO),null==(_a=this._offlineStorageService)||_a.syncOfflineData().then((syncSuccess=>{syncSuccess&&(this.apiLog(callbackName,"Successfully synced offline data",LogLevelEnum.INFO),this.processListeners("OfflineDataSynced"))})))}))),this.apiLog(callbackName,"returned: "+returnValue,LogLevelEnum.INFO),this.clearSCORMError(returnValue),returnValue}apiLog(functionName,logMessage,messageLevel,CMIElement){logMessage=function(functionName,message,CMIElement){let messageString=functionName.padEnd(20)+": ";return CMIElement&&(messageString+=CMIElement,messageString=messageString.padEnd(70)),messageString+=null!=message?message:"",messageString}(functionName,logMessage,CMIElement),this.apiLogLevel>messageLevel||this._loggingService.log(messageLevel,logMessage)}get error_codes(){return this._error_codes}get settings(){return this._settings}set settings(settings){var _a,_b,_c;const previousSettings=this._settings;this._settings=__spreadValues(__spreadValues({},this._settings),settings),null==(_a=this._httpService)||_a.updateSettings(this._settings),void 0!==settings.logLevel&&settings.logLevel!==previousSettings.logLevel&&(this.apiLogLevel=settings.logLevel,null==(_b=this._loggingService)||_b.setLogLevel(settings.logLevel)),void 0!==settings.onLogMessage&&settings.onLogMessage!==previousSettings.onLogMessage&&(null==(_c=this._loggingService)||_c.setLogHandler(settings.onLogMessage))}terminate(callbackName,checkTerminated){return __async$1(this,null,(function*(){var _a,_b;let returnValue="false";if(this.checkState(checkTerminated,this._error_codes.TERMINATION_BEFORE_INIT,this._error_codes.MULTIPLE_TERMINATION)){this.currentState=2,this.settings.enableOfflineSupport&&this._offlineStorageService&&this._courseId&&this.settings.syncOnTerminate&&this._offlineStorageService.isDeviceOnline()&&(yield this._offlineStorageService.hasPendingOfflineData(this._courseId))&&(this.apiLog(callbackName,"Syncing pending offline data before termination",LogLevelEnum.INFO),yield this._offlineStorageService.syncOfflineData());const result=yield this.storeData(!0);(null!=(_a=result.errorCode)?_a:0)>0&&this.throwSCORMError("api",result.errorCode),returnValue=null!=(_b=null==result?void 0:result.result)?_b:"false",checkTerminated&&(this.lastErrorCode="0"),returnValue="true",this.processListeners(callbackName)}return this.apiLog(callbackName,"returned: "+returnValue,LogLevelEnum.INFO),this.clearSCORMError(returnValue),returnValue}))}getValue(callbackName,checkTerminated,CMIElement){let returnValue="";if(this.checkState(checkTerminated,this._error_codes.RETRIEVE_BEFORE_INIT,this._error_codes.RETRIEVE_AFTER_TERM)){try{returnValue=this.getCMIValue(CMIElement)}catch(e){returnValue=this.handleValueAccessException(CMIElement,e,returnValue)}this.processListeners(callbackName,CMIElement)}return this.apiLog(callbackName,": returned: "+returnValue,LogLevelEnum.INFO,CMIElement),void 0===returnValue?"":("0"===this.lastErrorCode&&this.clearSCORMError(returnValue),returnValue)}setValue(callbackName,commitCallback,checkTerminated,CMIElement,value){void 0!==value&&(value+="");let returnValue="false";if(this.checkState(checkTerminated,this._error_codes.STORE_BEFORE_INIT,this._error_codes.STORE_AFTER_TERM)){try{returnValue=this.setCMIValue(CMIElement,value)}catch(e){returnValue=this.handleValueAccessException(CMIElement,e,returnValue)}this.processListeners(callbackName,CMIElement,value)}return void 0===returnValue&&(returnValue="false"),this.lastErrorCode+""=="0"&&this.settings.autocommit&&this.scheduleCommit(1e3*this.settings.autocommitSeconds,commitCallback),this.apiLog(callbackName,": "+value+": result: "+returnValue,LogLevelEnum.INFO,CMIElement),"0"===this.lastErrorCode&&this.clearSCORMError(returnValue),returnValue}commit(callbackName,checkTerminated=!1){return __async$1(this,null,(function*(){var _a,_b;this.clearScheduledCommit();let returnValue="false";if(this.checkState(checkTerminated,this._error_codes.COMMIT_BEFORE_INIT,this._error_codes.COMMIT_AFTER_TERM)){const result=yield this.storeData(!1);(null!=(_a=result.errorCode)?_a:0)>0&&this.throwSCORMError("api",result.errorCode),returnValue=null!=(_b=null==result?void 0:result.result)?_b:"false",this.apiLog(callbackName," Result: "+returnValue,LogLevelEnum.DEBUG,"HttpRequest"),checkTerminated&&(this.lastErrorCode="0"),this.processListeners(callbackName),this.settings.enableOfflineSupport&&this._offlineStorageService&&this._offlineStorageService.isDeviceOnline()&&this._courseId&&this._offlineStorageService.hasPendingOfflineData(this._courseId).then((hasPendingData=>{var _a2;hasPendingData&&(this.apiLog(callbackName,"Syncing pending offline data",LogLevelEnum.INFO),null==(_a2=this._offlineStorageService)||_a2.syncOfflineData().then((syncSuccess=>{syncSuccess?(this.apiLog(callbackName,"Successfully synced offline data",LogLevelEnum.INFO),this.processListeners("OfflineDataSynced")):this.apiLog(callbackName,"Failed to sync some offline data",LogLevelEnum.WARN)})))}))}return this.apiLog(callbackName,"returned: "+returnValue,LogLevelEnum.INFO),"0"===this.lastErrorCode&&this.clearSCORMError(returnValue),returnValue}))}getLastError(callbackName){const returnValue=this.lastErrorCode+"";return this.processListeners(callbackName),this.apiLog(callbackName,"returned: "+returnValue,LogLevelEnum.INFO),returnValue}getErrorString(callbackName,CMIErrorCode){let returnValue="";return null!==CMIErrorCode&&""!==CMIErrorCode&&(returnValue=this.getLmsErrorMessageDetails(CMIErrorCode),this.processListeners(callbackName)),this.apiLog(callbackName,"returned: "+returnValue,LogLevelEnum.INFO),returnValue}getDiagnostic(callbackName,CMIErrorCode){let returnValue="";return null!==CMIErrorCode&&""!==CMIErrorCode&&(returnValue=this.getLmsErrorMessageDetails(CMIErrorCode,!0),this.processListeners(callbackName)),this.apiLog(callbackName,"returned: "+returnValue,LogLevelEnum.INFO),returnValue}checkState(checkTerminated,beforeInitError,afterTermError){return this.isNotInitialized()?(this.throwSCORMError("api",beforeInitError),!1):!checkTerminated||!this.isTerminated()||(this.throwSCORMError("api",afterTermError),!1)}getLmsErrorMessageDetails(_errorNumber,_detail=!1){throw Error("The getLmsErrorMessageDetails method has not been implemented")}getCMIValue(_CMIElement){throw Error("The getCMIValue method has not been implemented")}setCMIValue(_CMIElement,_value){throw Error("The setCMIValue method has not been implemented")}_commonSetCMIValue(methodName,scorm2004,CMIElement,value){if(!CMIElement||""===CMIElement)return"false";this.lastErrorCode="0";const structure=CMIElement.split(".");let refObject=this,returnValue="false",foundFirstIndex=!1;const invalidErrorMessage=`The data model element passed to ${methodName} (${CMIElement}) is not a valid SCORM data model element.`,invalidErrorCode=scorm2004?this._error_codes.UNDEFINED_DATA_MODEL:this._error_codes.GENERAL;for(let idx=0;structure.length>idx;idx++){const attribute=structure[idx];if(idx===structure.length-1)if(scorm2004&&"{target="===attribute.substring(0,8)){if(this.isInitialized()){this.throwSCORMError(CMIElement,this._error_codes.READ_ONLY_ELEMENT);break}a=__spreadValues({},refObject),refObject=__defProps(a,__getOwnPropDescs({attribute:value}))}else{if(!this._checkObjectHasProperty(refObject,attribute)){this.throwSCORMError(CMIElement,invalidErrorCode,invalidErrorMessage);break}if(stringMatches(CMIElement,"\\.correct_responses\\.\\d+$")&&this.isInitialized()&&"pattern"!==attribute&&(this.validateCorrectResponse(CMIElement,value),"0"!==this.lastErrorCode)){this.throwSCORMError(CMIElement,this._error_codes.TYPE_MISMATCH);break}scorm2004&&"0"!==this._errorHandlingService.lastErrorCode||(refObject[attribute]=value,returnValue="true")}else{if(refObject=refObject[attribute],!refObject){this.throwSCORMError(CMIElement,invalidErrorCode,invalidErrorMessage);break}if(refObject instanceof CMIArray){const index=parseInt(structure[idx+1],10);if(!isNaN(index)){const item=refObject.childArray[index];if(item)refObject=item,foundFirstIndex=!0;else{const newChild=this.getChildElement(CMIElement,value,foundFirstIndex);if(foundFirstIndex=!0,!newChild){"0"===this.lastErrorCode&&this.throwSCORMError(CMIElement,invalidErrorCode,invalidErrorMessage);break}refObject.initialized&&newChild.initialize(),refObject.childArray[index]=newChild,refObject=newChild}idx++}}}}var a;return"false"===returnValue&&this.apiLog(methodName,`There was an error setting the value for: ${CMIElement}, value of: ${value}`,LogLevelEnum.WARN),returnValue}_commonGetCMIValue(methodName,scorm2004,CMIElement){if(!CMIElement||""===CMIElement)return"";const structure=CMIElement.split(".");let refObject=this,attribute=null;const uninitializedErrorMessage=`The data model element passed to ${methodName} (${CMIElement}) has not been initialized.`,invalidErrorMessage=`The data model element passed to ${methodName} (${CMIElement}) is not a valid SCORM data model element.`,invalidErrorCode=scorm2004?this._error_codes.UNDEFINED_DATA_MODEL:this._error_codes.GENERAL;for(let idx=0;structure.length>idx;idx++){if(attribute=structure[idx],scorm2004){if("{target="===(attribute+"").substring(0,8)&&"function"==typeof refObject._isTargetValid)return refObject._isTargetValid((attribute+"").substring(8,(attribute+"").length-9));if(!this._checkObjectHasProperty(refObject,attribute))return void this.throwSCORMError(CMIElement,invalidErrorCode,invalidErrorMessage)}else if(idx===structure.length-1&&!this._checkObjectHasProperty(refObject,attribute))return void this.throwSCORMError(CMIElement,invalidErrorCode,invalidErrorMessage);if(refObject=refObject[attribute],void 0===refObject){this.throwSCORMError(CMIElement,invalidErrorCode,invalidErrorMessage);break}if(refObject instanceof CMIArray){const index=parseInt(structure[idx+1],10);if(!isNaN(index)){const item=refObject.childArray[index];if(!item){this.throwSCORMError(CMIElement,this._error_codes.VALUE_NOT_INITIALIZED,uninitializedErrorMessage);break}refObject=item,idx++}}}if(null!=refObject)return refObject;scorm2004||("_children"===attribute?this.throwSCORMError(CMIElement,this._error_codes.CHILDREN_ERROR,void 0):"_count"===attribute&&this.throwSCORMError(CMIElement,this._error_codes.COUNT_ERROR,void 0))}isInitialized(){return 1===this.currentState}isNotInitialized(){return 0===this.currentState}isTerminated(){return 2===this.currentState}on(listenerName,callback){this._eventService.on(listenerName,callback)}off(listenerName,callback){this._eventService.off(listenerName,callback)}clear(listenerName){this._eventService.clear(listenerName)}processListeners(functionName,CMIElement,value){this._eventService.processListeners(functionName,CMIElement,value)}throwSCORMError(CMIElement,errorNumber,message){this._errorHandlingService.throwSCORMError(CMIElement,errorNumber,message)}clearSCORMError(success){this._errorHandlingService.clearSCORMError(success)}loadFromFlattenedJSON(json,CMIElement){CMIElement||(CMIElement=""),this._serializationService.loadFromFlattenedJSON(json,CMIElement,((CMIElement2,value)=>this.setCMIValue(CMIElement2,value)),(()=>this.isNotInitialized()),(data=>{this.startingData=data}))}loadFromJSON(json,CMIElement=""){this._serializationService.loadFromJSON(json,CMIElement,((CMIElement2,value)=>this.setCMIValue(CMIElement2,value)),(()=>this.isNotInitialized()),(data=>{this.startingData=data}))}renderCMIToJSONString(){return this._serializationService.renderCMIToJSONString(this.cmi,this.settings.sendFullCommit)}renderCMIToJSONObject(){return this._serializationService.renderCMIToJSONObject(this.cmi,this.settings.sendFullCommit)}processHttpRequest(url,params,immediate=!1){return __async$1(this,null,(function*(){return this.settings.enableOfflineSupport&&this._offlineStorageService&&!this._offlineStorageService.isDeviceOnline()&&this._courseId?(this.apiLog("processHttpRequest","Device is offline, storing data locally",LogLevelEnum.INFO),params&&"object"==typeof params&&"cmi"in params?yield this._offlineStorageService.storeOffline(this._courseId,params):(this.apiLog("processHttpRequest","Invalid commit data format for offline storage",LogLevelEnum.ERROR),{result:"false",errorCode:this._error_codes.GENERAL})):yield this._httpService.processHttpRequest(url,params,immediate,((functionName,message,level,element)=>this.apiLog(functionName,message,level,element)),((functionName,CMIElement,value)=>this.processListeners(functionName,CMIElement,value)))}))}scheduleCommit(when,callback){this._timeout||(this._timeout=new ScheduledCommit(this,when,callback),this.apiLog("scheduleCommit","scheduled",LogLevelEnum.DEBUG,""))}clearScheduledCommit(){this._timeout&&(this._timeout.cancel(),this._timeout=void 0,this.apiLog("clearScheduledCommit","cleared",LogLevelEnum.DEBUG,""))}_checkObjectHasProperty(StringKeyMap2,attribute){return Object.hasOwnProperty.call(StringKeyMap2,attribute)||null!=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(StringKeyMap2),attribute)||attribute in StringKeyMap2}handleValueAccessException(CMIElement,e,returnValue){return e instanceof ValidationError?(this.lastErrorCode=e.errorCode+"",returnValue="false",this.throwSCORMError(CMIElement,e.errorCode,e.errorMessage)):this.throwSCORMError(CMIElement,this._error_codes.GENERAL,e instanceof Error&&e.message?e.message:"Unknown error"),returnValue}getCommitObject(terminateCommit){return this._serializationService.getCommitObject(terminateCommit,this.settings.alwaysSendTotalTime,this.settings.renderCommonCommitFields,(terminateCommit2=>this.renderCommitObject(terminateCommit2)),(terminateCommit2=>this.renderCommitCMI(terminateCommit2)),this.apiLogLevel)}}var __async=(__this,__arguments,generator)=>new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));class Scorm12API extends BaseAPI{constructor(settings){settings&&void 0===settings.mastery_override&&(settings.mastery_override=!1),super(scorm12_errors$1,settings),this.statusSetByModule=!1,this.cmi=new CMI$1,this.nav=new NAV,this.LMSInitialize=this.lmsInitialize,this.LMSFinish=this.lmsFinish,this.LMSGetValue=this.lmsGetValue,this.LMSSetValue=this.lmsSetValue,this.LMSCommit=this.lmsCommit,this.LMSGetLastError=this.lmsGetLastError,this.LMSGetErrorString=this.lmsGetErrorString,this.LMSGetDiagnostic=this.lmsGetDiagnostic}reset(settings){var _a,_b;this.commonReset(settings),null==(_a=this.cmi)||_a.reset(),null==(_b=this.nav)||_b.reset()}lmsInitialize(){return this.cmi.initialize(),this.cmi.core.lesson_status?this.statusSetByModule=!0:this.cmi.core.lesson_status="not attempted",this.initialize("LMSInitialize","LMS was already initialized!","LMS is already finished!")}lmsFinish(){return(()=>{__async(this,null,(function*(){yield this.internalFinish()}))})(),"true"}internalFinish(){return __async(this,null,(function*(){const result=yield this.terminate("LMSFinish",!0);return"true"===result&&(""!==this.nav.event?this.processListeners("continue"===this.nav.event?"SequenceNext":"SequencePrevious"):this.settings.autoProgress&&this.processListeners("SequenceNext")),result}))}lmsGetValue(CMIElement){return this.getValue("LMSGetValue",!1,CMIElement)}lmsSetValue(CMIElement,value){return"cmi.core.lesson_status"===CMIElement&&(this.statusSetByModule=!0),this.setValue("LMSSetValue","LMSCommit",!1,CMIElement,value)}lmsCommit(){return this.settings.asyncCommit?this.scheduleCommit(500,"LMSCommit"):(()=>{__async(this,null,(function*(){yield this.commit("LMSCommit",!1)}))})(),"true"}lmsGetLastError(){return this.getLastError("LMSGetLastError")}lmsGetErrorString(CMIErrorCode){return this.getErrorString("LMSGetErrorString",CMIErrorCode)}lmsGetDiagnostic(CMIErrorCode){return this.getDiagnostic("LMSGetDiagnostic",CMIErrorCode)}setCMIValue(CMIElement,value){return this._commonSetCMIValue("LMSSetValue",!1,CMIElement,value)}getCMIValue(CMIElement){return this._commonGetCMIValue("getCMIValue",!1,CMIElement)}getChildElement(CMIElement,_value,foundFirstIndex){return stringMatches(CMIElement,"cmi\\.objectives\\.\\d+")?new CMIObjectivesObject:foundFirstIndex&&stringMatches(CMIElement,"cmi\\.interactions\\.\\d+\\.correct_responses\\.\\d+")?new CMIInteractionsCorrectResponsesObject:foundFirstIndex&&stringMatches(CMIElement,"cmi\\.interactions\\.\\d+\\.objectives\\.\\d+")?new CMIInteractionsObjectivesObject:!foundFirstIndex&&stringMatches(CMIElement,"cmi\\.interactions\\.\\d+")?new CMIInteractionsObject:null}validateCorrectResponse(_CMIElement,_value){}getLmsErrorMessageDetails(errorNumber,detail){let basicMessage="No Error",detailMessage="No Error";return scorm12_constants.error_descriptions[errorNumber+=""]&&(basicMessage=scorm12_constants.error_descriptions[errorNumber].basicMessage,detailMessage=scorm12_constants.error_descriptions[errorNumber].detailMessage),detail?detailMessage:basicMessage}replaceWithAnotherScormAPI(newAPI){this.cmi=newAPI.cmi}renderCommitCMI(terminateCommit){const cmiExport=this.renderCMIToJSONObject();terminateCommit&&(cmiExport.cmi.core.total_time=this.cmi.getCurrentTotalTime());const result=[],flattened=flatten(cmiExport);switch(this.settings.dataCommitFormat){case"flattened":return flatten(cmiExport);case"params":for(const item in flattened)({}).hasOwnProperty.call(flattened,item)&&result.push(`${item}=${flattened[item]}`);return result;default:return cmiExport}}renderCommitObject(terminateCommit){const cmiExport=this.renderCommitCMI(terminateCommit),totalTimeHHMMSS=this.cmi.getCurrentTotalTime(),totalTimeSeconds=getTimeAsSeconds(totalTimeHHMMSS,scorm12_regex.CMITimespan),lessonStatus=this.cmi.core.lesson_status;let completionStatus="unknown",successStatus="unknown";lessonStatus&&(completionStatus="completed"===lessonStatus||"passed"===lessonStatus?"completed":"incomplete","passed"===lessonStatus?successStatus="passed":"failed"===lessonStatus&&(successStatus="failed"));const score=this.cmi.core.score;let scoreObject=null;score&&(scoreObject={},Number.isNaN(Number.parseFloat(score.raw))||(scoreObject.raw=Number.parseFloat(score.raw)),Number.isNaN(Number.parseFloat(score.min))||(scoreObject.min=Number.parseFloat(score.min)),Number.isNaN(Number.parseFloat(score.max))||(scoreObject.max=Number.parseFloat(score.max)));const commitObject={successStatus:successStatus,completionStatus:completionStatus,runtimeData:cmiExport,totalTimeSeconds:totalTimeSeconds};return scoreObject&&(commitObject.score=scoreObject),commitObject}storeData(terminateCommit){return __async(this,null,(function*(){var _a,_b,_c;if(terminateCommit){const originalStatus=this.cmi.core.lesson_status;this.cmi.core.lesson_status&&(this.statusSetByModule||"not attempted"!==this.cmi.core.lesson_status)||(this.cmi.core.lesson_status="completed"),"normal"===this.cmi.core.lesson_mode?"credit"===this.cmi.core.credit&&this.settings.mastery_override&&""!==this.cmi.student_data.mastery_score&&""!==this.cmi.core.score.raw&&(this.cmi.core.lesson_status=parseFloat(this.cmi.student_data.mastery_score)>parseFloat(this.cmi.core.score.raw)?"failed":"passed"):"browse"===this.cmi.core.lesson_mode&&""===((null==(_c=null==(_b=null==(_a=this.startingData)?void 0:_a.cmi)?void 0:_b.core)?void 0:_c.lesson_status)||"")&&"not attempted"===originalStatus&&(this.cmi.core.lesson_status="browsed")}const commitObject=this.getCommitObject(terminateCommit);return"string"==typeof this.settings.lmsCommitUrl?yield this.processHttpRequest(this.settings.lmsCommitUrl,commitObject,terminateCommit):{result:"true",errorCode:0}}))}}const aicc_errors=aicc_constants.error_descriptions;class AICCValidationError extends ValidationError{constructor(CMIElement,errorCode){!{}.hasOwnProperty.call(aicc_errors,errorCode+"")?super(CMIElement,101,aicc_errors[101].basicMessage,aicc_errors[101].detailMessage):super(CMIElement,errorCode,aicc_errors[errorCode+""].basicMessage,aicc_errors[errorCode+""].detailMessage),Object.setPrototypeOf(this,AICCValidationError.prototype)}}function checkAICCValidFormat(CMIElement,value,regexPattern,allowEmptyString){return checkValidFormat(CMIElement,value,regexPattern,scorm12_errors$1.TYPE_MISMATCH,AICCValidationError,allowEmptyString)}class CMIEvaluation extends BaseCMI{constructor(){super("cmi.evaluation"),this.comments=new CMIEvaluationComments}initialize(){var _a;super.initialize(),null==(_a=this.comments)||_a.initialize()}reset(){var _a;this._initialized=!1,null==(_a=this.comments)||_a.reset()}toJSON(){this.jsonString=!0;const result={comments:this.comments};return delete this.jsonString,result}}class CMIEvaluationComments extends CMIArray{constructor(){super({CMIElement:"cmi.evaluation.comments",children:aicc_constants.comments_children,errorCode:scorm12_errors$1.INVALID_SET_VALUE,errorClass:AICCValidationError})}}class CMIEvaluationCommentsObject extends BaseCMI{constructor(){super("cmi.evaluation.comments.n"),this._content="",this._location="",this._time=""}reset(){this._initialized=!1,this._content="",this._location="",this._time=""}get content(){return this._content}set content(content){checkAICCValidFormat(this._cmi_element+".content",content,aicc_regex.CMIString256)&&(this._content=content)}get location(){return this._location}set location(location){checkAICCValidFormat(this._cmi_element+".location",location,aicc_regex.CMIString256)&&(this._location=location)}get time(){return this._time}set time(time){checkAICCValidFormat(this._cmi_element+".time",time,aicc_regex.CMITime)&&(this._time=time)}toJSON(){this.jsonString=!0;const result={content:this.content,location:this.location,time:this.time};return delete this.jsonString,result}}class AICCStudentPreferences extends CMIStudentPreference{constructor(){super(aicc_constants.student_preference_children),this._lesson_type="",this._text_color="",this._text_location="",this._text_size="",this._video="",this.windows=new CMIArray({CMIElement:"cmi.student_preference.windows",errorCode:scorm12_errors$1.INVALID_SET_VALUE,errorClass:AICCValidationError,children:""})}initialize(){var _a;super.initialize(),null==(_a=this.windows)||_a.initialize()}get lesson_type(){return this._lesson_type}set lesson_type(lesson_type){checkAICCValidFormat(this._cmi_element+".lesson_type",lesson_type,aicc_regex.CMIString256)&&(this._lesson_type=lesson_type)}get text_color(){return this._text_color}set text_color(text_color){checkAICCValidFormat(this._cmi_element+".text_color",text_color,aicc_regex.CMIString256)&&(this._text_color=text_color)}get text_location(){return this._text_location}set text_location(text_location){checkAICCValidFormat(this._cmi_element+".text_location",text_location,aicc_regex.CMIString256)&&(this._text_location=text_location)}get text_size(){return this._text_size}set text_size(text_size){checkAICCValidFormat(this._cmi_element+".text_size",text_size,aicc_regex.CMIString256)&&(this._text_size=text_size)}get video(){return this._video}set video(video){checkAICCValidFormat(this._cmi_element+".video",video,aicc_regex.CMIString256)&&(this._video=video)}toJSON(){this.jsonString=!0;const result={audio:this.audio,language:this.language,lesson_type:this.lesson_type,speed:this.speed,text:this.text,text_color:this.text_color,text_location:this.text_location,text_size:this.text_size,video:this.video,windows:this.windows};return delete this.jsonString,result}}class CMIStudentDemographics extends BaseCMI{constructor(){super("cmi.student_demographics"),this.__children=aicc_constants.student_demographics_children,this._city="",this._class="",this._company="",this._country="",this._experience="",this._familiar_name="",this._instructor_name="",this._title="",this._native_language="",this._state="",this._street_address="",this._telephone="",this._years_experience=""}reset(){this._initialized=!1}get _children(){return this.__children}get city(){return this._city}set city(city){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.city",scorm12_errors$1.READ_ONLY_ELEMENT);this._city=city}get class(){return this._class}set class(clazz){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.class",scorm12_errors$1.READ_ONLY_ELEMENT);this._class=clazz}get company(){return this._company}set company(company){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.company",scorm12_errors$1.READ_ONLY_ELEMENT);this._company=company}get country(){return this._country}set country(country){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.country",scorm12_errors$1.READ_ONLY_ELEMENT);this._country=country}get experience(){return this._experience}set experience(experience){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.experience",scorm12_errors$1.READ_ONLY_ELEMENT);this._experience=experience}get familiar_name(){return this._familiar_name}set familiar_name(familiar_name){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.familiar_name",scorm12_errors$1.READ_ONLY_ELEMENT);this._familiar_name=familiar_name}get instructor_name(){return this._instructor_name}set instructor_name(instructor_name){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.instructor_name",scorm12_errors$1.READ_ONLY_ELEMENT);this._instructor_name=instructor_name}get title(){return this._title}set title(title){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.title",scorm12_errors$1.READ_ONLY_ELEMENT);this._title=title}get native_language(){return this._native_language}set native_language(native_language){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.native_language",scorm12_errors$1.READ_ONLY_ELEMENT);this._native_language=native_language}get state(){return this._state}set state(state){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.state",scorm12_errors$1.READ_ONLY_ELEMENT);this._state=state}get street_address(){return this._street_address}set street_address(street_address){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.street_address",scorm12_errors$1.READ_ONLY_ELEMENT);this._street_address=street_address}get telephone(){return this._telephone}set telephone(telephone){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.telephone",scorm12_errors$1.READ_ONLY_ELEMENT);this._telephone=telephone}get years_experience(){return this._years_experience}set years_experience(years_experience){if(this.initialized)throw new AICCValidationError("cmi.student_demographics.years_experience",scorm12_errors$1.READ_ONLY_ELEMENT);this._years_experience=years_experience}toJSON(){this.jsonString=!0;const result={city:this.city,class:this.class,company:this.company,country:this.country,experience:this.experience,familiar_name:this.familiar_name,instructor_name:this.instructor_name,title:this.title,native_language:this.native_language,state:this.state,street_address:this.street_address,telephone:this.telephone,years_experience:this.years_experience};return delete this.jsonString,result}}class CMITries extends CMIArray{constructor(){super({CMIElement:"cmi.student_data.tries",children:aicc_constants.tries_children})}}class CMITriesObject extends BaseCMI{constructor(){super("cmi.student_data.tries.n"),this._status="",this._time="",this.score=new CMIScore({CMIElement:"cmi.student_data.tries.n.score",score_children:aicc_constants.score_children,score_range:aicc_regex.score_range,invalidErrorCode:scorm12_errors$1.INVALID_SET_VALUE,invalidTypeCode:scorm12_errors$1.TYPE_MISMATCH,invalidRangeCode:scorm12_errors$1.VALUE_OUT_OF_RANGE,errorClass:AICCValidationError})}initialize(){var _a;super.initialize(),null==(_a=this.score)||_a.initialize()}reset(){var _a;this._initialized=!1,this._status="",this._time="",null==(_a=this.score)||_a.reset()}get status(){return this._status}set status(status){checkAICCValidFormat(this._cmi_element+".status",status,aicc_regex.CMIStatus2)&&(this._status=status)}get time(){return this._time}set time(time){checkAICCValidFormat(this._cmi_element+".time",time,aicc_regex.CMITime)&&(this._time=time)}toJSON(){this.jsonString=!0;const result={status:this.status,time:this.time,score:this.score};return delete this.jsonString,result}}class CMIAttemptRecords extends CMIArray{constructor(){super({CMIElement:"cmi.student_data.attempt_records",children:aicc_constants.attempt_records_children})}}class CMIAttemptRecordsObject extends BaseCMI{constructor(){super("cmi.student_data.attempt_records.n"),this._lesson_status="",this.score=new CMIScore({CMIElement:"cmi.student_data.attempt_records.n.score",score_children:aicc_constants.score_children,score_range:aicc_regex.score_range,invalidErrorCode:scorm12_errors$1.INVALID_SET_VALUE,invalidTypeCode:scorm12_errors$1.TYPE_MISMATCH,invalidRangeCode:scorm12_errors$1.VALUE_OUT_OF_RANGE,errorClass:AICCValidationError})}initialize(){var _a;super.initialize(),this._lesson_status="",null==(_a=this.score)||_a.initialize()}reset(){var _a;this._initialized=!1,null==(_a=this.score)||_a.reset()}get lesson_status(){return this._lesson_status}set lesson_status(lesson_status){checkAICCValidFormat(this._cmi_element+".lesson_status",lesson_status,aicc_regex.CMIStatus2)&&(this._lesson_status=lesson_status)}toJSON(){this.jsonString=!0;const result={lesson_status:this.lesson_status,score:this.score};return delete this.jsonString,result}}class AICCCMIStudentData extends CMIStudentData{constructor(){super(aicc_constants.student_data_children),this._tries_during_lesson="",this.tries=new CMITries,this.attempt_records=new CMIAttemptRecords}initialize(){var _a,_b;super.initialize(),null==(_a=this.tries)||_a.initialize(),null==(_b=this.attempt_records)||_b.initialize()}reset(){var _a,_b;this._initialized=!1,null==(_a=this.tries)||_a.reset(!0),null==(_b=this.attempt_records)||_b.reset(!0)}get tries_during_lesson(){return this._tries_during_lesson}set tries_during_lesson(tries_during_lesson){if(this.initialized)throw new AICCValidationError("cmi.student_data.tries_during_lesson",scorm12_errors$1.READ_ONLY_ELEMENT);this._tries_during_lesson=tries_during_lesson}toJSON(){this.jsonString=!0;const result={mastery_score:this.mastery_score,max_time_allowed:this.max_time_allowed,time_limit_action:this.time_limit_action,tries:this.tries,attempt_records:this.attempt_records};return delete this.jsonString,result}}class CMIPaths extends CMIArray{constructor(){super({CMIElement:"cmi.paths",children:aicc_constants.paths_children})}}class CMIPathsObject extends BaseCMI{constructor(){super("cmi.paths.n"),this._location_id="",this._date="",this._time="",this._status="",this._why_left="",this._time_in_element=""}reset(){this._initialized=!1,this._location_id="",this._date="",this._time="",this._status="",this._why_left="",this._time_in_element=""}get location_id(){return this._location_id}set location_id(location_id){checkAICCValidFormat(this._cmi_element+".location_id",location_id,aicc_regex.CMIString256)&&(this._location_id=location_id)}get date(){return this._date}set date(date){checkAICCValidFormat(this._cmi_element+".date",date,aicc_regex.CMIString256)&&(this._date=date)}get time(){return this._time}set time(time){checkAICCValidFormat(this._cmi_element+".time",time,aicc_regex.CMITime)&&(this._time=time)}get status(){return this._status}set status(status){checkAICCValidFormat(this._cmi_element+".status",status,aicc_regex.CMIStatus2)&&(this._status=status)}get why_left(){return this._why_left}set why_left(why_left){checkAICCValidFormat(this._cmi_element+".why_left",why_left,aicc_regex.CMIString256)&&(this._why_left=why_left)}get time_in_element(){return this._time_in_element}set time_in_element(time_in_element){checkAICCValidFormat(this._cmi_element+".time_in_element",time_in_element,aicc_regex.CMITime)&&(this._time_in_element=time_in_element)}toJSON(){this.jsonString=!0;const result={location_id:this.location_id,date:this.date,time:this.time,status:this.status,why_left:this.why_left,time_in_element:this.time_in_element};return delete this.jsonString,result}}class CMI extends CMI$1{constructor(initialized=!1){super(aicc_constants.cmi_children),initialized&&this.initialize(),this.student_preference=new AICCStudentPreferences,this.student_data=new AICCCMIStudentData,this.student_demographics=new CMIStudentDemographics,this.evaluation=new CMIEvaluation,this.paths=new CMIPaths}initialize(){var _a,_b,_c,_d,_e;super.initialize(),null==(_a=this.student_preference)||_a.initialize(),null==(_b=this.student_data)||_b.initialize(),null==(_c=this.student_demographics)||_c.initialize(),null==(_d=this.evaluation)||_d.initialize(),null==(_e=this.paths)||_e.initialize()}toJSON(){this.jsonString=!0;const result={suspend_data:this.suspend_data,launch_data:this.launch_data,comments:this.comments,comments_from_lms:this.comments_from_lms,core:this.core,objectives:this.objectives,student_data:this.student_data,student_preference:this.student_preference,student_demographics:this.student_demographics,interactions:this.interactions,evaluation:this.evaluation,paths:this.paths};return delete this.jsonString,result}}return class extends Scorm12API{constructor(settings){super(settings),this.cmi=new CMI,this.nav=new NAV}getChildElement(CMIElement,value,foundFirstIndex){let newChild=super.getChildElement(CMIElement,value,foundFirstIndex);return newChild||(stringMatches(CMIElement,"cmi\\.evaluation\\.comments\\.\\d+")?newChild=new CMIEvaluationCommentsObject:stringMatches(CMIElement,"cmi\\.student_data\\.tries\\.\\d+")?newChild=new CMITriesObject:stringMatches(CMIElement,"cmi\\.student_data\\.attempt_records\\.\\d+")?newChild=new CMIAttemptRecordsObject:stringMatches(CMIElement,"cmi\\.paths\\.\\d+")&&(newChild=new CMIPathsObject)),newChild}replaceWithAnotherScormAPI(newAPI){this.cmi=newAPI.cmi,this.nav=newAPI.nav}}}();
//# sourceMappingURL=aicc.min.js.map
